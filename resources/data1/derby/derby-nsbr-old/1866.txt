Assert failure in sane mode for queries that used to work in 10.1.2.1    Derby-1777 gives a database and a small program called 'ViewerInit' that prepares a bunch of large queries involving nested subqueries  unions  and join predicates. The actual bug described in DERBY-1777 is an NPE  and that's what the patch for DERBY-1777 addresses.However  once the NPEs are fixed  some of the queries in that same program now fail with ASSERT failures when running in SANE mode; this Jira issue is for addressing those assert failures.While this does constitute a regression  I don't know yet what the root cause of the problem is  so I hesitate to make it a 10.2 blocker--hence urgency is 'Normal'. I'm still investigating the queries to try to track down where the problem is  but all I've been able to deduce so far is that a) the assertion occurs for a scoped predicate and thus the pushing of join predicates into UNIONs is somehow involved  and b) in INSANE mode the query compiles without problem and appears (based on some early and very incomplete testing) to execute without problem. But more investigation is required to determine if the execution/results are actually correct  and to understand more about why the assertion is being thrown.I'm marking the fixin as 10.2.2.0 for now since I don't enough to make this a blocker for 10.2.1. Hopefully more info will be forthcoming...   