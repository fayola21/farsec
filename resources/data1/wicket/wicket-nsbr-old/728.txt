WicketTester could not handle Multipart form without upload    When testing the form that contains FileUploadField without upload  wicketTester throw exception with message: 'ServletRequest does not contain multipart content'// ex:public class FormTesterTest extends WicketTestCase{ /** Test that formTester deal with Multipart form correctly when no actual upload */ public void testSubmitWithoutUploadFile() { tester.startPage(MockFormFileUploadPage.class); MockFormFileUploadPage page = (MockFormFileUploadPage)tester.getLastRenderedPage(); Session.get().setLocale(Locale.US); FormTester formTester = tester.newFormTester('form'); // without file upload formTester.submit(); assertNull(page.getFileUpload()); tester.assertErrorMessages(new String[] { 'Field 'file' is required.' }); }}The cause is that Form contains FileUploadField is considered as multipart. But MockHttpServletRequest only generate Multipart contentType and contentLength when there is any upload file added via formTester.setFile(...). Thus without any file upload while testing  MultipartServletWebRequest throw exception.To solve this  I try to introduce a flag useMultiPartContentType in MockHttpServletRequest  so FormTester can change MockHttpServletRequest to generate correct contentType.attachment is patch   