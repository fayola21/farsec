<title>Issue 21483 -   chromium -    Be more careful with USER_HOMEDIR in Mac sandbox - Project Hosting on Google Code</title> <pre> I found this while looking into what might be happening in <a title="Mac 10.5.8 &quot;Aw Snap&quot; error on any page" class=closed_ref href="/p/chromium/issues/detail?id=21476"> bug 21476 </a>.    src/chrome/renderer/renderer.sb has:    ; USER_HOMEDIR is substitued at runtime - <a href="http://crbug.com/11269">http://crbug.com/11269</a>   (allow file-read-data (regex #&quot;^USER_HOMEDIR/Library/Fonts&quot;))  ; 10.6   seed release    The substitution occurs in   src/chrome/renderer/renderer_main_platform_delegate_mac.mm:      sandbox_data = [sandbox_data        stringByReplacingOccurrencesOfString:@&quot;USER_HOMEDIR&quot;                                  withString:NSHomeDirectory()];    This is bad.    We're replacing a string that's used in a regex without checking and   escaping characters that have special meanings to a regex parser  like .   (period)  +  ?  brackets  and parentheses.  We're replacing a quoted string   without checking that we're not doing something horrible that violates   quoting. </pre>