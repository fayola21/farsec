<title>Issue 22294 -   chromium -    ChromeURLRequestContext has races between UI and IO threads - Project Hosting on Google Code</title> <pre> Invalid use of GetSession() (that lazily creates it) which should only be called from the IO thread.    Two cases:  -  HttpNetworkSession  -  ClientSocketPool          cache = new net::HttpCache(original_network_layer-&gt;GetSession()                                  disk_cache_path.ToWStringHack()  cache_size);       	chrome.dll!net::HttpNetworkSession::HttpNetworkSession(net::HostResolver * host_resolver=0x003a2000  net::ProxyService *   proxy_service=0x00416c40  net::ClientSocketFactory * client_socket_factory=0x00360618  net::SSLConfigService *   ssl_config_service=0x003a40c0)  Line 28	C++   	chrome.dll!net::HttpNetworkLayer::GetSession()  Line 84 + 0x4f bytes	C++   	chrome.dll!ChromeURLRequestContext::CreateRequestContextForMedia(Profile * profile=0x0039d240  const FilePath &amp;   disk_cache_path={...}  int cache_size=0  bool off_the_record=false)  Line 285 + 0x36 bytes	C++  &gt;	chrome.dll!ChromeURLRequestContext::CreateOriginalForMedia(Profile * profile=0x0039d240  const FilePath &amp; disk_cache_path={...}    int cache_size=0)  Line 175 + 0x13 bytes	C++   	chrome.dll!ProfileImpl::GetRequestContextForMedia()  Line 960 + 0x11 bytes	C++   	chrome.dll!ResourceMessageFilter::ResourceMessageFilter(ResourceDispatcherHost * resource_dispatcher_host=0x003a23c0  int   child_id=1  AudioRendererHost * audio_renderer_host=0x04bf6780  PluginService * plugin_service=0x0036ec80  printing::PrintJobManager *   print_job_manager=0x00374310  Profile * profile=0x0039d240  RenderWidgetHelper * render_widget_helper=0x00384e00  SpellChecker *   spellchecker=0x00395840)  Line 169 + 0x134 bytes	C++   	chrome.dll!BrowserRenderProcessHost::Init()  Line 273 + 0xc8 bytes	C++   	chrome.dll!RenderViewHost::CreateRenderView()  Line 175 + 0x23 bytes	C++   	chrome.dll!TabContents::CreateRenderViewForRenderManager(RenderViewHost * render_view_host=0x003bb400)  Line 2459 + 0xf bytes	  C++      ==================      HttpNetworkSession* HttpNetworkLayer::GetSession() {    if (!session_) {      DCHECK(proxy_service_);      session_ = new HttpNetworkSession(host_resolver_  proxy_service_                                         socket_factory_  ssl_config_service_);      // These were just temps for lazy-initializing HttpNetworkSession.      host_resolver_ = NULL;      proxy_service_ = NULL;    }    return session_;  }       	chrome.dll!net::ClientSocketPool::ClientSocketPool()  Line 85	C++   	chrome.dll!net::TCPClientSocketPool::TCPClientSocketPool(int max_sockets=100  int max_sockets_per_group=6  net::HostResolver *   host_resolver=0x00481000  net::ClientSocketFactory * client_socket_factory=0x00440618)  Line 161 + 0x2b bytes	C++   	chrome.dll!net::HttpNetworkSession::HttpNetworkSession(net::HostResolver * host_resolver=0x00481000  net::ProxyService *   proxy_service=0x004f4c40  net::ClientSocketFactory * client_socket_factory=0x00440618  net::SSLConfigService *   ssl_config_service=0x004830c0)  Line 27 + 0x79 bytes	C++  &gt;	chrome.dll!net::HttpNetworkLayer::GetSession()  Line 84 + 0x4f bytes	C++   	chrome.dll!ChromeURLRequestContext::CreateRequestContextForMedia(Profile * profile=0x0047c240  const FilePath &amp;   disk_cache_path={...}  int cache_size=0  bool off_the_record=false)  Line 285 + 0x36 bytes	C++   	chrome.dll!ChromeURLRequestContext::CreateOriginalForMedia(Profile * profile=0x0047c240  const FilePath &amp; disk_cache_path={...}    int cache_size=0)  Line 175 + 0x13 bytes	C++   	chrome.dll!ProfileImpl::GetRequestContextForMedia()  Line 960 + 0x11 bytes	C++   	chrome.dll!ResourceMessageFilter::ResourceMessageFilter(ResourceDispatcherHost * resource_dispatcher_host=0x004813c0  int   child_id=1  AudioRendererHost * audio_renderer_host=0x04625780  PluginService * plugin_service=0x0044ec80  printing::PrintJobManager *   print_job_manager=0x00454310  Profile * profile=0x0047c240  RenderWidgetHelper * render_widget_helper=0x00464e00  SpellChecker *   spellchecker=0x00474840)  Line 169 + 0x134 bytes	C++   	chrome.dll!BrowserRenderProcessHost::Init()  Line 273 + 0xc8 bytes	C++      ======================================= </pre>