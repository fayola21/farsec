<title>Issue 18416 -   chromium -    Crash in Mac download animation when closing a window - Project Hosting on Google Code</title> <pre>   1. Open two Chrome windows  2. Start a download in one  3. Close that window before the download animation completes.  4. Crash    Looks like there is an animation that is still pending after the window has gone away. However  the code in   download_started_animation_mac.mm attempts to take tab closing into account: we attach an observer to watch for tab closed   events.    In this crash  we get the observer event and attempt to remove our CALayer from the tab's view  but the crash still happens a   little after that:    #0	0x9620f688 in objc_msgSend  #1	0x92db743a in _nsnote_callback  #2	0x9722f64a in __CFXNotificationPost  #3	0x9722f923 in _CFXNotificationPostNotification  #4	0x92db4690 in -[NSNotificationCenter postNotificationName:object:userInfo:]  #5	0x92dbdee8 in -[NSNotificationCenter postNotificationName:object:]  #6	0x90407ed3 in -[NSView _postFrameChangeNotification]  #7	0x9040dd43 in -[NSView setFrameSize:]  #8	0x92dd98c7 in _NSSetUsingKeyValueSetter  #9	0x92dd935e in -[NSObject(NSKeyValueCoding) setValue:forKey:]  #10	0x92e5df81 in -[NSObject(NSKeyValueCoding) setValue:forKeyPath:]  #11	0x9069e44e in -[NSView setValue:forKeyPath:]  #12	0x9069e1e0 in -[NSInFlightAnimation advanceToTime:]  #13	0x9069de52 in -[NSAnimationManager animationTimerFired:]  #14	0x92dec493 in __NSFireTimer  #15	0x9724eac5 in CFRunLoopRunSpecific  #16	0x9724ec78 in CFRunLoopRunInMode  #17	0x91d8a28c in RunCurrentEventLoopInMode  #18	0x91d8a0a5 in ReceiveNextEventCommon  #19	0x91d89f19 in BlockUntilNextEventMatchingListInMode  #20	0x90424d0d in _DPSNextEvent  #21	0x904245c0 in -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:]  #22	0x9041d5fb in -[NSApplication run]  #23	0x00693638 in base::MessagePumpNSApplication::DoRun at message_pump_mac.mm:482  #24	0x006939e3 in base::MessagePumpCFRunLoopBase::Run at message_pump_mac.mm:146  #25	0x00688159 in MessageLoop::RunInternal at message_loop.cc:199  #26	0x00688175 in MessageLoop::RunHandler at message_loop.cc:181  #27	0x00688200 in MessageLoop::Run at message_loop.cc:155  #28	0x0017c8ed in (anonymous namespace)::RunUIMessageLoop at browser_main.cc:200  #29	0x0017f97e in BrowserMain at browser_main.cc:789  #30	0x00003a7d in ChromeMain at chrome_dll_main.cc:540  #31	0x00002357 in main at chrome_exe_main.mm:34     </pre>