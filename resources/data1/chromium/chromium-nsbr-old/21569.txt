<title>Issue 21569 -   chromium -    Crash in NPP_NewStream due to reentrancy into Flash. - Project Hosting on Google Code</title> <pre> Found by Chromebot. It does not happen so often.    Reports:    http://chromebot/buildsummary?id=buildbot_25837_ext  http://chromebot/buildsummary?id=buildbot_25626_ext      chrome_2610000!NPAPI::PluginInstance::NPP_NewStream+0xcc   [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_instance.cc @ 230]  chrome_2610000!NPAPI::PluginStream::Open+0x30b [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_stream.cc @ 66]  chrome_2610000!NPAPI::PluginStreamUrl::DidReceiveResponse+0x28   [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_stream_url.cc @ 53]  chrome_2610000!WebPluginDelegateStub::OnDidReceiveResponse+0x34   [c:bslavechromium-rel-  xpbuildsrcchromepluginwebplugin_delegate_stub.cc @ 186]  chrome_2610000!IPC::MessageWithTuple&lt;Tuple1&lt;PluginMsg_DidReceiveResponsePar  ams&gt; &gt;::Dispatch&lt;WebPluginDelegateStub void (__thiscall   WebPluginDelegateStub::*)(PluginMsg_DidReceiveResponseParams const &amp;)&gt;+0x4e   [c:bslavechromium-rel-xpbuildsrcipcipc_message_utils.h @ 999]  chrome_2610000!WebPluginDelegateStub::OnMessageReceived+0x8d   [c:bslavechromium-rel-  xpbuildsrcchromepluginwebplugin_delegate_stub.cc @ 87]  chrome_2610000!MessageRouter::RouteMessage+0x33 [c:bslavechromium-rel-  xpbuildsrcchromecommonmessage_router.cc @ 41]  chrome_2610000!PluginChannelBase::OnMessageReceived+0x44   [c:bslavechromium-rel-xpbuildsrcchromepluginplugin_channel_base.cc   @ 116]  chrome_2610000!PluginChannel::OnMessageReceived+0x90 [c:bslavechromium-  rel-xpbuildsrcchromepluginplugin_channel.cc @ 86]  chrome_2610000!RunnableMethod&lt;ProfileWriter void (__thiscall   ProfileWriter::*)(GURL const &amp;) Tuple1&lt;GURL&gt; &gt;::Run+0x17   [c:bslavechromium-rel-xpbuildsrcbasetask.h @ 307]  chrome_2610000!MessageLoop::RunTask+0x7e [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 315]  chrome_2610000!MessageLoop::DoWork+0x1ea [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 437]  chrome_2610000!base::MessagePumpForUI::DoRunLoop+0x5a [c:bslavechromium-  rel-xpbuildsrcbasemessage_pump_win.cc @ 210]  chrome_2610000!base::MessagePumpWin::Run+0x40 [c:bslavechromium-rel-  xpbuildsrcbasemessage_pump_win.h @ 78]  chrome_2610000!MessageLoop::RunInternal+0xc0 [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 199]  chrome_2610000!MessageLoop::RunHandler+0x59 [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 175]  chrome_2610000!MessageLoop::Run+0x3d [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 156]  chrome_2610000!IPC::SyncChannel::WaitForReplyWithNestedMessageLoop+0x89   [c:bslavechromium-rel-xpbuildsrcipcipc_sync_channel.cc @ 433]  chrome_2610000!IPC::SyncChannel::WaitForReply+0xca [c:bslavechromium-  rel-xpbuildsrcipcipc_sync_channel.cc @ 420]  chrome_2610000!IPC::SyncChannel::SendWithTimeout+0x161   [c:bslavechromium-rel-xpbuildsrcipcipc_sync_channel.cc @ 398]  chrome_2610000!IPC::SyncChannel::Send+0x10 [c:bslavechromium-rel-  xpbuildsrcipcipc_sync_channel.cc @ 362]  chrome_2610000!PluginChannelBase::Send+0x63 [c:bslavechromium-rel-  xpbuildsrcchromepluginplugin_channel_base.cc @ 99]  chrome_2610000!PluginChannel::Send+0x9a [c:bslavechromium-rel-  xpbuildsrcchromepluginplugin_channel.cc @ 77]  chrome_2610000!NPObjectProxy::NPInvokePrivate+0x202 [c:bslavechromium-  rel-xpbuildsrcchromepluginnpobject_proxy.cc @ 205]  chrome_2610000!`anonymous namespace'::NPN_InvokePatch+0x22   [c:bslavechromium-rel-xpbuildsrcchromepluginnpobject_util.cc @ 41]  NPSWF32!unuse_netscape_plugin_Plugin+0x784f  NPSWF32!unuse_netscape_plugin_Plugin+0x7937  NPSWF32!DllUnregisterServer+0x1631  chrome_2610000!NPAPI::PluginInstance::NPP_NewStream+0xcc   [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_instance.cc @ 230]  chrome_2610000!NPAPI::PluginStream::Open+0x30b [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_stream.cc @ 66]  chrome_2610000!NPAPI::PluginStreamUrl::DidReceiveResponse+0x28   [c:bslavechromium-rel-  xpbuildsrcwebkitgluepluginsplugin_stream_url.cc @ 53]  chrome_2610000!WebPluginDelegateStub::OnDidReceiveResponse+0x34   [c:bslavechromium-rel-  xpbuildsrcchromepluginwebplugin_delegate_stub.cc @ 186]  chrome_2610000!IPC::MessageWithTuple&lt;Tuple1&lt;PluginMsg_DidReceiveResponsePar  ams&gt; &gt;::Dispatch&lt;WebPluginDelegateStub void (__thiscall   WebPluginDelegateStub::*)(PluginMsg_DidReceiveResponseParams const &amp;)&gt;+0x4e   [c:bslavechromium-rel-xpbuildsrcipcipc_message_utils.h @ 999]  chrome_2610000!WebPluginDelegateStub::OnMessageReceived+0x8d   [c:bslavechromium-rel-  xpbuildsrcchromepluginwebplugin_delegate_stub.cc @ 87]  chrome_2610000!MessageRouter::RouteMessage+0x33 [c:bslavechromium-rel-  xpbuildsrcchromecommonmessage_router.cc @ 41]  chrome_2610000!PluginChannelBase::OnMessageReceived+0x44   [c:bslavechromium-rel-xpbuildsrcchromepluginplugin_channel_base.cc   @ 116]  chrome_2610000!PluginChannel::OnMessageReceived+0x90 [c:bslavechromium-  rel-xpbuildsrcchromepluginplugin_channel.cc @ 86]  chrome_2610000!RunnableMethod&lt;ProfileWriter void (__thiscall   ProfileWriter::*)(GURL const &amp;) Tuple1&lt;GURL&gt; &gt;::Run+0x17   [c:bslavechromium-rel-xpbuildsrcbasetask.h @ 307]  chrome_2610000!MessageLoop::RunTask+0x7e [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 315]  chrome_2610000!MessageLoop::DoWork+0x1ea [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 437]  chrome_2610000!base::MessagePumpForUI::DoRunLoop+0x5a [c:bslavechromium-  rel-xpbuildsrcbasemessage_pump_win.cc @ 210]  chrome_2610000!base::MessagePumpWin::Run+0x40 [c:bslavechromium-rel-  xpbuildsrcbasemessage_pump_win.h @ 78]  chrome_2610000!MessageLoop::RunInternal+0xc0 [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 199]  chrome_2610000!MessageLoop::RunHandler+0x59 [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 175]  chrome_2610000!MessageLoop::Run+0x3d [c:bslavechromium-rel-  xpbuildsrcbasemessage_loop.cc @ 156]  chrome_2610000!PluginMain+0x5c1 [c:bslavechromium-rel-  xpbuildsrcchromepluginplugin_main.cc @ 148]  chrome_2610000!ChromeMain+0x696 [c:bslavechromium-rel-  xpbuildsrcchromeappchrome_dll_main.cc @ 564]  chrome!wWinMain+0x2fd [c:bslavechromium-rel-  xpbuildsrcchromeappchrome_exe_main.cc @ 104]  chrome!__tmainCRTStartup+0x176   [f:spvctoolscrt_bldself_x86crtsrccrt0.c @ 324] </pre>