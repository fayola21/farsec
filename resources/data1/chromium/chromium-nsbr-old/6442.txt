<title>Issue 6442 -   chromium -    Malware redirects should be blocked - Project Hosting on Google Code</title> <pre> Navigating to a URL flagged as malware/phishing which is a redirect triggers an interstitial but   still follows the redirect.    We should wait for the user to select proceed before we follow the redirect.    An example of this is www.rxpharmacyonline.net/6/ which redirects to <a href="http://xxxmovies.dip.jp/6/">http://xxxmovies.dip.jp/6/</a>    triggering a DCHECK in safe_browsing_resource_handler.cc (in OnUrlCheckResult() as we are trying to   show an interstitial when an interstitial is already showing).    How we could implement this:  In order to do that we would probably need to change ResourceHandler::OnRequestRedirected() to   return a state (PROCEED  BLOCK or PAUSE) instead of the current boolean.  Then the ResourceDispatcherHost::OnReceivedRedirect() would pause the URLRequest as a result of the   PAUSE state being returned.  URLRequestJob::NotifyHeadersComplete() when processing the redirect would check for the paused   status and would bail early without following the redirect. We would then need a way on the request   to resume the request  which we would call from the SafeBrowsingResourceHandler when the user has   notified us she wants to proceed. We would then follow the redirect.         </pre>