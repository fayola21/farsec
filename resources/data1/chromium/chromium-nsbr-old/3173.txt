<title>Issue 3173 -   chromium -    First call to winsock async connect is slow - Project Hosting on Google Code</title> <pre> I have been doing some startup profiling.  I found that on the first call   to ws2_32!connect()  if the socket is async  a bunch of internal work is   performed and a helper thread is spawned.  The first call to connect()   takes about 6ms on my machine  all calls after are about 20x faster.  One   strategy I tried was to warm up winsock by making a connect() while we are   waiting on the first dns request  avoiding a 6ms block.  I verified that   ConnectEx() avoids all of this startup work  so that is probably the   correct solution.    &gt;async_connect.exe  freq: 3579545  25630  1008  1790  844  832    #include &lt;winsock2.h&gt;  #include &lt;mswsock.h&gt;        #include &lt;stdio.h&gt;        void do_connect() {    SOCKET s = socket(AF_INET  SOCK_STREAM  IPPROTO_TCP);          unsigned long opt = 1;    ioctlsocket(s  FIONBIO  &amp;opt);          struct sockaddr_in sa;    sa.sin_family = AF_INET;    sa.sin_addr.s_addr = 0;    sa.sin_port = 0;    connect(s  (SOCKADDR*)&amp;sa  sizeof(sa));    closesocket(s);  }           int main() {    WORD winsock_ver = MAKEWORD(2 2);    WSAData wsa_data;    WSAStartup(winsock_ver  &amp;wsa_data);      LARGE_INTEGER freq  start  end;    QueryPerformanceFrequency(&amp;freq);    printf(&quot;freq: %I64dn&quot;  freq.QuadPart);          for (int i = 0; i &lt; 5; ++i) {      QueryPerformanceCounter(&amp;start);      do_connect();      QueryPerformanceCounter(&amp;end);      printf(&quot;%I64dn&quot;  end.QuadPart - start.QuadPart);    }   }   </pre>