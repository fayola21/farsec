<title>Issue 13780 -   chromium -    Crash in V8Proxy::UpdateDocumentWrapperCache - Project Hosting on Google Code</title> <pre> Crash in V8Proxy::UpdateDocumentWrapperCache    At frame teardown time  it is sometimes the case that the Frame's Document has a null Frame pointer.  Inside   V8Proxy::UpdateDocumentWrapperCache  we call NodeToV8Object  which is given the Document with no Frame.  The result from   NodeToV8Object is a Value that appears to be bogus.    This results in a crash that sometimes shows up as a webkit test failure here or there on the buildbots.  I was able to   trap it in the debugger by hacking run_webkit_tests.sh to run the same test many times in a loop.    Stack trace:  &gt;	test_shell.exe!v8::internal::HeapObject::map_word()  Line 939 + 0x3 bytes	C++   	test_shell.exe!v8::internal::HeapObject::map()  Line 929 + 0xc bytes	C++   	test_shell.exe!v8::internal::Object::IsJSFunction()  Line 391 + 0x22 bytes	C++   	test_shell.exe!v8::internal::JSObject::AddProperty(v8::internal::String * name=0x068001bd  v8::internal::Object *   value=0xdddddddd  PropertyAttributes attributes=5)  Line 1271 + 0x8 bytes	C++   	test_shell.exe!v8::internal::JSObject::IgnoreAttributesAndSetLocalProperty(v8::internal::String * name=0x068001bd    v8::internal::Object * value=0xdddddddd  PropertyAttributes attributes=5)  Line 1807 + 0x14 bytes	C++   	test_shell.exe!v8::internal::JSObject::IgnoreAttributesAndSetLocalProperty(v8::internal::String * name=0x068001bd    v8::internal::Object * value=0xdddddddd  PropertyAttributes attributes=5)  Line 1802 + 0x1f bytes	C++   	test_shell.exe!v8::internal::Runtime::ForceSetObjectProperty(v8::internal::Handle&lt;v8::internal::JSObject&gt;   js_object={...}  v8::internal::Handle&lt;v8::internal::Object&gt; key={...}  v8::internal::Handle&lt;v8::internal::Object&gt;   value={...}  PropertyAttributes attr=5)  Line 2764 + 0x25 bytes	C++   	test_shell.exe!v8::internal::ForceSetProperty(v8::internal::Handle&lt;v8::internal::JSObject&gt; object={...}    v8::internal::Handle&lt;v8::internal::Object&gt; key={...}  v8::internal::Handle&lt;v8::internal::Object&gt; value={...}    PropertyAttributes attributes=5)  Line 221 + 0x103 bytes	C++   	test_shell.exe!v8::Object::ForceSet(v8::Handle&lt;v8::Value&gt; key={...}  v8::Handle&lt;v8::Value&gt; value={...}    v8::PropertyAttribute attribs=5)  Line 1888 + 0x19 bytes	C++   	test_shell.exe!WebCore::V8Proxy::UpdateDocumentWrapperCache()  Line 1802	C++   	test_shell.exe!WebCore::V8Proxy::updateDocument()  Line 1929	C++   	test_shell.exe!WebCore::V8Proxy::InitContextIfNeeded()  Line 2209	C++   	test_shell.exe!WebCore::V8Proxy::clearForNavigation()  Line 1876	C++   	test_shell.exe!WebCore::ScriptController::clearWindowShell()  Line 379	C++   	test_shell.exe!WebCore::FrameLoader::clear(bool clearWindowProperties=true  bool clearScriptObjects=true)  Line 854	  C++   	test_shell.exe!WebCore::FrameLoader::begin(const WebCore::KURL &amp; url={...}  bool dispatch=false    WebCore::SecurityOrigin * origin=0x00000000)  Line 946	C++   	test_shell.exe!WebCore::FrameLoader::receivedFirstData()  Line 888	C++   	test_shell.exe!WebCore::FrameLoader::setEncoding(const WebCore::String &amp; name={...}  bool userChosen=false)  Line   1811	C++   	test_shell.exe!WebFrameImpl::DidReceiveData(WebCore::DocumentLoader * loader=0x0868d978  const char *   data=0x05c4da40  int length=913)  Line 1601	C++   	test_shell.exe!WebFrameLoaderClient::committedLoad(WebCore::DocumentLoader * loader=0x0868d978  const char *   data=0x05c4da40  int length=913)  Line 1128 + 0x24 bytes	C++   	test_shell.exe!WebCore::FrameLoader::committedLoad(WebCore::DocumentLoader * loader=0x0868d978  const char *   data=0x05c4da40  int length=913)  Line 3640 + 0x24 bytes	C++   	test_shell.exe!WebCore::DocumentLoader::commitLoad(const char * data=0x05c4da40  int length=913)  Line 362	C++   	test_shell.exe!WebCore::DocumentLoader::receivedData(const char * data=0x05c4da40  int length=913)  Line 374	C++   	test_shell.exe!WebCore::FrameLoader::receivedData(const char * data=0x05c4da40  int length=913)  Line 2459	C++   	test_shell.exe!WebCore::MainResourceLoader::addData(const char * data=0x05c4da40  int length=913  bool   allAtOnce=false)  Line 149	C++   	test_shell.exe!WebCore::ResourceLoader::didReceiveData(const char * data=0x05c4da40  int length=913  __int64   lengthReceived=913  bool allAtOnce=false)  Line 257 + 0x1b bytes	C++   	test_shell.exe!WebCore::MainResourceLoader::didReceiveData(const char * data=0x05c4da40  int length=913  __int64   lengthReceived=913  bool allAtOnce=false)  Line 361	C++   	test_shell.exe!WebCore::ResourceLoader::didReceiveData(WebCore::ResourceHandle * __formal=0x08695970  const char *   data=0x05c4da40  int length=913  int lengthReceived=913)  Line 411 + 0x1f bytes	C++   	test_shell.exe!WebCore::ResourceHandleInternal::didReceiveData(WebKit::WebURLLoader * __formal=0x05cc3f98  const   char * data=0x05c4da40  int dataLength=913  __int64 totalDataLength=913)  Line 162 + 0x31 bytes	C++   	test_shell.exe!webkit_glue::WebURLLoaderImpl::OnReceivedData(const char * data=0x05c4da40  int len=913)  Line 322 +   0x37 bytes	C++   	test_shell.exe!`anonymous namespace'::RequestProxy::NotifyReceivedData(int bytes_read=913)  Line 184 + 0x22 bytes	  C++   	test_shell.exe!DispatchToMethod&lt;`anonymous namespace'::RequestProxy void (__thiscall   A0x866a3e77::RequestProxy::*)(int) int&gt;(`anonymous-namespace'::RequestProxy * obj=0x05c4f320  void (int)*   method=0x00f54530  const Tuple1&lt;int&gt; &amp; arg={...})  Line 422 + 0x11 bytes	C++   	test_shell.exe!RunnableMethod&lt;`anonymous namespace'::RequestProxy void (__thiscall   A0x866a3e77::RequestProxy::*)(int) Tuple1&lt;int&gt; &gt;::Run()  Line 307 + 0x1e bytes	C++   	test_shell.exe!MessageLoop::RunTask(Task * task=0x05c4f3e0)  Line 310 + 0xf bytes	C++   	test_shell.exe!MessageLoop::DeferOrRunPendingTask(const MessageLoop::PendingTask &amp; pending_task={...})  Line 321	  C++   	test_shell.exe!MessageLoop::DoWork()  Line 424 + 0xc bytes	C++   </pre>