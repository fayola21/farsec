<title>Issue 21094 -   chromium -    &quot;Stop Syncing&quot; hangs with latest pre-release binary - Project Hosting on Google Code</title> <pre> Setup: The latest sync binary (gyp build  built by me  not yet released)    with --enable-sync specified  and with   chrome.dll!HttpBridge::AllowSendingCookies() modified to always return   false (so that we use the newer auth path).      1. With a fresh profile  enable sync.  This should succeed and download any   bookmarks in the account.  My account has maybe 40 bookmarks  with a max   changestamp around 2000.  2. From the wrench menu  select &quot;Sync my bookmarks . . .&quot;  3. Press the &quot;Stop Syncing&quot; button.  4. The process freezes up forever.    The sync core thread is stuck waiting for the notification system to be   torn down:         talk_base::Thread::Join() Line 183 + 0x14 bytes    C++       talk_base::Thread::Stop() Line 209    C++  &gt;    browser_sync::MediatorThreadImpl::Logout() Line 78 + 0x13 bytes    C++       browser_sync::TalkMediatorImpl::Logout() Line 153 + 0x20 bytes    C++       sync_api::SyncManager::SyncInternal::Shutdown() Line 1194 + 0x23 bytes      C++    Meanwhile  on the mediator thread  we seem to be spinning within libjingle.    I've interspersed some code here.        notifier::Timer::ProcessStart() Line 29    C++  int Timer::ProcessStart() {    return STATE_BLOCKED;  }  &gt;    talk_base::Task::Process(1) Line 202    C++  Doesn't make forward progress:        case STATE_START:          newstate = ProcessStart();          break;       talk_base::Task::Step() Line 108 + 0x16 bytes    C++  After calling Process  Step() keeps returning early because:    if (aborted_) {      Abort(true);  // no need to wake because we're awake       talk_base::TaskRunner::RunTasks() Line 76    C++  never terminates because of the following:  while (!tasks_[i]-&gt;Blocked()) {  // never terminates       notifier::TaskPump::OnMessage(0x0608fd0c) Line 29    C++       talk_base::MessageQueue::Dispatch(0x0608fd0c) Line 344 + 0x17 bytes      C++       talk_base::Win32SocketServer::Pump() Line 729 + 0x1b bytes    C++       talk_base::DummyWndProc(0x001605b6  49452  0  0) Line 762    C++     </pre>