<title>Issue 11777 -   chromium -    browserthemeprovider appears to be thread safe  but isn't - Project Hosting on Google Code</title> <pre> In browser_theme_provider.h  we make BrowserThemeProvider  RefCountedThreadSafe.  However  the image_cache_ is not used in a thread  safe manner.  That is  if two threads request the same image and it's not  in the cache  you'll end up leaking one of the images.  Neither is ImageMap  or ColorMap or TintMap.    Maybe we only make calls from one thread?  In that case  we can use regular  RefCounted and maybe base/non_thread_safe.h to verify that we're only using  one thread.    If we're making calls from multiple threads  you need to put locks around  these data members. </pre>