<title>Issue 3041 -   chromium -    DNS pre-fetching causes frequent internet loss - Project Hosting on Google Code</title>   1. If DNS prefetching is enabled  after browsing some pages for a while   (every half an hour aproximately)  my internet connection gets reset.  2. If it is disabled  everything works fine.      The internet connection should not drop.      The internet connection keeps dropping/resetting.    Please provide any additional information below. Attach a screenshot if   possible.  I'm using a 256K DSL connection throught a siemens speedstream 4200 modem.   I'm in Brazil. I'm guessing  maybe DNS pre-fetching opens too many   connections at once?     </pre>    </td>  </tr>          <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c1"  href="#c1">1</a>  by  <a style="white-space: nowrap" href="/u/patrick@chromium.org/">patrick@chromium.org</a></span>   <span class="date" title="Wed Oct  1 15:51:33 2008">Oct 01  2008</span>   <pre> <i>(No comment was entered for this change.)</i> </pre>      <div class="updates">  <div class="round4"></div>  <div class="round2"></div>  <div class="round1"></div>  <div class="box-inner">    j...@chromium.org<br>  -Area-Misc Area-BrowserBackend<br>  </div>  <div class="round1"></div>  <div class="round2"></div>  <div class="round4"></div>  </div>    </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c2"  href="#c2">2</a>  by  <a style="white-space: nowrap" href="/u/jim.roskind/">jim.roskind</a></span>   <span class="date" title="Wed Oct  1 16:50:49 2008">Oct 01  2008</span>   <pre> I'm suspicious this is conincidental.    DNS resolution is not achieved using &quot;connections.&quot;  It relies on UDP  which is a   connectionless protocol.  As a result  all DNS resolution does is send out a packet    and accept an incoming response packet containing the &quot;answer.&quot;  The packet size is   pretty small (about 60 bytes outgoing  90 bytes return).  The delay between lookups   is usually bounded by resolution time  which is averages about 200-300ms  although a   median time may be around 80ms.  DNS prefetch leaves no more than 8 lookups   outstanding at any time.    As a competing example  if you visited www.cnn.com I think you'd make about 7   simultaneous connections (full TCP/IP HTTP fetches) in parallel to load the page  and   most of those pages would include substantial incoming streams (to your browser).    Does a visit to such a site also cause your connection to be dropped?    Can you see if any of your neighbors with the same ISP have similar problems??  Could   it be your hardware??       </pre>      </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c3"  href="#c3">3</a>  by  <a style="white-space: nowrap" href="/u/enderecofacildelembrar/">enderecofacildelembrar</a></span>   <span class="date" title="Thu Oct  2 01:50:46 2008">Oct 02  2008</span>   <pre> Visited cnn.com and it doesn't makes the connection drop. But when I'm browsing  I   usually have many more openned pages  so I tried openning many links of this site in   different tabs (about 6). No problems either.    Then I closed them all and tried opening 4 sites at once in different tabs:  - terra.com.br  - uol.com.br  - stockimages.com  - stockphotos.com    The connection got reset.    So I disabled the DNS prefetching   closed all the tabs and tried opening other sites   that where not cached. Everything worked fine.    I don't think its the hardware that is causing this  because I never had similar   problems before  even while running a browser side by side with  let's say  Azureus.   Anyway  I'll ask around and see if I can get more details from somebody else. </pre>      </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c4"  href="#c4">4</a>  by  <a style="white-space: nowrap" href="/u/jim.roskind/">jim.roskind</a></span>   <span class="date" title="Thu Oct  2 09:57:26 2008">Oct 02  2008</span>   <pre> Interesting data.      Just trying to get more data.... could you run Window's Task Manager  and see if the   CPU gets pegged at 100% during any of these experiments?  Is there a chance that   you're running on a slower machine  and it is starving the network stack for time?    One interesting experiment that you might try to be a little more controlled:    a) Open the 4 sites you mentioned above.  b) Using Options  tell Google Chrome to &quot;On startup&quot; &quot;restore the same pages as were   opened last time&quot;.  c) Select either DNS enabled or disabled.  d) Close the browser.  e) restart the browser. (which should automatically open the 4 pages you listed).    You can then try a few time  with DNS enabled  and disabled  and see if it   consistently drops the connection.    Can you tell me a little more about your setup?  Are you running XP or Vista?  I   assume you're using dialup.... are you using any &quot;special&quot; dial-up software provided   by your ISP  or are you using default windows dialer?  How much memory?  How fast is   your machine?  Is it a single core processor?    Thanks in advance     Jim </pre>      </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c5"  href="#c5">5</a>  by  <a style="white-space: nowrap" href="/u/enderecofacildelembrar/">enderecofacildelembrar</a></span>   <span class="date" title="Sun Oct  5 02:56:55 2008">Oct 05  2008</span>   <pre> Hi  I have a dual boot machine  pentium d 3 GHz  2GB RAM  running windows xp sp3 and   vista sp1. The problem occurs on both operating systems. I'm using DSL  not dialup. I   have 2 pcs and the modem/router (a siemens speedstream 4200) connected throught a   network switch. The line speed is 256k. The connection gets reset on the modem  not   in my machine  even if only one pc is accessing the net.    I asked a friend of mine that uses the same ISP (Brasil Telecom)  but has a different   modem/router and different speed (d-link 500 something and 512k). He told he never   had any connection problems running Chrome.    I'll try to gather more info and report back.    Cheers  Luiz </pre>      </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c6"  href="#c6">6</a>  by  <a style="white-space: nowrap" href="/u/imre.polik/">imre.polik</a></span>   <span class="date" title="Wed Oct 29 08:42:46 2008">Oct 29  2008</span>   <pre> I experience exactly the same. My internet connection is 5Mbps cable  which I use   through a Linksys wifi router. Occasionally  my internet connection drops  and so   does my wife's. We can both ping the wifi router  but can not resolve DNS adresses.   Pinging an outside IP works  also Skype remains connected  it probably uses hardwired   IP addresses. I happened with both my ISP's DNS provider and OpenDNS. My guess is   that Chrome generates too many/malformed/? DNS queries and as a result we get blocked   for a certain period of time.    The problem is not 100% reproduceable. Weird  but it happens more in the evening than   in the morning. I've never had this problem at my workplace  we have our own DNS   servers. </pre>      </td>  </tr>        <tr class="cursor_off">  <td class="vt issuecomment">        <span class="author">Comment <a name="c7"  href="#c7">7</a>  by  <a style="white-space: nowrap" href="/u/jar@chromium.org/">jar@chromium.org</a></span>   <span class="date" title="Wed Oct 29 10:21:21 2008">Oct 29  2008</span>   <pre> There are at least two phrases used here to describe a problem.  The original poster ( enderecofacildelembrar ) said the connection &quot;was reset &quot; and imre.polik   said the connection &quot;was dropped.&quot;  Imre also said that IP based traffic (such as skype) continued to be communicated  but DNS lookups were failing.    I think the original post *probably* meant something like &quot;the phone line disconnected&quot; or &quot;the router did a reboot.&quot;  I believe Imre may have been describing   a failure in a router  which was performing DNS.  For example  there might be a watchdog that reset the non-responsive DNS resolver process inside the router   after some time period.  ...however... the problem may involve the caches on the PC where Chromium is running.    For Imre  can you see if the problem is perchance the OS cache  or perchance the application cache.  The DNS resolutions are cached separately in both places   (with Chromium's current network stack... which will soon change).  To see if the problem is in Chromium's application cache  check to see if exiting and   restarting Chromium resolves the problem.  If that doesn't resolve the problem  check to see if flushing the OS cache via the command &quot;ipconfig /dnsflush&quot; has   an impact.  It is also possible that bug <a href="http://code.google.com/p/chromium/issues/detail?id=3819">http://code.google.com/p/chromium/issues/detail?id=3819</a> is related (as was pointed out in that bug)    Although Chromium can potentially perform many prefetches (pre-resolutions)  it is currently limited to no more than 8 simultaneous outstanding requests (from   the prefetcher).  There is some possibility that other navigations might instigate some parallel resolutions (such as for background tabs  etc.).  In general    the total limit is pretty small  and probably comparable to having several users on your LAN.     Please provide