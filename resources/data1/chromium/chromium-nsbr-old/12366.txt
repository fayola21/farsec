<title>Issue 12366 -   chromium -    Memory leak in Canvas::SizeStringInt() - Project Hosting on Google Code</title> <pre> We got a new memory leak in Canvas::SizeStringInt() starting with <a href="/p/chromium/source/detail?r=16535">r16535</a>.    <a href="http://build.chromium.org/buildbot/waterfall.fyi/builders/Linux%20UI%201%20of%203%20(valgrind)/builds/779/">http://build.chromium.org/buildbot/waterfall.fyi/builders/Linux%20UI%201%20of%203%20(valgrind)/builds/779/</a>    17:59:49 valgrind_analyze.py [ERROR] Leak_DefinitelyLost  416 (256 direct  160 indirect) bytes in 1 blocks are definitely lost in  loss record 136 of 233    malloc (mp/valgrind-3.4.1/coregrind/m_replacemalloc/vg_replace_malloc.c:207)    0xD54E608 (/usr/lib32/libcairo.so.2.17.3)    0xD54E952 (/usr/lib32/libcairo.so.2.17.3)    cairo_image_surface_create (/usr/lib32/libcairo.so.2.17.3)    gfx::Canvas::SizeStringInt(std::basic_string&lt;wchar_t   std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;  gfx::Font  const&amp;  int*  int*  int) (app/gfx/canvas_linux.cc:61)    gfx::Font::GetStringWidth(std::basic_string&lt;wchar_t   std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;) const  (app/gfx/font_skia.cc:133)    gfx::ElideFilename(FilePath const&amp;  gfx::Font const&amp;  int)  (app/gfx/text_elider.cc:276)    DownloadItemGtk::DownloadItemGtk(DownloadShelfGtk*   BaseDownloadItemModel*) (chrome/browser/gtk/download_item_gtk.cc:178)    DownloadShelfGtk::AddDownload(BaseDownloadItemModel*)  (chrome/browser/gtk/download_shelf_gtk.cc:137)    TabContents::OnStartDownload(DownloadItem*)  (chrome/browser/tab_contents/tab_contents.cc:956)    DownloadManager::ShowDownloadInBrowser(DownloadCreateInfo const&amp;   DownloadItem*) (chrome/browser/download/download_manager.cc:1528)    DownloadManager::OnCreateDownloadEntryComplete(DownloadCreateInfo  long  long) (chrome/browser/download/download_manager.cc:1466)    CallbackImpl&lt;DownloadManager  void  (DownloadManager::*)(DownloadCreateInfo  long long)   Tuple2&lt;DownloadCreateInfo  long long&gt;  &gt;::RunWithParams(Tuple2&lt;DownloadCreateInfo  long long&gt; const&amp;)  (base/tuple.h:429)    CancelableRequest&lt;CallbackRunner&lt;Tuple2&lt;DownloadCreateInfo  long long&gt; &gt;  &gt;::ExecuteCallback(Tuple2&lt;DownloadCreateInfo  long long&gt; const&amp;)  (chrome/browser/cancelable_request.h:503)     RunnableMethod&lt;CancelableRequest&lt;CallbackRunner&lt;Tuple2&lt;DownloadCreateInfo   long long&gt; &gt; &gt;  void  (CancelableRequest&lt;CallbackRunner&lt;Tuple2&lt;DownloadCreateInfo  long long&gt; &gt;  &gt;::*)(Tuple2&lt;DownloadCreateInfo  long long&gt; const&amp;)   Tuple1&lt;Tuple2&lt;DownloadCreateInfo  long long&gt; &gt; &gt;::Run() (base/tuple.h:422)    MessageLoop::RunTask(Task*) (base/message_loop.cc:309)    MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;)  (base/message_loop.cc:317)    MessageLoop::DoWork() (base/message_loop.cc:423)    base::MessagePumpForUI::HandleDispatch() (base/message_pump_glib.cc:194)    (anonymous namespace)::WorkSourceDispatch(_GSource*  int (*)(void*)   void*) (base/message_pump_glib.cc:76)    g_main_context_dispatch (/usr/lib32/libglib-2.0.so.0.1600.3)    0xD617E5D (/usr/lib32/libglib-2.0.so.0.1600.3)    g_main_context_iteration (/usr/lib32/libglib-2.0.so.0.1600.3)    base::MessagePumpForUI::Run(base::MessagePump::Delegate*)  (base/message_pump_glib.cc:153)    MessageLoop::RunInternal() (base/message_loop.cc:198)    MessageLoop::RunHandler() (base/message_loop.cc:181)    MessageLoop::Run() (base/message_loop.cc:155)    (anonymous namespace)::RunUIMessageLoop(BrowserProcess*)  (chrome/browser/browser_main.cc:193)    BrowserMain(MainFunctionParams const&amp;) (chrome/browser/browser_main.cc:690)    ChromeMain (chrome/app/chrome_dll_main.cc:490)   </pre>