<title>Issue 9563 -   chromium -    Mem leak in test_shell_tests - PlatformCanvas.SkLayer - Project Hosting on Google Code</title> <pre> Valgrind on Mac thinks that test_shell_tests leaks memory.  We want to enable auto-analysis on valgrind output  before which the detected leaks need to   be fixed (or suppressed).    I'm marking it to you since you were the last person to have touched this. If this is an error    please feel free to reassign to someone more appropriate (or bounce back to me).    The leaking test is: PlatformCanvas.SkLayer  The following is valgrind's output. (Refer waterfall for latest).      ==23659== 6 336 (176 direct  6 160 indirect) bytes in 11 blocks are definitely lost in loss   record 564 of 680  ==23659==    at 0x4509D63: malloc (vg_replace_malloc.c:193)  ==23659==    by 0x7283BDC: stdSmartNewPtr (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0x7283B3F: stdSmartNewHandle (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0x7283AE6: IOCreateAndOpen (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0x72836CF: ScratchInit (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0x7282960: CMOpenOrNewAccess (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0x72825DB: CMOpenProfile (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync  .framework/Versions/A/ColorSync)  ==23659==    by 0xAAB37FC: createProfileBySpaceFromShmem (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/Resources/libCSync.A.dylib)  ==23659==    by 0xAAB3A0F: CMSGetSystemDefaultProfile (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/Resources/libCSync.A.dylib)  ==23659==    by 0xAAB5DA9: deviceSet (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/Resources/libCSync.A.dylib)  ==23659==    by 0xAAB352F: cmsDataProviderGetBytes (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/Resources/libCSync.A.dylib)  ==23659==    by 0xAABA54E: CMSValidateProfile (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/Resources/libCSync.A.dylib)  ==23659==    by 0x7440C1E: CGCMSInterfaceValidateProfile (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/CoreGraphics)  ==23659==    by 0x7440BFE: CGCMSUtilsValidateProfile (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/CoreGraphics)  ==23659==    by 0x7440B28: CGColorSpaceCreateICCBased (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/CoreGraphics)  ==23659==    by 0x73EFB15: create_generic_color_space (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/CoreGraphics)  ==23659==    by 0x7394DD9: CGColorSpaceCreateWithIndex (in   /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGrap  hics.framework/Versions/A/CoreGraphics)  ==23659==    by 0xBD7BC: skia::BitmapPlatformDeviceMac::Create(CGContext*  int  int  bool)   (bitmap_platform_device_mac.cc:149)  ==23659==    by 0xC4C1A: std::vector&lt;short  StackAllocator&lt;short  64ul&gt; &gt;::push_back(short   const&amp;) (stl_vector.h:602)  ==23659==    by 0xC4E2F: skia::PlatformCanvasMac::initialize(int  int  bool)   (platform_canvas_mac.cc:62)  ==23659==    by 0xC5124: skia::PlatformCanvasMac::PlatformCanvasMac(int  int  bool    CGContext*) (platform_canvas_mac.cc:25)  ==23659==    by 0x6A25: skia::PlatformCanvas_SkLayer_Test::TestBody()   (platform_canvas_unittest.cc:230)  ==23659==    by 0x12A429: testing::Test::Run() (gtest.cc:2018)  ==23659==    by 0x12EF18: testing::internal::TestInfoImpl::Run() (gtest.cc:2250)  ==23659==    by 0x134FD4: testing::Message&amp; testing::Message::operator&lt;&lt; &lt;unsigned long   long&gt;(unsigned long long const&amp;) (gtest-message.h:116)  ==23659==    by 0x12F8CE: testing::internal::List&lt;testing::TestPartResult&gt;::size() const (gtest-  internal-inl.h:283)  ==23659==    by 0x12EE01: testing::UnitTest::Run() (gtest.cc:3403)  ==23659==    by 0x134FB8: testing::TestCase::RunTestCase(testing::TestCase*) (gtest-  internal.h:97)  ==23659==    by 0x12F714:   __gnu_cxx::__normal_iterator&lt;testing::internal::ParameterizedTestCaseInfoBase**    std::vector&lt;testing::internal::ParameterizedTestCaseInfoBase*    std::allocator&lt;testing::internal::ParameterizedTestCaseInfoBase*&gt; &gt; &gt;::operator++()   (stl_iterator.h:623)  ==23659==    by 0x12EC6E: testing::internal::UnitTestImpl::RunAllTests() (gtest.cc:3655)  ==23659==  ==23659==     </pre>