<title>Issue 17822 -   chromium -    Save monitor work rects with window positions  use them to determine how to adjust restored windows - Project Hosting on Google Code</title> <pre> (For background see <a title="Chrome window resized to fill the screen fully vertically (but not horizontally) is tens of pixels shorter after restart" class=closed_ref href="/p/chromium/issues/detail?id=9587"> issue 9587 </a> and <a title="REGRESSION: Position always off-screen when starting up" class=closed_ref href="/p/chromium/issues/detail?id=15199"> issue 15199 </a>)    Our current code tries to adjust window positions at creation time to make   them usable.  We used to have some (broken) code to try and make windows   completely visible onscreen; this interfered with purposeful partly-  offscreen positions people set themselves.  Then we changed it to only   require a tiny bit of the window onscreen; this made it hard to use windows   that were positioned on monitors that disappeared.    Here's my proposal for an algorithm to try and handle all those cases:  * When saving window positions  also save the monitor work rects.  * When restoring those positions  traverse the saved work rects  and check   each against the current monitor work rects.  If we find a rect that no   longer exists  determine all windows whose rect intersected this work rect.    Adjust them all to be fully visible on the existing monitors.    I am not sure what  if anything  needs to happen when creating a new window   (which gets based on a previous window position).  We probably need to   check if the window would be partly invisible and adjust it.    The adjustment algorithm would ideally not resize windows if possible.    This can be tricky to do optimally with multi-monitor setups.  Imagine one   wide monitor atop two narrow monitors  which then gets removed.  Ideally   we'd like to move windows down into the pair of narrow monitors  rather   than narrow them to fit onto just one monitor.  Perhaps we can just be   suboptimal here without anyone caring. </pre>