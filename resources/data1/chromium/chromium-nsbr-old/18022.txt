<title>Issue 18022 -   chromium -    Whole browser hangs (very occasionally) - Project Hosting on Google Code</title> <pre> Chrome Version       : 3.0.195.1  OS + version : Fedora 9  CPU architecture (32-bit / 64-bit): 32-bit  window manager : metacity          I got a total hang in the browser UI.  I have not reproduced it.    Backtrace is useless as this is built by Google without debugging symbols.   But the strace should provide a clue:    $ strace -p 9424  Process 9424 attached - interrupt to quit  write(5  &quot;!&quot;  1    Here's a pstree output  showing that 9424 is indeed the parent browser UI  process:    bash(2755)��_��_��_��_��_��_��_��_��_chrome(9424)��_��_��_��_��_��_��_��_��_chrome(6423)                            ��_��_��_��_��_��_chrome(7421)                            ��_��_��_��_��_��_chrome(8298)                            ��_��_��_��_��_��_chrome(9454)                            ��_��_��_��_��_��_chrome(9455)��_��_��_��_��_��_��_��_��_chrome(9500)��_��_��_��_��_��_��_��_��_{chrome}(9501)                            ��_��_��_              ��_��_��_              ��_��_��_��_��_��_{chrome}(9502)                            ��_��_��_              ��_��_��_��_��_��_chrome(9503)��_��_��_��_��_��_��_��_��_{chrome}(9504)                            ��_��_��_                             ��_��_��_��_��_��_{chrome}(9505)                            ��_��_��_��_��_��_chrome(9486)                            ��_��_��_��_��_��_chrome(9699)                            ��_��_��_��_��_��_chrome(10445)                            ��_��_��_��_��_��_chrome(10573)                            ��_��_��_��_��_��_chrome(11168)                            ��_��_��_��_��_��_chrome(11640)                            ��_��_��_��_��_��_chrome(12265)                            ��_��_��_��_��_��_chrome(13206)                            ��_��_��_��_��_��_chrome(13439)                            ��_��_��_��_��_��_chrome(14514)                            ��_��_��_��_��_��_chrome(15414)                            ��_��_��_��_��_��_chrome(16333)                            ��_��_��_��_��_��_chrome(17352)                            ��_��_��_��_��_��_chrome(18283)                            ��_��_��_��_��_��_chrome(20206)                            ��_��_��_��_��_��_chrome(21222)                            ��_��_��_��_��_��_chrome(22112)                            ��_��_��_��_��_��_chrome(23447)                            ��_��_��_��_��_��_chrome(24508)                            ��_��_��_��_��_��_chrome(25421)                            ��_��_��_��_��_��_chrome(27236)                            ��_��_��_��_��_��_{chrome}(9439)                            ��_��_��_��_��_��_{chrome}(9440)                            ��_��_��_��_��_��_{chrome}(9441)                            ��_��_��_��_��_��_{chrome}(9450)                            ��_��_��_��_��_��_{chrome}(9451)                            ��_��_��_��_��_��_{chrome}(9506)                            ��_��_��_��_��_��_{chrome}(23571)    I noticed lots of these processes are zombies.  Dunno if that's relevant or  not:    $ ps -eTf |grep 9424  chris     6423  6423  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris     7421  7421  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris     8298  8298  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris     9424  9424  2755  1 Jul25 pts/0    01:30:37 /opt/google/chrome/chrome  chris     9424  9439  2755  0 Jul25 pts/0    00:00:05 /opt/google/chrome/chrome  chris     9424  9440  2755  0 Jul25 pts/0    00:00:00 /opt/google/chrome/chrome  chris     9424  9441  2755  0 Jul25 pts/0    00:21:35 /opt/google/chrome/chrome  chris     9424  9450  2755  0 Jul25 pts/0    00:00:21 /opt/google/chrome/chrome  chris     9424  9451  2755  0 Jul25 pts/0    00:01:04 /opt/google/chrome/chrome  chris     9424  9506  2755  0 Jul25 pts/0    00:00:09 /opt/google/chrome/chrome  chris     9424 23571  2755  0 Jul28 pts/0    00:00:00 /opt/google/chrome/chrome  chris     9454  9454  9424  0 Jul25 pts/0    00:00:00 /opt/google/chrome/chrome  chris     9455  9455  9424  0 Jul25 pts/0    00:00:00  /opt/google/chrome/chrome --type=zygote  chris     9486  9486  9424  0 Jul25 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris     9699  9699  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    10445 10445  9424  0 Jul25 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    10573 10573  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    11168 11168  9424  0 Jul25 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    11640 11640  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    12265 12265  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    13206 13206  9424  0 Jul26 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    13439 13439  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    14514 14514  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    15414 15414  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    16333 16333  9424  0 Jul27 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    17352 17352  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    18283 18283  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    20206 20206  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    21222 21222  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    22112 22112  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    23447 23447  9424  0 Jul28 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    24508 24508  9424  0 00:10 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    25421 25421  9424  0 04:10 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    27236 27236  9424  0 08:10 pts/0    00:00:00 [chrome] &lt;defunct&gt;  chris    28604 28604  3940  0 12:55 pts/3    00:00:00 grep 9424      An lsof dump shows that the fd it was writing to was a pipe.    $ lsof -p 9424 |grep FIFO  chrome  9424 chris    4r  FIFO        0 6            4177309 pipe  chrome  9424 chris    5w  FIFO        0 6            4177309 pipe  chrome  9424 chris    9r  FIFO        0 6            4177312 pipe  chrome  9424 chris   10w  FIFO        0 6            4177312 pipe  chrome  9424 chris   19r  FIFO        0 6            4177318 pipe  chrome  9424 chris   20w  FIFO        0 6            4177318 pipe  chrome  9424 chris   24r  FIFO        0 6            4177359 pipe  chrome  9424 chris   25w  FIFO        0 6            4177359 pipe  chrome  9424 chris   26r  FIFO        0 6            4177360 pipe  chrome  9424 chris   27w  FIFO        0 6            4177360 pipe  chrome  9424 chris   28r  FIFO        0 6            4177361 pipe  chrome  9424 chris   29w  FIFO        0 6            4177361 pipe  chrome  9424 chris   42r  FIFO        0 6            4177376 pipe  chrome  9424 chris   43w  FIFO        0 6            4177376 pipe      I don't know which process or thread is supposed to be reading from the  other end of that pipe.  I just ran strace on all threads in the hopes of  finding something useful.    $ strace -p 9439  Process 9439 attached - interrupt to quit  clock_gettime(CLOCK_MONOTONIC  {1389668  155504134}) = 0  epoll_wait(6     $ strace -p 9440  Process 9440 attached - interrupt to quit  futex(0x212de7c  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 9441  Process 9441 attached - interrupt to quit  write(5  &quot;!&quot;  1    $ strace -p 9450  Process 9450 attached - interrupt to quit  futex(0x3b62e7c  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 9451  Process 9451 attached - interrupt to quit  restart_syscall(&lt;... resuming interrupted call ...&gt;) = -1 ETIMEDOUT  (Connection timed out)  gettimeofday({1248887027  801618}  {240  0}) = 0  futex(0x5306ecc  FUTEX_WAKE_PRIVATE  1) = 0  gettimeofday({1248887027  801887}  {240  0}) = 0  gettimeofday({1248887027  801993}  {240  0}) = 0  gettimeofday({1248887027  802276}  {240  0}) = 0  gettimeofday({1248887027  802381}  {240  0}) = 0  gettimeofday({1248887027  802497}  {240  0}) = 0  gettimeofday({1248887027  802621}  {240  0}) = 0  gettimeofday({1248887027  802720}  {240  0}) = 0  gettimeofday({1248887027  802817}  {240  0}) = 0  gettimeofday({1248887027  802916}  {240  0}) = 0  gettimeofday({1248887027  803012}  {240  0}) = 0  gettimeofday({1248887027  803136}  {240  0}) = 0  gettimeofday({1248887027  803245}  {240  0}) = 0  gettimeofday({1248887027  803342}  NULL) = 0  clock_gettime(CLOCK_REALTIME  {1248887027  803446606}) = 0  futex(0x5306e9c  FUTEX_WAIT_PRIVATE  1  {2  872935394}) = -1 ETIMEDOUT  (Connection timed out)  gettimeofday({1248887030  676763}  {240  0}) = 0  futex(0x5306ecc  FUTEX_WAKE_PRIVATE  1) = 0  gettimeofday({1248887030  677007}  {240  0}) = 0  clock_gettime(CLOCK_MONOTONIC  {1389828  420062976}) = 0  gettimeofday({1248887030  677253}  {240  0}) = 0  gettimeofday({1248887030  677385}  {240  0}) = 0  gettimeofday({1248887030  677485}  {240  0}) = 0  gettimeofday({1248887030  677583}  {240  0}) = 0  gettimeofday({1248887030  677683}  {240  0}) = 0  gettimeofday({1248887030  677779}  {240  0}) = 0  gettimeofday({1248887030  677876}  {240  0}) = 0  gettimeofday({1248887030  677980}  {240  0}) = 0  gettimeofday({1248887030  678078}  NULL) = 0  clock_gettime(CLOCK_REALTIME  {1248887030  678200729}) = 0  futex(0x5306e9c  FUTEX_WAIT_PRIVATE  1  {19  999247271}    $ strace -p 9506  Process 9506 attached - interrupt to quit  futex(0x7120e7c  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 23571  Process 23571 attached - interrupt to quit  futex(0x5fc2e7c  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 9454  Process 9454 attached - interrupt to quit  restart_syscall(&lt;... resuming interrupted call ...&gt;    $ strace -p 9455  Process 9455 attached - interrupt to quit  recvmsg(3     $ strace -p 9500  Process 9500 attached - interrupt to quit  clock_gettime(CLOCK_MONOTONIC  {1390573  782338145}) = 0  epoll_wait(3     $ strace -p 9501  Process 9501 attached - interrupt to quit  futex(0xb6fb8e7c  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 9502  Process 9502 attached - interrupt to quit  futex(0xb112164  FUTEX_WAIT_PRIVATE  0  NULL    $ strace -p 9503  Process 9503 attached - interrupt to quit  clock_gettime(CLOCK_MONOTONIC  {1390626  184669346}) = 0  epoll_wait(3     $ strace -p 9504  Process 9504 attached - interrupt to quit  futex(0xb6fb8190  FUTEX_WAIT_PRIVATE  1  NULL    $ strace -p 9505  Process 9505 attached - interrupt to quit  futex(0xb11e8f4  FUTEX_WAIT_PRIVATE  0  NULL      I noticed this on stdout/stderr: (last few lines only)    [9424:9424:1337535562387:ERROR:/b/slave/chrome-official-linux/build/src/chrome/browser/autocomplete/autocomplete_popup_view_gtk.cc(319)]  Not implemented reached in virtual void  AutocompletePopupViewGtk::OnHoverEnabledOrDisabled(bool)  [9424:9424:1337536337583:ERROR:/b/slave/chrome-official-linux/build/src/chrome/browser/autocomplete/autocomplete_popup_view_gtk.cc(319)]  Not implemented reached in virtual void  AutocompletePopupViewGtk::OnHoverEnabledOrDisabled(bool)  [23564:23564:1337549224272:ERROR:/b/slave/chrome-official-linux/build/src/chrome/common/ipc_channel_posix.cc(421)]  pipe error (7): Connection reset by peer  Uncaught RangeError: Maximum call stack size exceeded  [9424:9424:1375942883874:ERROR:/b/slave/chrome-official-linux/build/src/chrome/browser/autocomplete/autocomplete_popup_view_gtk.cc(319)]  Not implemented reached in virtual void  AutocompletePopupViewGtk::OnHoverEnabledOrDisabled(bool)  [9424:9424:1375943503246:ERROR:/b/slave/chrome-official-linux/build/src/chrome/browser/autocomplete/autocomplete_popup_view_gtk.cc(319)]  Not implemented reached in virtual void  AutocompletePopupViewGtk::OnHoverEnabledOrDisabled(bool)      Maybe process 23564 is the one that is supposed to be reading the pipe  but  it aborted due to call stack overflow???  Just a wild guess.    In any case  I think the writing end of the pipe should be set O_NONBLOCK  if you aren't checking writability before writing.    Any other info that would help? </pre>