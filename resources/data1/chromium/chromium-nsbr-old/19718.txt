<title>Issue 19718 -   chromium -    Don't query-escape search keyword searches that aren't query parameters - Project Hosting on Google Code</title> <pre> If I have a search keyword with a URL like    example.com/%s  and I use it with a parameter like [foo/bar]  it should leave the slash   unescaped  resulting in example.com/foo/bar.    We still want to do full query-parameter escaping when the search keyword   is a query parameter  like google.com/search?q=%s   so we'd need some   heuristic.      I suggested:  The logic should basically just be something like    if (url.find('?') != std::string::npos)      param = QueryEscape(param)    And Peter elaborated:  Not precisely (consider &quot;<a href="http://google.com/%s/foo?type=x&quot;">http://google.com/%s/foo?type=x&quot;</a>)  but something   like that.  You'd also have to escape non-query args; for example  &quot;foo   bar&quot; in the path component of a URL needs to become &quot;foo%20bar&quot;.    The TemplateURL code is the place to go poking around for all this stuff.      PS: Note that the omnibox unescapes %-encoded text when *displaying* it    making it confusing to see when the code is actually %-escaping. </pre>