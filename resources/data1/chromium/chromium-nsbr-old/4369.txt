<title>Issue 4369 -   chromium -    Sandbox: Policy should be checked on the target process for Registry calls before asking the browser. - Project Hosting on Google Code</title> <pre> For filesystem calls we check the policy in the target process before   asking the broker to make the call for us.    We need to do the same thing for the registry. This is good for speed  but   the main problem is this one :    Suppose that you are a plugin process  running with a restricted token   giving you read access to hklm.    You call NtOpenKey with a path to a non-existent key.  The original call at   the top of the call returns NOT FOUND. Since it's not a success we ask the   broker. The broker returns DENIED.     At this point it would be great to be able to return the status code from   the broker  but this is clearly not working  since some apps will break if   they get Access Denied when they expect File not found.    If the target checks the policy before sending the request to the broker    then we would not have this problem and we would also return meaningful   error code.    See todos in registry_interception.cc    --      background: the rational to return the broken status code is the exact   opposite. Suppose that you have a lockdown token and you have a policy   giving you access to c:bleh*   and you try to access   c:blehdoes_not_exist. You first try it yourself  and get DENIED  then you   try the broker and it returns FILE_NOT_FOUND. Since you have a policy for   this path  you want to return the right access code (FILE_NOT_FOUND) to the   user  not DENIED.  </pre>