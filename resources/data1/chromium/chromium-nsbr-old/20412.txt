<title>Issue 20412 -   chromium -    Submitting a malformed chrome-extension url to chrome.toolstrip.expand crashes Chrome - Project Hosting on Google Code</title> <pre> Chrome Version       :   Chromium	4.0.203.0 (Developer Build 24113)  WebKit	532.0  V8	1.3.6  User Agent	Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US)   AppleWebKit/532.0 (KHTML  like Gecko) Chrome/4.0.203.0 Safari/532.0    URLs (if applicable) : chrome-extension://foo_bar.html    Other browsers tested: Not-applicable      1. Follow the getting-started steps for chrome-extensions.  2. Create an extension that makes use of toolstrip.expand(...).  Ie  the   following: (Note that in this case hello_mole.html is a file that exists in   the same directory as the hosted extension.):  &lt;script&gt;  function hello_world() {  	document.getElementById('log').innerHTML += &quot;inner html&quot;;  	  	chrome.toolstrip.expand(512  &quot;chrome-extension://hello_mole.html&quot;)}    function hello_close() {  	chrome.toolstrip.collapse();  }  &lt;/script&gt;  &lt;body&gt;  &lt;div class=&quot;toolstrip-button&quot; onclick=&quot;hello_world();&quot;&gt;    &lt;span&gt;Hello  World!&lt;/span&gt;  &lt;/div&gt;  &lt;div class=&quot;toolstrip-button&quot; onclick=&quot;hello_close();&quot;&gt;    &lt;span&gt;Close mole&lt;/span&gt;  &lt;/div&gt;  &lt;div&gt;  &lt;span id='log'&gt;Non-button!&lt;/span&gt;  &lt;/dif&gt;  &lt;/body&gt;    3.  Run chrome with the extension enabled.  4.  Click on the hello-world button to expand the toolstrip.  Chrome   crashes with the following stack-dump:    ---------------------------  Kr��_��_m  ---------------------------  [7592:8444:772726421:FATAL:extension_function_dispatcher.cc(215)] Check   failed: extension.   Backtrace:  	StackTrace::StackTrace [0x02C3AA26+70]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasedebug_util_win.cc:225)  	logging::LogMessage::~LogMessage [0x02BE60BE+606]   (c:chromium_srchomechrome-svntarballchromiumsrcbaselogging.cc:540)  	ExtensionFunctionDispatcher::ExtensionFunctionDispatcher   [0x03428E48+424] (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserextensionsextension_function_dispa  tcher.cc:217)  	ExtensionHost::DidNavigate [0x032DF4BC+188]   (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserextensionsextension_host.cc:221)  	RenderViewHost::OnMsgNavigate [0x03012E9B+459]   (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserrenderer_hostrender_view_host.cc:9  48)  	RenderViewHost::OnMessageReceived [0x03011625+725]   (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserrenderer_hostrender_view_host.cc:7  26)  	BrowserRenderProcessHost::OnMessageReceived [0x0335BC7E+750]   (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserrenderer_hostbrowser_render_proces  s_host.cc:791)  	IPC::ChannelProxy::Context::OnDispatchMessage [0x028394CD+141]   (c:chromium_srchomechrome-  svntarballchromiumsrcipcipc_channel_proxy.cc:204)  	DispatchToMethod&lt;IPC::ChannelProxy::Context void (__thiscall   IPC::ChannelProxy::Context::*)(IPC::Message const &amp;) IPC::Message&gt;   [0x0283C023+19] (c:chromium_srchomechrome-  svntarballchromiumsrcbasetuple.h:422)  	RunnableMethod&lt;IPC::ChannelProxy::Context void (__thiscall   IPC::ChannelProxy::Context::*)(IPC::Message const &amp;) Tuple1&lt;IPC::Message&gt;   &gt;::Run [0x0283B5F5+53] (c:chromium_srchomechrome-  svntarballchromiumsrcbasetask.h:307)  	MessageLoop::RunTask [0x02BC60E9+185] (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:314)  	MessageLoop::DeferOrRunPendingTask [0x02BC6195+53]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:325)  	MessageLoop::DoWork [0x02BC66B9+233] (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:429)  	base::MessagePumpForUI::DoRunLoop [0x02C2ED54+84]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_pump_win.cc:209)  	base::MessagePumpWin::RunWithDispatcher [0x02C2E572+130]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_pump_win.cc:52)  	MessageLoop::RunInternal [0x02BC593F+223]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:195)  	MessageLoop::RunHandler [0x02BC57C0+144]   (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:182)  	MessageLoopForUI::Run [0x02BC6F09+73] (c:chromium_srchomechrome-  svntarballchromiumsrcbasemessage_loop.cc:600)  	`anonymous namespace'::RunUIMessageLoop [0x02D5D493+51]   (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserbrowser_main.cc:207)  	BrowserMain [0x02D5F9FE+8814] (c:chromium_srchomechrome-  svntarballchromiumsrcchromebrowserbrowser_main.cc:824)  	ChromeMain [0x01C31CC9+1705] (c:chromium_srchomechrome-  svntarballchromiumsrcchromeappchrome_dll_main.cc:567)  	wWinMain [0x004099BA+618] (c:chromium_srchomechrome-  svntarballchromiumsrcchromeappchrome_exe_main.cc:102)  	__tmainCRTStartup [0x0050CC7F+687]   (f:ddvctoolscrt_bldself_x86crtsrccrt0.c:324)  	wWinMainCRTStartup [0x0050C9CD+13]   (f:ddvctoolscrt_bldself_x86crtsrccrt0.c:196)  	RegisterWaitForInputIdle [0x7C817077+73]    ---------------------------  OK     ---------------------------        The expanded page should display the url-not-available page.        Crash!   </pre>