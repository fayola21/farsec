<title>Issue 8729 -   chromium -    LayoutTests/http/tests/multipart/invalid-image-data.html fails - Project Hosting on Google Code</title> <pre> This test contains a multi-part image with 2 images.  The first image is a green square  the second is supposedly incorrect (it fails to decode even though I seem to be able to open it just fine).    The test expects when finished that the page will contain the green square.  We actually display nothing.    The problem is that the in WebKit  an image's content (the pixels) are decoded and cached when actually displayed.  In our case  we display the image when TestShell &quot;dump the pixels&quot;  which happens after the 2nd image has started loading.  At that point  the second image bad contents is all we have  we failed to decode and we don't display anything.    I believe this works in DumpRenderTree because as soon as a load is finished in a frame they repaint the frame (see FrameLoadDelegate.mm in   DumpRenderTree/mac).    Note that this also works if l10 in the test you replace the setTimeout with a direct call to notifyDone (as it causes the call to dump the pixels to happen   right after the 1st image is loaded  which defeats the purpose of the test).           </pre>