<title>Issue 13681 -   chromium -    Browser Crash @ BrowserView::SetDownloadShelfVisible() - Project Hosting on Google Code</title> <pre> ToT (<a href="/p/chromium/source/detail?r=17941">r17941</a>)    -Ctrl+Shift+N to Incognito window.  -Download a file  -Close the Incognito window after download is finished.    Browser window crashes.    I'm marking this as DEV release block.      Crash Analysis  ##############    FAULTING_IP:   I+523  00000524 ??              ???    EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)  ExceptionAddress: 00000524 (&lt;Unloaded_I.DLL&gt;+0x00000523)     ExceptionCode: c0000005 (Access violation)    ExceptionFlags: 00000000  NumberParameters: 2     Parameter[0]: 00000000     Parameter[1]: 00000524  Attempt to read from address 00000524    FAULTING_THREAD:  000017dc    DEFAULT_BUCKET_ID:  BAD_INSTRUCTION_PTR    PROCESS_NAME:  chrome.exe    ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot; referenced  memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot;  referenced memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_PARAMETER1:  00000000    EXCEPTION_PARAMETER2:  00000524    READ_ADDRESS:  00000524     FOLLOWUP_IP:   I+523  00000524 ??              ???    NTGLOBALFLAG:  70    APPLICATION_VERIFIER_FLAGS:  0    PRIMARY_PROBLEM_CLASS:  BAD_INSTRUCTION_PTR    BUGCHECK_STR:  APPLICATION_FAULT_BAD_INSTRUCTION_PTR_INVALID_POINTER_READ    LAST_CONTROL_TRANSFER:  from 0253b9d0 to 00000524    STACK_TEXT:    WARNING: Frame IP not in any known module. Following frames may be wrong.  0013ea44 0253b9d0 00000000 054cc9a0 054cc9a0 &lt;Unloaded_I.DLL&gt;+0x523  0013ea58 0255a435 00000000 054cca28 0255afe7  chrome_1c30000!BrowserView::SetDownloadShelfVisible+0x30  [c:bslavechromium-rel-xpbuildsrcchromebrowserviewsframebrowser_view.cc  @ 819]  0013ea64 0255afe7 03a60a20 05482a70 00000000  chrome_1c30000!DownloadShelfView::Close+0x15  [c:bslavechromium-rel-xpbuildsrcchromebrowserviewsdownload_shelf_view.cc  @ 306]  0013eb14 0257c8b8 05482a04 0543148c 03a60a20  chrome_1c30000!DownloadShelfView::RemoveDownloadView+0x167  [c:bslavechromium-rel-xpbuildsrcchromebrowserviewsdownload_shelf_view.cc  @ 137]  0013ebdc 01d09d3b 03a60a20 03a60a20 03a60adc  chrome_1c30000!DownloadItemView::OnDownloadUpdated+0x1b8  [c:bslavechromium-rel-xpbuildsrcchromebrowserviewsdownload_item_view.cc  @ 381]  0013ebf8 01d0de03 05489b40 03a60a20 01d0e66d  chrome_1c30000!DownloadItem::UpdateObservers+0x5b  [c:bslavechromium-rel-xpbuildsrcchromebrowserdownloaddownload_manager.cc  @ 190]  0013ec04 01d0e66d 05431480 03a3f960 03a3f960  chrome_1c30000!DownloadItem::~DownloadItem+0x13  [c:bslavechromium-rel-xpbuildsrcchromebrowserdownloaddownload_manager.cc  @ 179]  0013ec18 01d0ebf3 05431488 05431480 05431480  chrome_1c30000!STLDeleteValues&lt;stdext::hash_map&lt;__int64 DownloadItem  * stdext::hash_compare&lt;__int64 std::less&lt;__int64&gt;  &gt; std::allocator&lt;std::pair&lt;__int64 const  DownloadItem *&gt; &gt; &gt; &gt;+0x3d  [c:bslavechromium-rel-xpbuildsrcbasestl_util-inl.h @ 248]  0013ecec 01d0f2cf 01867820 00000000 01ea01e9  chrome_1c30000!DownloadManager::Shutdown+0x373  [c:bslavechromium-rel-xpbuildsrcchromebrowserdownloaddownload_manager.cc  @ 403]  0013ed04 01cdf90e 0013ef24 01867820 00000000  chrome_1c30000!DownloadManager::~DownloadManager+0x1f  [c:bslavechromium-rel-xpbuildsrcchromebrowserdownloaddownload_manager.cc  @ 348]  0013ed14 01cdfd82 00a5d9fc 00000000 0013ed98  chrome_1c30000!OffTheRecordProfileImpl::ExitedOffTheRecordMode+0x2e  [c:bslavechromium-rel-xpbuildsrcchromebrowserprofile.cc @ 356]  0013edb4 025c0b62 00000015 0013ef24 0013ef28  chrome_1c30000!OffTheRecordProfileImpl::Observe+0x92  [c:bslavechromium-rel-xpbuildsrcchromebrowserprofile.cc @ 371]  0013ee74 01c83824 00000015 00000000 0013ef28  chrome_1c30000!NotificationService::Notify+0x2d2  [c:bslavechromium-rel-xpbuildsrcchromecommonnotification_service.cc  @ 107]  0013ef2c 01c89541 00b37000 02e39180 00b37000  chrome_1c30000!BrowserList::RemoveBrowser+0x64  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser_list.cc @ 60]  0013efd8 01c8acdb 00b37000 0013f010 0253e744  chrome_1c30000!Browser::~Browser+0xb1  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser.cc @ 217]  0013efe4 0253e744 00000001 00000000 0186be00  chrome_1c30000!Browser::`scalar deleting destructor'+0xb  0013f010 0253e9ab 018d7700 0013f03c 01e58732  chrome_1c30000!BrowserView::~BrowserView+0x1a4  [c:bslavechromium-rel-xpbuildsrcchromebrowserviewsframebrowser_view.cc  @ 300]  0013f01c 01e58732 00000001 00aafc00 018d7700  chrome_1c30000!BrowserView::`scalar deleting destructor'+0xb  0013f030 01e6aa4c 00a40888 0013f0ec 01e59c6e  chrome_1c30000!views::View::~View+0x72  [c:bslavechromium-rel-xpbuildsrcviewsview.cc @ 74]  0013f03c 01e59c6e 00000001 00aafc24 00a40888  chrome_1c30000!views::NonClientView::`scalar deleting destructor'+0x2c  0013f0ec 01e59d64 018d7700 00000000 00000000  chrome_1c30000!views::View::DoRemoveChildView+0x11e  [c:bslavechromium-rel-xpbuildsrcviewsview.cc @ 585]  0013f114 01e6ce4e 00000001 00aafc00 00aafc00  chrome_1c30000!views::View::RemoveAllChildViews+0x54  [c:bslavechromium-rel-xpbuildsrcviewsview.cc @ 548]  0013f128 025ffe2b 00aafd04 0013f150 01e5d043  chrome_1c30000!views::RootView::~RootView+0x2e  [c:bslavechromium-rel-xpbuildsrcviewswidgetroot_view.cc @ 91]  0013f134 01e5d043 00000001 00000082 00aafd00  chrome_1c30000!views::`anonymous namespace'::MenuHostRootView::`scalar  deleting destructor'+0xb  0013f144 02568736 00aafd04 0013f168 01e5adce  chrome_1c30000!views::WidgetWin::~WidgetWin+0x73  [c:bslavechromium-rel-xpbuildsrcviewswidgetwidget_win.cc @ 155]  0013f150 01e5adce 00000001 01e549f2 00410686  chrome_1c30000!BrowserFrameWin::`scalar deleting destructor'+0x36  0013f158 01e549f2 00410686 00aafd04 0013f210  chrome_1c30000!views::WidgetWin::OnFinalMessage+0xe  [c:bslavechromium-rel-xpbuildsrcviewswidgetwidget_win.cc @ 750]  0013f168 01e5cf48 00410686 0013f278 01e5ce30  chrome_1c30000!views::WindowWin::OnFinalMessage+0x22  [c:bslavechromium-rel-xpbuildsrcviewswindowwindow_win.cc @ 635]  0013f210 7e418734 00410686 00000000 c490e000  chrome_1c30000!views::WidgetWin::WndProc+0x118  [c:bslavechromium-rel-xpbuildsrcviewswidgetwidget_win.cc @ 1051]  0013f23c 7e418816 01e5ce30 00410686 00000082 USER32!InternalCallWinProc+0x28  0013f2a4 7e42a013 00000000 01e5ce30 00410686  USER32!UserCallWinProcCheckWow+0x150  0013f2d4 7e42a039 01e5ce30 00410686 00000082 USER32!CallWindowProcAorW+0x98  0013f2f4 01e5ea71 01e5ce30 00410686 00000082 USER32!CallWindowProcW+0x1b  0013f3ac 7e418734 00410686 00000082 00000000  chrome_1c30000!views::FocusWindowCallback+0x111  [c:bslavechromium-rel-xpbuildsrcviewsfocusfocus_manager.cc @ 86]  0013f3d8 7e418816 01e5e960 00410686 00000082 USER32!InternalCallWinProc+0x28  0013f440 7e428ea0 00000000 01e5e960 00410686  USER32!UserCallWinProcCheckWow+0x150  0013f494 7e42b16f 0072c090 00000082 00000000 USER32!DispatchClientMessage+0xa3  0013f4c4 7c90e473 0013f4d4 00000018 0072c090 USER32!__fnNCDESTROY+0x26  0013f4e8 7e42b1a8 01e5bd87 00410686 03aaebe0  ntdll!KiUserCallbackDispatcher+0x13  0013f590 01e90f1e 00000000 0013f8fc 00000003 USER32!NtUserDestroyWindow+0xc  0013f634 01e91f9a 03aaebe0 00a48520 00a48500  chrome_1c30000!MessageLoop::RunTask+0x7e  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 310]  0013f684 01ebc38a 00000000 00a48500 00000000  chrome_1c30000!MessageLoop::DoWork+0x1ea  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 431]  0013f6b4 01ebb582 0013f8fc 0013f8fc 0013f8fc  chrome_1c30000!base::MessagePumpForUI::DoRunLoop+0x5a  [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.cc @ 210]  0013f6d4 01e91519 0013f8fc 00a406b0 00a65000  chrome_1c30000!base::MessagePumpWin::RunWithDispatcher+0x42  [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.cc @ 54]  0013f77c 01e91950 358c420c 00a62000 00a65000  chrome_1c30000!MessageLoop::RunInternal+0xa9  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 193]  0013f7b0 01e919b9 00000001 00000000 00a406b0  chrome_1c30000!MessageLoop::RunHandler+0xa0  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 182]  0013f7cc 01c4af0a 00a406b0 0013fb08 01c4ce6d  chrome_1c30000!MessageLoopForUI::Run+0x49  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 586]  0013f7d8 01c4ce6d 00a500b0 00000000 00a62000 chrome_1c30000!`anonymous  namespace'::RunUIMessageLoop+0x1a  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser_main.cc @ 193]  0013fb08 01c35a3e 0013fbe0 00000000 01c30000  chrome_1c30000!BrowserMain+0x170d  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser_main.cc @ 748]  0013fc80 0040382c 00400000 0013fcf8 000213be  chrome_1c30000!ChromeMain+0x6ce  [c:bslavechromium-rel-xpbuildsrcchromeappchrome_dll_main.cc @ 506]  0013ff28 00429e91 00400000 00000000 000213be chrome!wWinMain+0x2ac  [c:bslavechromium-rel-xpbuildsrcchromeappchrome_exe_main.cc @ 102]  0013ffc0 7c817077 00fcf558 007a75a4 7ffd5000 chrome!__tmainCRTStartup+0x176  [f:spvctoolscrt_bldself_x86crtsrccrt0.c @ 324]  0013fff0 00000000 00429efa 00000000 78746341 kernel32!BaseProcessStart+0x23      FAILED_INSTRUCTION_ADDRESS:   I+523  00000524 ??              ???    SYMBOL_STACK_INDEX:  0    SYMBOL_NAME:  I+523    FOLLOWUP_NAME:  MachineOwner    MODULE_NAME: I    IMAGE_NAME:  I.DLL    DEBUG_FLR_IMAGE_TIMESTAMP:  530050    STACK_COMMAND:  ~0s ; kb    FAILURE_BUCKET_ID:  BAD_INSTRUCTION_PTR_c0000005_I.DLL!Unloaded    BUCKET_ID:   APPLICATION_FAULT_BAD_INSTRUCTION_PTR_INVALID_POINTER_READ_BAD_IP_I+523   </pre>