<title>Issue 11333 -   chromium -    Memory leak in CMOpenOrNewAccess in ColorSync on Mac unit_tests and ui_tests - Project Hosting on Google Code</title> <pre> Moved from <a title="Mem leak in test_shell_tests - PlatformCanvas.SkLayer" class=closed_ref href="/p/chromium/issues/detail?id=9563"> issue 9563 </a>  which was getting crowded.    Here's the original stack:  6 336 (176 direct  6 160 indirect) bytes in 11 blocks are definitely lost   in loss record 564 of 680     at malloc (vg_replace_malloc.c:193)      by stdSmartNewPtr   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync)     by stdSmartNewHandle (in /System/.../ColorSync)     by IOCreateAndOpen (in /System/.../ColorSync)     by ScratchInit (in /System/.../ColorSync)     by CMOpenOrNewAccess (in /System/.../ColorSync)     by CMOpenProfile (in /System/.../ColorSync)     by createProfileBySpaceFromShmem   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib)     by CMSGetSystemDefaultProfile (in /System/.../libCSync.A.dylib)     by deviceSet (in /System/.../libCSync.A.dylib)     by cmsDataProviderGetBytes (in /System/.../libCSync.A.dylib)     by CMSValidateProfile (in /System/.../libCSync.A.dylib)     by CGCMSInterfaceValidateProfile   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics)     by CGCMSUtilsValidateProfile (in /System/.../CoreGraphics)     by CGColorSpaceCreateICCBased (in /System/.../CoreGraphics)     by create_generic_color_space (in /System/.../CoreGraphics)     by CGColorSpaceCreateWithIndex (in /System/.../CoreGraphics)     by skia::BitmapPlatformDeviceMac::Create(CGContext*  int  int  bool)   (bitmap_platform_device_mac.cc:149)     by std::vector&lt;short  StackAllocator&lt;short  64ul&gt; &gt;::push_back(short   const&amp;) (stl_vector.h:602)     by skia::PlatformCanvasMac::initialize(int  int  bool)   (platform_canvas_mac.cc:62)     by skia::PlatformCanvasMac::PlatformCanvasMac(int  int  bool    CGContext*) (platform_canvas_mac.cc:25)     by skia::PlatformCanvas_SkLayer_Test::TestBody()    (platform_canvas_unittest.cc:230)    And here's another stack from today that occurs in shard 16 of 20 in   unit_tests:    6 924 (208 direct  6 716 indirect) bytes in 13 blocks are definitely lost   in loss record 434 of 541     at malloc (vg_replace_malloc.c:193)     by stdSmartNewPtr   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync)     by stdSmartNewHandle (in /System/.../ColorSync)     by IOCreateAndOpen (in /System/.../ColorSync)     by ScratchInit (in /System/.../ColorSync)     by CMOpenOrNewAccess (in /System/.../ColorSync)     by CMNewProfile (in /System/.../ColorSync)     by CreateLink   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib)     by CMSGetDeviceLinkProfile (in /System/.../libCSync.A.dylib)     by displayGrayCreate (in /System/.../libCSync.A.dylib)     by create (in /System/.../libCSync.A.dylib)     by aquireColorWorldByAttributes (in /System/.../libCSync.A.dylib)     by acquireColorWorld (in /System/.../libCSync.A.dylib)     by CMSTransformConvertComponents (in /System/.../libCSync.A.dylib)     by CGCMSInterfaceTransformConvertColorComponents   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics)     by CGColorTransformConvertColorFloatComponents   (in /System/.../CoreGraphics)     by ripc_GetColor   (in /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib)     by ripc_Render (in /System/.../libRIP.A.dylib)     by ripc_DrawRects (in /System/.../libRIP.A.dylib)     ...    Adding suppression.   </pre>