<title>Issue 2281 -   chromium -    theme dll file can be used to execute code on pre-Vista OSs - Project Hosting on Google Code</title> <pre> Intro:  Downloadable Chrome themes could be dangerous on an OS older than Vista    because it is possible to create a dll  that contains some executable code    and also works as a theme file. One just needs to put the resources of the   original theme file (default.dll) into a dll with an entry point.    Analysis:  You are using LoadLibraryEx to load default.dll with the flags LOAD_LIBRARY_AS_DATAFILE_EXCLUSIVE and LOAD_LIBRARY_AS_IMAGE_RESOURCE   specified on Vista  but with a 0 flag on pre-Vista (major version number &lt;   6) OSs.    Suggestion:  I've taken a quick look on the source code. I think  that the GetDataDllLoadFlags function in the chromecommonresource_bundle.cc file   (Line 30) should return LOAD_LIBRARY_AS_DATAFILE instead of 0. LOAD_LIBRARY_AS_DATAFILE might not provide the security that LOAD_LIBRARY_AS_DATAFILE_EXCLUSIVE and LOAD_LIBRARY_AS_IMAGE_RESOURCE   provides  but it still prevents the execution of  the dll's DllMain   function.    P.S.: I've attached a dll  that can be used as a theme  and opens a   MessageBox when loaded. </pre>