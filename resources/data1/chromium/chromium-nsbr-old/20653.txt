<title>Issue 20653 -   chromium -    Invalid read in unixWrite and sqlite3MemSize in history::HistoryBackend::Init() on mac - Project Hosting on Google Code</title> <pre> This was originally the second part of <a title="UMR errors in SQLite in history::HistoryBackend::Init() on mac"  href="/p/chromium/issues/detail?id=11282">bug 11282</a> but that  was getting messy  so I'm breaking it out into its own bug report.    <a href="http://build.chromium.org/buildbot/waterfall.fyi/builders/Mac%20UI%203%20of%203%20(valgrind)/builds/1037/steps/valgrind%20test:%20ui/logs/stdio">http://build.chromium.org/buildbot/waterfall.fyi/builders/Mac%20UI%203%20of%203%20(valgrind)/builds/1037/steps/valgrind%20test:%20ui/logs/stdio</a>    shows the pair of errors     Syscall param write(buf) points to unaddressable byte(s)    write$UNIX2003    unixWrite (third_party/sqlite/src/os_unix.c:923)    sqlite3OsWrite (third_party/sqlite/src/os.c:69)    pager_write_pagelist (third_party/sqlite/src/pager.c:3095)    sqlite3PagerCommitPhaseOne (third_party/sqlite/src/pager.c:4805)    sqlite3BtreeCommitPhaseOne (third_party/sqlite/src/btree.c:2476)    vdbeCommit (third_party/sqlite/src/vdbeaux.c:1269)    sqlite3VdbeHalt (third_party/sqlite/src/vdbeaux.c:1591)    sqlite3VdbeExec (third_party/sqlite/src/vdbe.c:2425)    sqlite3Step (third_party/sqlite/src/vdbeapi.c:476)    sqlite3_step (third_party/sqlite/src/vdbeapi.c:540)    sqlite3_exec (third_party/sqlite/src/legacy.c:73)    SQLTransaction::EndCommand(char const*) (chrome/common/sqlite_utils.cc:183)    SQLTransaction::Commit() (sqlite_utils.h:86)    history::ThumbnailDatabase::Init(FilePath const&amp;   history::HistoryPublisher const*) (thumbnail_database.cc:100)    history::HistoryBackend::InitImpl() (history_backend.cc:542)    history::HistoryBackend::Init() (history_backend.cc:214)  Address 0x1381b038 is 8 bytes inside a block of size 4 104 alloc'd    malloc (vg_replace_malloc.c:195)    sqlite3MemMalloc (third_party/sqlite/src/mem1.c:43)    mallocWithAlarm (third_party/sqlite/src/malloc.c:228)    sqlite3PageMalloc (third_party/sqlite/src/malloc.c:414)    pagerAllocatePage (third_party/sqlite/src/pager.c:3682)    sqlite3PagerAcquire2 (third_party/sqlite/src/pager.c:3831)    pagerAcquire (third_party/sqlite/src/pager.c:3780)    sqlite3PagerAcquire (third_party/sqlite/src/pager.c:3918)    sqlite3BtreeGetPage (third_party/sqlite/src/btree.c:1082)    allocateBtreePage (third_party/sqlite/src/btree.c:4248)    btreeCreateTable (third_party/sqlite/src/btree.c:6145)    sqlite3BtreeCreateTable (third_party/sqlite/src/btree.c:6159)    sqlite3VdbeExec (third_party/sqlite/src/vdbe.c:4101)    sqlite3Step (third_party/sqlite/src/vdbeapi.c:476)    sqlite3_step (third_party/sqlite/src/vdbeapi.c:540)    sqlite3_exec (third_party/sqlite/src/legacy.c:73)    history::ThumbnailDatabase::InitFavIconsTable(bool)  (thumbnail_database.cc:191)    history::ThumbnailDatabase::Init(FilePath const&amp;   history::HistoryPublisher const*) (thumbnail_database.cc:73)    history::HistoryBackend::InitImpl() (history_backend.cc:542)    history::HistoryBackend::Init() (history_backend.cc:214)    09:38:28 memcheck_analyze.py [ERROR] InvalidRead  Invalid read of size 4    sqlite3MemSize (third_party/sqlite/src/mem1.c:99)    sqlite3MallocSize (third_party/sqlite/src/malloc.c:478)    sqlite3PageFree (third_party/sqlite/src/malloc.c:432)    pager_truncate_cache (third_party/sqlite/src/pager.c:2673)    pager_truncate (third_party/sqlite/src/pager.c:1776)    pager_playback (third_party/sqlite/src/pager.c:1936)    sqlite3PagerRollback (third_party/sqlite/src/pager.c:4975)    sqlite3BtreeRollback (third_party/sqlite/src/btree.c:2646)    sqlite3RollbackAll (third_party/sqlite/src/main.c:582)    sqlite3VdbeHalt (third_party/sqlite/src/vdbeaux.c:1597)    sqlite3VdbeExec (third_party/sqlite/src/vdbe.c:2425)    sqlite3Step (third_party/sqlite/src/vdbeapi.c:476)    sqlite3_step (third_party/sqlite/src/vdbeapi.c:540)    sqlite3_exec (third_party/sqlite/src/legacy.c:73)    SQLTransaction::EndCommand(char const*) (chrome/common/sqlite_utils.cc:183)    SQLTransaction::Commit() (sqlite_utils.h:86)    history::ThumbnailDatabase::Init(FilePath const&amp;   history::HistoryPublisher const*) (thumbnail_database.cc:100)    history::HistoryBackend::InitImpl() (history_backend.cc:542)    history::HistoryBackend::Init() (history_backend.cc:214)  Address 0x1381b034 is 4 bytes inside a block of size 4 104 alloc'd    malloc (vg_replace_malloc.c:195)    sqlite3MemMalloc (third_party/sqlite/src/mem1.c:43)    mallocWithAlarm (third_party/sqlite/src/malloc.c:228)    sqlite3PageMalloc (third_party/sqlite/src/malloc.c:414)    pagerAllocatePage (third_party/sqlite/src/pager.c:3682)    sqlite3PagerAcquire2 (third_party/sqlite/src/pager.c:3831)    pagerAcquire (third_party/sqlite/src/pager.c:3780)    sqlite3PagerAcquire (third_party/sqlite/src/pager.c:3918)    sqlite3BtreeGetPage (third_party/sqlite/src/btree.c:1082)    allocateBtreePage (third_party/sqlite/src/btree.c:4248)    btreeCreateTable (third_party/sqlite/src/btree.c:6145)    sqlite3BtreeCreateTable (third_party/sqlite/src/btree.c:6159)    sqlite3VdbeExec (third_party/sqlite/src/vdbe.c:4101)    sqlite3Step (third_party/sqlite/src/vdbeapi.c:476)    sqlite3_step (third_party/sqlite/src/vdbeapi.c:540)    sqlite3_exec (third_party/sqlite/src/legacy.c:73)    history::ThumbnailDatabase::InitFavIconsTable(bool)  (thumbnail_database.cc:191)    history::ThumbnailDatabase::Init(FilePath const&amp;   history::HistoryPublisher const*) (thumbnail_database.cc:73)    history::HistoryBackend::InitImpl() (history_backend.cc:542)    history::HistoryBackend::Init() (history_backend.cc:214)    <a href="http://www.sqlite.org/cvstrac/tktview?tn=694">http://www.sqlite.org/cvstrac/tktview?tn=694</a>   dismisses a warning similar to the first one without any discussion.  I guess I'll file a new bug against sqlite for the pair  since the two  warnings seem to always occur together.   </pre>