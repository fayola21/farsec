<title>Issue 3399 -   chromium -    magic_browzR crash in BrowserView2::ActivateAppModalDialog()  - Project Hosting on Google Code</title> <pre> With <a href="/p/chromium/source/detail?r=3334">r3334</a>  the reliability tests are generating 20-30 crashes in BrowserView2::ActivateAppModalDialog().    Here's an example stack:  STACK_TEXT:    0012f1c0 02b1f511 021c2a54 0012f28c 029836bc   chrome_2670000!BrowserView2::ActivateAppModalDialog+0x1e   [c:bslavechrome-  releasebuildsrcchromebrowserviewsframebrowser_view2.cc @ 204]  0012f1cc 029836bc 00000000 000800bc 021c2a54   chrome_2670000!OpaqueFrame::OnNCActivate+0x11 [c:bslavechrome-  releasebuildsrcchromebrowserviewsframeopaque_frame.cc @ 105]  0012f28c 02984ea3 000800bc 00000086 00000000   chrome_2670000!ChromeViews::HWNDViewContainer::_ProcessWindowMessage+0x69c   [c:bslavechrome-releasebuildsrcchromeviewshwnd_view_container.h @   212]  0012f344 7e418734 00000000 00000086 00000000   chrome_2670000!ChromeViews::HWNDViewContainer::WndProc+0xc3   [c:bslavechrome-releasebuildsrcchromeviewshwnd_view_container.cc @   918]  0012f370 7e418816 02984de0 000800bc 00000086   user32!InternalCallWinProc+0x28  0012f3d8 7e41c63f 00000000 02984de0 000800bc   user32!UserCallWinProcCheckWow+0x150  0012f408 7e41c665 02984de0 000800bc 00000086 user32!CallWindowProcAorW+0x98  0012f428 02982697 02984de0 000800bc 00000086 user32!CallWindowProcW+0x1b  0012f4dc 7e418734 02984de0 00000086 00000000   chrome_2670000!ChromeViews::FocusWindowCallback+0x187 [c:bslavechrome-  releasebuildsrcchromeviewsfocus_manager.cc @ 187]  0012f508 7e418816 02982510 000800bc 00000086   user32!InternalCallWinProc+0x28  0012f570 7e41b4c0 00000000 02982510 000800bc   user32!UserCallWinProcCheckWow+0x150  0012f5c4 7e41b50c 01823e70 00000086 00000000   user32!DispatchClientMessage+0xa3  0012f5ec 7c90eae3 0012f5fc 00000018 01823e70 user32!__fnDWORD+0x24  0012f610 7e4194d2 7e418a76 0012f728 0012f728   ntdll!KiUserCallbackDispatcher+0x13  0012f658 7e418a10 0012f728 00000000 0012f678   user32!NtUserDispatchMessage+0xc  0012f668 02978cef 0012f728 021abce0 0012f68c user32!DispatchMessageW+0xf  0012f678 0268e370 0012f728 0012f774 021abce0   chrome_2670000!ChromeViews::AcceleratorHandler::Dispatch+0x4f   [c:bslavechrome-releasebuildsrcchromeviewsaccelerator_handler.cc @   33]  0012f68c 0268e220 0012f728 021abce0 00000000   chrome_2670000!base::MessagePumpWin::ProcessMessageHelper+0x60   [c:bslavechrome-releasebuildsrcbasemessage_pump_win.cc @ 283]  0012f74c 0268e34e 021abd00 021abce0 0012f790   chrome_2670000!base::MessagePumpWin::ProcessPumpReplacementMessage+0xa0   [c:bslavechrome-releasebuildsrcbasemessage_pump_win.cc @ 316]  0012f75c 0268f0d4 0012f774 00000000 021abce0   chrome_2670000!base::MessagePumpWin::ProcessMessageHelper+0x3e   [c:bslavechrome-releasebuildsrcbasemessage_pump_win.cc @ 278]  0012f790 0268dcb2 0012f9ac 0012f9ac 0012f9ac   chrome_2670000!base::MessagePumpForUI::DoRunLoop+0x44 [c:bslavechrome-  releasebuildsrcbasemessage_pump_win.cc @ 362]  0012f7b0 02681d79 0012f9ac 0323e1c8 021ac170   chrome_2670000!base::MessagePumpWin::RunWithDispatcher+0x42   [c:bslavechrome-releasebuildsrcbasemessage_pump_win.cc @ 132]  0012f854 02681f20 2baae4be 022ae818 021ac170   chrome_2670000!MessageLoop::RunInternal+0xa9 [c:bslavechrome-  releasebuildsrcbasemessage_loop.cc @ 189]  0012f888 02682269 00000001 00000000 0323e1c8   chrome_2670000!MessageLoop::RunHandler+0xa0 [c:bslavechrome-  releasebuildsrcbasemessage_loop.cc @ 178]  0012f8a4 026ae99a 0323e1c8 00000008 00000007   chrome_2670000!MessageLoopForUI::Run+0x49 [c:bslavechrome-  releasebuildsrcbasemessage_loop.cc @ 556]  0012faf0 0267540a 0012fbf4 0000000a 01e57008   chrome_2670000!BrowserMain+0xfca [c:bslavechrome-  releasebuildsrcchromebrowserbrowser_main.cc @ 515]  0012fc5c 00402c34 00400000 0012fce0 000205fe   chrome_2670000!ChromeMain+0x83a [c:bslavechrome-  releasebuildsrcchromeappchrome_dll_main.cc @ 224]  0012ff28 00445ebe 00400000 00000000 000205fe chrome!wWinMain+0x304   [c:bslavechrome-releasebuildsrcchromeappchrome_exe_main.cc @ 103]  0012ffc0 7c816fd7 ffffffff 77dd6a51 7ffd4000 chrome!__tmainCRTStartup+0x176   [f:spvctoolscrt_bldself_x86crtsrccrt0.c @ 324]  0012fff0 00000000 00445f27 00000000 00000000 kernel32!BaseProcessStart+0x23      STACK_COMMAND:  ~0s; .ecxr ; kb    FOLLOWUP_IP:   chrome_2670000!BrowserView2::ActivateAppModalDialog+1e [c:bslavechrome-  releasebuildsrcchromebrowserviewsframebrowser_view2.cc @ 204]  02b1fd6e ??              ???    FAULTING_SOURCE_CODE:       200: bool BrowserView2::ActivateAppModalDialog() const {     201:   // If another browser is app modal  flash and activate the modal   browser.     202:   if (BrowserList::IsShowingAppModalDialog()) {     203:     if (browser_ != BrowserList::GetLastActive()) {  &gt;  204:       BrowserList::GetLastActive()-&gt;window()-&gt;FlashFrame();     205:       BrowserList::GetLastActive()-&gt;MoveToFront(true);     206:     }     207:     AppModalDialogQueue::ActivateModalDialog();     208:     return true;     209:   }       </pre>