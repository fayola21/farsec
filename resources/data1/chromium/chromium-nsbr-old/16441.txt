<title>Issue 16441 -   chromium -    WorkerTest.WorkerHttpLayoutTest is flaky - Project Hosting on Google Code</title> <pre> [----------] 7 tests from WorkerTest  [ RUN      ] WorkerTest.SingleWorker  [       OK ] WorkerTest.SingleWorker (859 ms)  [ RUN      ] WorkerTest.MultipleWorkers  [       OK ] WorkerTest.MultipleWorkers (797 ms)  [ RUN      ] WorkerTest.WorkerFastLayoutTests  [       OK ] WorkerTest.WorkerFastLayoutTests (13500 ms)  [ RUN      ] WorkerTest.WorkerHttpLayoutTests    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully  C:bslavechromium-rel-builderbuildsrcchromeworkerworker_uitest.cc(258):  error: Value of: value.c_str()    Actual: &quot;  &quot;  Expected: expected_result_value.c_str()  Which is: &quot;This test verifies handling of text encoding in workers. The  behavior matches FF3.1b2 with a single exclusion (see below).  This is what's tested:  - If http header 'Content-Type' with 'charset' specified is on response  with worker script or XHR payload  that encoding is used.  - In absence of http header  the script of the worker is decoded using UTF-8.  - In absence of http header  the content of the XHR request is decoded  using UTF-8.  - The URLs used in workers (for subworkers or XHR) are always encoded using  UTF-8 (in regular html documents parts of the query an hash may be encoded  with other encodings).  - The base URL for the worker (used to resolve relative URLs for subworkers  and XHR) is the URL of its script.  - importScripts() decodes the scripts using UTF-8.  Document encoding: windows-1251  Document  Workers: All XHR responses should match this: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  Document: : XHR: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  Document: ��_��_��_�Օ�_��_��Օ�_��__��_��_��__��_��_뵕�_��_��_��Օ�_��__��_��_��_��_  worker 1: Has no http header with charset  worker 1: Original test string: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 1: PASS: XHR query was encoded in UTF-8: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 1: Sub: Original test string: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 1: Sub: Test string encoded using UTF-8: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__.  worker 1: Sub: Test string encoded using Windows-1251: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 1: Sub: Test string encoded using koi8-r: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 1: Test string encoded using UTF-8: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__.  worker 1: Test string encoded using Windows-1251: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 1: Test string encoded using koi8-r: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 1: XHR: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 1: XHR: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 1: exit  worker 2: Has http header with charset=koi8-r  worker 2: Original test string: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 2: PASS: XHR query was encoded in UTF-8: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 2: Sub: Original test string: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 2: Sub: Test string encoded using UTF-8: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__.  worker 2: Sub: Test string encoded using Windows-1251: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 2: Sub: Test string encoded using koi8-r: ��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__��_��_��_��_��__.  worker 2: Test string encoded using UTF-8: ��_��_��_��_��_��_��_��_��_돕�_��_��_��_��_��_��Օ�_��_�բ��_��_��_��__��_��_��_�բ��_��_��_덕�_��_��_�բ��_��_��_룕�_��_돕�_��_��_��_��_��_��_.  worker 2: Test string encoded using Windows-1251: ��_��_��__��_��_��_�Օ�_��_�Օ�_��_��_��_��_��_��_��_��_��_��_ .  worker 2: Test string encoded using koi8-r: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__.  worker 2: XHR: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 2: XHR: ��_��_��_�Օ�_��_��Օ�_��_�Օ�_��__��_��_뵕�_��_��_��__  worker 2: exit    &quot;  Google Test trace:  C:bslavechromium-rel-builderbuildsrcchromeworkerworker_uitest.cc:190:  text-encoding.html  [  FAILED  ] WorkerTest.WorkerHttpLayoutTests (70438 ms)  [ RUN      ] WorkerTest.WorkerXhrHttpLayoutTests    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully    The operation completed successfully  Retrying 4000 ms to delete temp worker directory.  [       OK ] WorkerTest.WorkerXhrHttpLayoutTests (16469 ms)  [ RUN      ] WorkerTest.LimitPerPage  [       OK ] WorkerTest.LimitPerPage (1671 ms)  [ RUN      ] WorkerTest.LimitTotal  [       OK ] WorkerTest.LimitTotal (6563 ms)  [----------] 7 tests from WorkerTest (110297 ms total)   </pre>