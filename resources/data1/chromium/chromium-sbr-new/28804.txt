<title>Issue 28804 -   chromium -    [MD audit] [Window Sandbox] PreProcessName() Race Condition - Project Hosting on Google Code</title> <pre> File: sandbox/src/filesystem_policy.cc  Function: PreProcessName()  Problem Type: Race condition  Compromise Type: Local Escalation  Severity: High    The PreProcessName() function attempts to validate pathnames received from   an untrusted sandboxed process to decide if the file can be legally opened   according to the policy for the process. It recursively checks if each path   segment is a reparse point  starting with the full filename and then   checking each parent directory until the root is reached. If a long   pathname is specified  it is possible for the sandboxed process to change   one of the path segments to contain reparse information (and hence be a   link) after the path has been checked by the privileged process but before   the entire pathname has been validated. This results in the privileged   process incorrectly deciding that the path does not contain any reparse   points when in fact it does  thus allowing the sandboxed process to access   files outside of the policy.   </pre>