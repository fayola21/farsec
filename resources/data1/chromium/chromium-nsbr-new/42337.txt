<title>Issue 42337 -   chromium -    Browser crash @ ProfileSyncService::QueryDetailedSyncStatus() - Project Hosting on Google Code</title> <pre> Build: 5.0.375.17 (Official Build 45275)  OS: XP.    Filing this as call stack for <a title="Crash on starting one datatype  stopping another  and then stopping sync" class=closed_ref href="/p/chromium/issues/detail?id=42269"> issue 42269 </a> is different from this.    -Sync the profile with all three options enabled.  -Unselect bookmarks in Customization  -Un sync and sync again  -Select bookmarks in customization and then try to un-sync.  -Boom.    On restarting browser window  user gets sync error BMB  and trying to sync   from there  user gets 'Could not connect to the server' error - screenshot   attached.    FAULTING_IP:   chrome_26c0000!ProfileSyncService::QueryDetailedSyncStatus+9   [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 407]  02b6f2ce 8b4010          mov     eax dword ptr [eax+10h]    EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)  ExceptionAddress: 02b6f2ce   (chrome_26c0000!ProfileSyncService::QueryDetailedSyncStatus+0x00000009)     ExceptionCode: c0000005 (Access violation)    ExceptionFlags: 00000000  NumberParameters: 2     Parameter[0]: 00000000     Parameter[1]: 00000010  Attempt to read from address 00000010    PROCESS_NAME:  chrome.exe    ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot; referenced   memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot;   referenced memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_PARAMETER1:  00000000    EXCEPTION_PARAMETER2:  00000010    READ_ADDRESS:  00000010     FOLLOWUP_IP:   chrome_26c0000!ProfileSyncService::QueryDetailedSyncStatus+9   [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 407]  02b6f2ce 8b4010          mov     eax dword ptr [eax+10h]    NTGLOBALFLAG:  2000000    FAULTING_THREAD:  00001bcc    BUGCHECK_STR:    APPLICATION_FAULT_NULL_CLASS_PTR_DEREFERENCE_INVALID_POINTER_READ    PRIMARY_PROBLEM_CLASS:  NULL_CLASS_PTR_DEREFERENCE    DEFAULT_BUCKET_ID:  NULL_CLASS_PTR_DEREFERENCE    LAST_CONTROL_TRANSFER:  from 02b80e1f to 02b6f2ce    STACK_TEXT:    0013efb8 02b80e1f 056d5480 00000001 0013eff4   chrome_26c0000!ProfileSyncService::QueryDetailedSyncStatus+0x9   [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 407]  0013f028 02b81010 00000000 00000000 000004fe   chrome_26c0000!sync_ui_util::`anonymous namespace'::GetStatusInfo+0x39   [c:bslavechrome-officialbuildsrcchromebrowsersyncsync_ui_util.cc @   84]  0013f038 02bd23d6 00000040 041e4d80 04202880   chrome_26c0000!sync_ui_util::ShouldShowSyncErrorButton+0x1b   [c:bslavechrome-officialbuildsrcchromebrowsersyncsync_ui_util.cc @   167]  0013f09c 02bd034a 0013f0b8 00000001 02b05c38   chrome_26c0000!BookmarkBarView::LayoutItems+0x105 [c:bslavechrome-  officialbuildsrcchromebrowserviewsbookmark_bar_view.cc @ 1595]  0013f0a8 02b05c38 0013f0b8 04202880 041e4d80   chrome_26c0000!BookmarkBarView::GetPreferredSize+0xd [c:bslavechrome-  officialbuildsrcchromebrowserviewsbookmark_bar_view.cc @ 461]  0013f0c0 02bce6e9 042028b8 04202880 056d5480   chrome_26c0000!BrowserView::IsBookmarkBarVisible+0x35 [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view.cc @ 897]  0013f0d8 02bce449 0013f218 041e4d9c 04223b44   chrome_26c0000!BrowserViewLayout::LayoutBookmarkBar+0xf [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view_layout.cc @ 342]  0013f104 02b06b1b 041e4d9c 0013f218 056d5480   chrome_26c0000!BrowserViewLayout::Layout+0x78 [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view_layout.cc @ 253]  0013f164 02b06be0 02fa4b94 056d5480 02bd0c25   chrome_26c0000!BrowserView::Layout+0x35 [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view.cc @ 1581]  0013f168 02fa4b94 056d5480 02bd0c25 04223cf8   chrome_26c0000!BrowserView::ChildPreferredSizeChanged+0x5   [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view.cc @ 1608]  0013f170 02bd0c25 04223cf8 02b6ef2f 0013f25c   chrome_26c0000!views::View::PreferredSizeChanged+0x14 [c:bslavechrome-  officialbuildsrcviewsview.cc @ 171]  0013f178 02b6ef2f 0013f25c 0013f284 04223b48   chrome_26c0000!BookmarkBarView::OnStateChanged+0x11 [c:bslavechrome-  officialbuildsrcchromebrowserviewsbookmark_bar_view.cc @ 725]  0013f224 02b6f792 00000000 04190890 041cebc0   chrome_26c0000!ProfileSyncService::OnUnrecoverableError+0x48   [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 335]  0013f23c 02d0e8d9 000000a0 0013f284 0013f288   chrome_26c0000!ProfileSyncService::Observe+0x27 [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 567]  0013f26c 02ca5deb 041cb000 000000a0 0013f288   chrome_26c0000!NotificationService::Notify+0x185 [c:bslavechrome-  officialbuildsrcchromecommonnotification_service.cc @ 121]  0013f28c 02ca5cbf 00000002 103c31d4 02ca5be8   chrome_26c0000!browser_sync::DataTypeManagerImpl::NotifyDone+0x2b   [c:bslavechrome-  officialbuildsrcchromebrowsersyncgluedata_type_manager_impl.cc @   385]  0013f298 02ca5be8 1032d680 00000002 04223b40   chrome_26c0000!browser_sync::DataTypeManagerImpl::FinishStopAndNotify+0x13   [c:bslavechrome-  officialbuildsrcchromebrowsersyncgluedata_type_manager_impl.cc @   322]  0013f2a8 02b6ecd4 04223b40 011505ec 0013f2d8   chrome_26c0000!browser_sync::DataTypeManagerImpl::Stop+0x7e   [c:bslavechrome-  officialbuildsrcchromebrowsersyncgluedata_type_manager_impl.cc @   301]  0013f2b8 02b6edc8 00000001 103e3e9c 103e3e00   chrome_26c0000!ProfileSyncService::Shutdown+0x3d [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 246]  0013f2d8 02c478d1 02cbe1ec 02ad2f75 02fb547f   chrome_26c0000!ProfileSyncService::DisableForUser+0x1e [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 282]  0013f2dc 02cbe1ec 02ad2f75 02fb547f 00000000   chrome_26c0000!ContentPageView::OnConfirmMessageAccept+0xb   [c:bslavechrome-  officialbuildsrcchromebrowserviewsoptionscontent_page_view.cc @ 445]  0013f2e0 02ad2f75 02fb547f 00000000 103e3e00   chrome_26c0000!ConfirmMessageBoxDialog::Accept+0xa [c:bslavechrome-  officialbuildsrcchromebrowserviewsconfirm_message_box_dialog.cc @ 87]  0013f2e4 02fb547f 00000000 103e3e00 02fb57c8   chrome_26c0000!views::DialogDelegate::Accept+0x5 [c:bslavechrome-  officialbuildsrcviewswindowdialog_delegate.h @ 103]  0013f2f0 02fb57c8 0013f31c 080c58c0 02fb04f8   chrome_26c0000!views::DialogClientView::AcceptWindow+0x1a   [c:bslavechrome-officialbuildsrcviewswindowdialog_client_view.cc @   230]  0013f2fc 02fb04f8 080c58c0 0013f31c 011505ec   chrome_26c0000!views::DialogClientView::ButtonPressed+0x25   [c:bslavechrome-officialbuildsrcviewswindowdialog_client_view.cc @   406]  0013f310 02faaf36 0013f31c 00000003 0f9d91ce   chrome_26c0000!views::Button::NotifyClick+0x30 [c:bslavechrome-  officialbuildsrcviewscontrolsbuttonbutton.cc @ 62]  0013f330 02fc2b23 0df910f0 0013f368 02fad175   chrome_26c0000!views::NativeButton::ButtonPressed+0x3a [c:bslavechrome-  officialbuildsrcviewscontrolsbuttonnative_button.cc @ 125]  0013f33c 02fad175 00000111 00000000 011505ec   chrome_26c0000!views::NativeButtonWin::ProcessMessage+0x23   [c:bslavechrome-  officialbuildsrcviewscontrolsbuttonnative_button_win.cc @ 103]  0013f368 02efc1fa 00000111 00000000 011505ec   chrome_26c0000!views::WidgetWin::OnWndProc+0x71 [c:bslavechrome-  officialbuildsrcviewswidgetwidget_win.cc @ 1194]  0013f37c 7e418734 00b90630 00000111 00000000   chrome_26c0000!app::WindowImpl::WndProc+0x49 [c:bslavechrome-  officialbuildsrcappwinwindow_impl.cc @ 186]  0013f3a8 7e418816 02efc1b1 00b90630 00000111   user32!InternalCallWinProc+0x28  0013f410 7e42927b 00000000 02efc1b1 00b90630   user32!UserCallWinProcCheckWow+0x150  0013f44c 7e4292e3 0091eb48 0191ce58 00000000 user32!SendMessageWorker+0x4a5  0013f46c 773f7354 00b90630 00000111 00000000 user32!SendMessageW+0x7f  0013f48c 773f7436 07642f98 00000000 000a0024   comctl32!Button_NotifyParent+0x3d  0013f4a8 773f973b 07642f98 00000001 0013f5a0   comctl32!Button_ReleaseCapture+0xd7  0013f538 7e418734 011505ec 00000202 00000000 comctl32!Button_WndProc+0x887  0013f564 7e418816 773f8eb4 011505ec 00000202   user32!InternalCallWinProc+0x28  0013f5cc 7e42a013 00000000 773f8eb4 011505ec   user32!UserCallWinProcCheckWow+0x150  0013f5fc 7e42a039 773f8eb4 011505ec 00000202 user32!CallWindowProcAorW+0x98  0013f61c 02fc35ad 773f8eb4 011505ec 00000202 user32!CallWindowProcW+0x1b  0013f640 7e418734 011505ec 00000202 00000000   chrome_26c0000!views::NativeControlWin::NativeControlWndProc+0x81   [c:bslavechrome-officialbuildsrcviewscontrolsnative_control_win.cc   @ 198]  0013f66c 7e418816 02fc352c 011505ec 00000202   user32!InternalCallWinProc+0x28  0013f6d4 7e4189cd 00000000 02fc352c 011505ec   user32!UserCallWinProcCheckWow+0x150  0013f734 7e418a10 0013f7ac 00000000 0013f78c   user32!DispatchMessageWorker+0x306  0013f744 02fa48ae 0013f7ac 0013f7ac 041c0300 user32!DispatchMessageW+0xf  0013f78c 02a6439a 0013f7ac 0013f730 02a641f8   chrome_26c0000!views::AcceleratorHandler::Dispatch+0xf4 [c:bslavechrome-  officialbuildsrcviewsfocusaccelerator_handler_win.cc @ 61]  0013f798 02a641f8 00000000 041c0300 00000000   chrome_26c0000!base::MessagePumpForUI::ProcessMessageHelper+0x5e   [c:bslavechrome-officialbuildsrcbasemessage_pump_win.cc @ 360]  0013f7c8 02a6401f 041c4000 0013fa28 0013f824   chrome_26c0000!base::MessagePumpForUI::DoRunLoop+0x40 [c:bslavechrome-  officialbuildsrcbasemessage_pump_win.cc @ 205]  0013f7e4 02a53bd8 0013f824 0013f92c 02a53b68   chrome_26c0000!base::MessagePumpWin::RunWithDispatcher+0x38   [c:bslavechrome-officialbuildsrcbasemessage_pump_win.cc @ 54]  0013f7f0 02a53b68 0013f824 02a5411b 00000001   chrome_26c0000!MessageLoop::RunInternal+0x26 [c:bslavechrome-  officialbuildsrcbasemessage_loop.cc @ 206]  0013f7f8 02a5411b 00000001 0013f800 0013f824   chrome_26c0000!MessageLoop::RunHandler+0x17 [c:bslavechrome-  officialbuildsrcbasemessage_loop.cc @ 177]  0013f814 02ab5ba8 0013f824 0013f92c 0352d9ac   chrome_26c0000!MessageLoopForUI::Run+0x21 [c:bslavechrome-  officialbuildsrcbasemessage_loop.cc @ 613]  0013f848 02ab745f 034080b4 0013fdf4 00000000 chrome_26c0000!`anonymous   namespace'::RunUIMessageLoop+0x26 [c:bslavechrome-  officialbuildsrcchromebrowserbrowser_main.cc @ 183]  0013fcac 026c3d42 0013fcd8 00000007 01fc3ff8   chrome_26c0000!BrowserMain+0x11b8 [c:bslavechrome-  officialbuildsrcchromebrowserbrowser_main.cc @ 1176]  0013fe6c 0040340f 00400000 0013ff28 00021488   chrome_26c0000!ChromeMain+0x7f7 [c:bslavechrome-  officialbuildsrcchromeappchrome_dll_main.cc @ 814]  0013fed0 00403a95 00400000 0013ff28 fffffffe   chrome!MainDllLoader::Launch+0xcd [c:bslavechrome-  officialbuildsrcchromeappclient_util.cc @ 196]  0013ff30 00445dcf 00400000 00000000 00021566 chrome!wWinMain+0xdf   [c:bslavechrome-officialbuildsrcchromeappchrome_exe_main.cc @ 46]  0013ffc0 7c817077 00350031 002d0034 7ffde000 chrome!__tmainCRTStartup+0x112   [f:ddvctoolscrt_bldself_x86crtsrccrt0.c @ 263]  0013fff0 00000000 00445e3a 00000000 00000000 kernel32!BaseProcessStart+0x23      STACK_COMMAND:  ~0s; .ecxr ; kb    FAULTING_SOURCE_CODE:       403:   return backend_-&gt;GetStatusSummary();     404: }     405:      406: SyncBackendHost::Status   ProfileSyncService::QueryDetailedSyncStatus() {  &gt;  407:   return backend_-&gt;GetDetailedStatus();     408: }     409:      410: std::wstring ProfileSyncService::BuildSyncStatusSummaryText(     411:   const sync_api::SyncManager::Status::Summary&amp; summary) {     412:   switch (summary) {      SYMBOL_STACK_INDEX:  0    SYMBOL_NAME:  chrome!ProfileSyncService::QueryDetailedSyncStatus+9    FOLLOWUP_NAME:  MachineOwner    MODULE_NAME: chrome_26c0000    IMAGE_NAME:  chrome.dll    DEBUG_FLR_IMAGE_TIMESTAMP:  4bcfcba3    FAILURE_BUCKET_ID:    NULL_CLASS_PTR_DEREFERENCE_c0000005_chrome.dll!ProfileSyncService::QueryDet  ailedSyncStatus    BUCKET_ID:    APPLICATION_FAULT_NULL_CLASS_PTR_DEREFERENCE_INVALID_POINTER_READ_chrome!Pr  ofileSyncService::QueryDetailedSyncStatus+9    WATSON_STAGEONE_URL:    <a href="http://watson.microsoft.com/StageOne/chrome_exe/0_0_0_0/4bcfcbcf/chrome_dll">http://watson.microsoft.com/StageOne/chrome_exe/0_0_0_0/4bcfcbcf/chrome_dll</a>  /5_0_375_17/4bcfcba3/c0000005/004af2ce.htm?Retriage=1    Followup: MachineOwner  ---------    0:000&gt; k  ChildEBP RetAddr    0013e7f0 7c90df4a ntdll!KiFastSystemCallRet  0013e7f4 7c809590 ntdll!ZwWaitForMultipleObjects+0xc  0013e890 7c80a115 kernel32!WaitForMultipleObjectsEx+0x12c  0013e8ac 00420b7f kernel32!WaitForMultipleObjects+0x18  0013e8cc 00420af2   chrome!google_breakpad::CrashGenerationClient::SignalCrashEventAndWait+0x42   [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowscrash_generationcrash_gener  ation_client.cc @ 334]  0013e8d4 00420356   chrome!google_breakpad::CrashGenerationClient::RequestDump+0x44   [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowscrash_generationcrash_gener  ation_client.cc @ 288]  0013e924 0042001f   chrome!google_breakpad::ExceptionHandler::WriteMinidumpWithException+0x40   [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowshandlerexception_handler.cc   @ 675]  0013e948 7c864191   chrome!google_breakpad::ExceptionHandler::HandleException+0x45   [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowshandlerexception_handler.cc   @ 425]  0013ebb8 7c8438fa kernel32!UnhandledExceptionFilter+0x1c7  0013ebc0 7c839b39 kernel32!BaseProcessStart+0x39  0013ebe8 7c9032a8 kernel32!_except_handler3+0x61  0013ec0c 7c90327a ntdll!ExecuteHandler2+0x26  0013ecbc 7c90e48a ntdll!ExecuteHandler+0x24  0013ecbc 02b6f2ce ntdll!KiUserExceptionDispatcher+0xe  0013efb8 02b80e1f   chrome_26c0000!ProfileSyncService::QueryDetailedSyncStatus+0x9   [c:bslavechrome-  officialbuildsrcchromebrowsersyncprofile_sync_service.cc @ 407]  0013f028 02b81010 chrome_26c0000!sync_ui_util::`anonymous   namespace'::GetStatusInfo+0x39 [c:bslavechrome-  officialbuildsrcchromebrowsersyncsync_ui_util.cc @ 84]  0013f038 02bd23d6   chrome_26c0000!sync_ui_util::ShouldShowSyncErrorButton+0x1b   [c:bslavechrome-officialbuildsrcchromebrowsersyncsync_ui_util.cc @   167]  0013f09c 02bd034a chrome_26c0000!BookmarkBarView::LayoutItems+0x105   [c:bslavechrome-  officialbuildsrcchromebrowserviewsbookmark_bar_view.cc @ 1595]  0013f0a8 02b05c38 chrome_26c0000!BookmarkBarView::GetPreferredSize+0xd   [c:bslavechrome-  officialbuildsrcchromebrowserviewsbookmark_bar_view.cc @ 461]  0013f0c0 02bce6e9 chrome_26c0000!BrowserView::IsBookmarkBarVisible+0x35   [c:bslavechrome-  officialbuildsrcchromebrowserviewsframebrowser_view.cc @ 897]   </pre>