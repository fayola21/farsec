<title>Issue 39169 -   chromium -    browser_tests hitting a MessageLoop assertion  leading to crashiness - Project Hosting on Google Code</title> <pre> This happens for various  random browser tests. It's known to happen on Mac  but also on   ChromiumOS. I think this needs to be fixed soon  because random crashes make seeing real   failures harder.    Please make sure this has an owner. Feel free to reassign  but don't leave the owner field empty.    [94054:263:0324/153549:882769346871815:FATAL:/Users/ph/chromium-  svn/src/base/message_loop.cc(324)] Check failed: nestable_tasks_allowed_.   Backtrace:  	0   browser_tests                       0x00029212 StackTrace::StackTrace() + 32  	1   browser_tests                       0x0002a369 logging::LogMessage::~LogMessage() + 63  	2   browser_tests                       0x009491ab MessageLoop::RunTask(Task*) + 173  	3   browser_tests                       0x00949439   MessageLoop::ProcessNextDelayedNonNestableTask() + 109  	4   browser_tests                       0x00949457 MessageLoop::DoIdleWork() + 17  	5   browser_tests                       0x00919c34   base::MessagePumpCFRunLoopBase::RunIdleWork() + 74  	6   browser_tests                       0x00919c9d   base::MessagePumpCFRunLoopBase::RunIdleWorkSource(void*) + 23  	7   CoreFoundation                      0x972698cb __CFRunLoopDoSources0 + 1563  	8   CoreFoundation                      0x9726738f __CFRunLoopRun + 1071  	9   CoreFoundation                      0x97266864 CFRunLoopRunSpecific + 452  	10  CoreFoundation                      0x97266691 CFRunLoopRunInMode + 97  	11  HIToolbox                           0x97c35f0c RunCurrentEventLoopInMode + 392  	12  HIToolbox                           0x97c35cc3 ReceiveNextEventCommon + 354  	13  HIToolbox                           0x97c35b48 BlockUntilNextEventMatchingListInMode + 81  	14  AppKit                              0x936a9ac5 _DPSNextEvent + 847  	15  AppKit                              0x936a9306 -[NSApplication   nextEventMatchingMask:untilDate:inMode:dequeue:] + 156  	16  AppKit                              0x93886c56 -[NSButtonCell performClick:] + 983  	17  browser_tests                       0x0024b544 BrowserWindowCocoa::Close() + 170  	18  browser_tests                       0x001ac4f4 Browser::CloseFrame() + 30  	19  browser_tests                       0x001bae99 void DispatchToMethod&lt;Browser  void   (Browser::*)()&gt;(Browser*  void (Browser::*)()  Tuple0 const&amp;) + 56  	20  browser_tests                       0x001baeed   ScopedRunnableMethodFactory&lt;Browser&gt;::RunnableMethod&lt;void (Browser::*)()  Tuple0&gt;::Run()   + 81  	21  browser_tests                       0x009491da MessageLoop::RunTask(Task*) + 220  	22  browser_tests                       0x009498b9   MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;) + 53  	23  browser_tests                       0x00949b49 MessageLoop::DoWork() + 253  	24  browser_tests                       0x00919cea base::MessagePumpCFRunLoopBase::RunWork() +   74  	25  browser_tests                       0x00919d2f   base::MessagePumpCFRunLoopBase::RunWorkSource(void*) + 23  	26  CoreFoundation                      0x97269761 __CFRunLoopDoSources0 + 1201  	27  CoreFoundation                      0x9726738f __CFRunLoopRun + 1071  	28  CoreFoundation                      0x97266864 CFRunLoopRunSpecific + 452  	29  CoreFoundation                      0x97266691 CFRunLoopRunInMode + 97  	30  HIToolbox                           0x97c35f0c RunCurrentEventLoopInMode + 392  	31  HIToolbox                           0x97c35cc3 ReceiveNextEventCommon + 354  	32  HIToolbox                           0x97c35b48 BlockUntilNextEventMatchingListInMode + 81  	33  AppKit                              0x936a9ac5 _DPSNextEvent + 847  	34  AppKit                              0x936a9306 -[NSApplication   nextEventMatchingMask:untilDate:inMode:dequeue:] + 156  	35  AppKit                              0x9366b49f -[NSApplication run] + 821  	36  browser_tests                       0x0091982c   base::MessagePumpNSApplication::DoRun(base::MessagePump::Delegate*) + 130  	37  browser_tests                       0x00919e1b   base::MessagePumpCFRunLoopBase::Run(base::MessagePump::Delegate*) + 175  	38  browser_tests                       0x0094a282 MessageLoop::RunInternal() + 212  	39  browser_tests                       0x0094a29d MessageLoop::RunHandler() + 17  	40  browser_tests                       0x0094a301 MessageLoop::Run() + 35  	41  browser_tests                       0x001cd058 (anonymous   namespace)::RunUIMessageLoop(BrowserProcess*) + 19  	42  browser_tests                       0x001cf028 BrowserMain(MainFunctionParams const&amp;) + 8142  	43  browser_tests                       0x00059082 InProcessBrowserTest::SetUp() + 3284  	44  browser_tests                       0x00a3d8c7 testing::Test::Run() + 73  	45  browser_tests                       0x00a4188f testing::internal::TestInfoImpl::Run() + 189  	46  browser_tests                       0x00a419d2 testing::TestCase::Run() + 186  	47  browser_tests                       0x00a4260c testing::internal::UnitTestImpl::RunAllTests() +   658  	48  browser_tests                       0x00a4276a testing::UnitTest::Run() + 20  	49  browser_tests                       0x00060cba TestSuite::Run() + 304  	50  browser_tests                       0x0005f6d0 main + 1178  	51  browser_tests                       0x00057966 start + 54    ../base/test/test_suite.h:162: Failure  Failed  [94054:263:0324/153549:882769346871815:FATAL:/Users/ph/chromium-  svn/src/base/message_loop.cc(324)] Check failed: nestable_tasks_allowed_.   Backtrace:  	0   browser_tests                       0x00029212 StackTrace::StackTrace() + 32  	1   browser_tests                       0x0002a369 logging::LogMessage::~LogMessage() + 63  	2   browser_tests                       0x009491ab MessageLoop::RunTask(Task*) + 173  	3   browser_tests                       0x00949439   MessageLoop::ProcessNextDelayedNonNestableTask() + 109  	4   browser_tests                       0x00949457 MessageLoop::DoIdleWork() + 17  	5   browser_tests                       0x00919c34   base::MessagePumpCFRunLoopBase::RunIdleWork() + 74  	6   browser_tests                       0x00919c9d   base::MessagePumpCFRunLoopBase::RunIdleWorkSource(void*) + 23  	7   CoreFoundation                      0x972698cb __CFRunLoopDoSources0 + 1563  	8   CoreFoundation                      0x9726738f __CFRunLoopRun + 1071  	9   CoreFoundation                      0x97266864 CFRunLoopRunSpecific + 452  	10  CoreFoundation                      0x97266691 CFRunLoopRunInMode + 97  	11  HIToolbox                           0x97c35f0c RunCurrentEventLoopInMode + 392  	12  HIToolbox                           0x97c35cc3 ReceiveNextEventCommon + 354  	13  HIToolbox                           0x97c35b48 BlockUntilNextEventMatchingListInMode + 81  	14  AppKit                              0x936a9ac5 _DPSNextEvent + 847  	15  AppKit                              0x936a9306 -[NSApplication   nextEventMatchingMask:untilDate:inMode:dequeue:] + 156  	16  AppKit                              0x93886c56 -[NSButtonCell performClick:] + 983  	17  browser_tests                       0x0024b544 BrowserWindowCocoa::Close() + 170  	18  browser_tests                       0x001ac4f4 Browser::CloseFrame() + 30  	19  browser_tests                       0x001bae99 void DispatchToMethod&lt;Browser  void   (Browser::*)()&gt;(Browser*  void (Browser::*)()  Tuple0 const&amp;) + 56  	20  browser_tests                       0x001baeed   ScopedRunnableMethodFactory&lt;Browser&gt;::RunnableMethod&lt;void (Browser::*)()  Tuple0&gt;::Run()   + 81  	21  browser_tests                       0x009491da MessageLoop::RunTask(Task*) + 220  	22  browser_tests                       0x009498b9   MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;) + 53  	23  browser_tests                       0x00949b49 MessageLoop::DoWork() + 253  	24  browser_tests                       0x00919cea base::MessagePumpCFRunLoopBase::RunWork() +   74  	25  browser_tests                       0x00919d2f   base::MessagePumpCFRunLoopBase::RunWorkSource(void*) + 23  	26  CoreFoundation                      0x97269761 __CFRunLoopDoSources0 + 1201  	27  CoreFoundation                      0x9726738f __CFRunLoopRun + 1071  	28  CoreFoundation                      0x97266864 CFRunLoopRunSpecific + 452  	29  CoreFoundation                      0x97266691 CFRunLoopRunInMode + 97  	30  HIToolbox                           0x97c35f0c RunCurrentEventLoopInMode + 392  	31  HIToolbox                           0x97c35cc3 ReceiveNextEventCommon + 354  	32  HIToolbox                           0x97c35b48 BlockUntilNextEventMatchingListInMode + 81  	33  AppKit                              0x936a9ac5 _DPSNextEvent + 847  	34  AppKit                              0x936a9306 -[NSApplication   nextEventMatchingMask:untilDate:inMode:dequeue:] + 156  	35  AppKit                              0x9366b49f -[NSApplication run] + 821  	36  browser_tests                       0x0091982c   base::MessagePumpNSApplication::DoRun(base::MessagePump::Delegate*) + 130  	37  browser_tests                       0x00919e1b   base::MessagePumpCFRunLoopBase::Run(base::MessagePump::Delegate*) + 175  	38  browser_tests                       0x0094a282 MessageLoop::RunInternal() + 212  	39  browser_tests                       0x0094a29d MessageLoop::RunHandler() + 17  	40  browser_tests                       0x0094a301 MessageLoop::Run() + 35  	41  browser_tests                       0x001cd058 (anonymous   namespace)::RunUIMessageLoop(BrowserProcess*) + 19  	42  browser_tests                       0x001cf028 BrowserMain(MainFunctionParams const&amp;) + 8142  	43  browser_tests                       0x00059082 InProcessBrowserTest::SetUp() + 3284  	44  browser_tests                       0x00a3d8c7 testing::Test::Run() + 73  	45  browser_tests                       0x00a4188f testing::internal::TestInfoImpl::Run() + 189  	46  browser_tests                       0x00a419d2 testing::TestCase::Run() + 186  	47  browser_tests                       0x00a4260c testing::internal::UnitTestImpl::RunAllTests() +   658  	48  browser_tests                       0x00a4276a testing::UnitTest::Run() + 20  	49  browser_tests                       0x00060cba TestSuite::Run() + 304  	50  browser_tests                       0x0005f6d0 main + 1178  	51  browser_tests                       0x00057966 start + 54   </pre>