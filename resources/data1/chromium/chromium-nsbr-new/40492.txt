<title>Issue 40492 -   chromium -    Crash if you click a menu button twice before it opens the first time. - Project Hosting on Google Code</title> <pre>   1. Click on a menu button twice very quickly - the second click needs to happen before the menu   appears.      It crashes. Stack trace below.    The problem is that the second click gets queued and then handled by the nested message loop   that's created when opening the menu from the first click.    Proposed solution is for the nested message loop to be run with a Dispatcher that exits the   nested message loop if the event occurs outside the menu.    Stack trace:    native_menu_gtk.cc(105)] Check failed: !menu_shown_  Backtrace:          StackTrace::StackTrace() [0xe6d195]          logging::LogMessage::~LogMessage() [0xe7f769]          views::NativeMenuGtk::RunMenuAt() [0xdd6380]          views::Menu2::RunMenuAt() [0xdd2396]                 &lt;--- Show menu (mistakenly again)          chromeos::LanguageSwitchModel::RunMenu() [0xb98c3e]          views::MenuButton::Activate() [0xdc6ec3]             &lt;--- Second (impationed) MenuButton click          views::MenuButton::OnMousePressed() [0xdc6c30]          views::View::ProcessMousePressed() [0xe0648e]          views::RootView::OnMousePressed() [0xe0f98d]          views::WidgetGtk::ProcessMousePressed() [0xe14519]          views::WidgetGtk::OnButtonPress() [0xe14587]          views::WidgetGtk::OnButtonPressThunk() [0xe17212]          0x7fb9c484987f          0x7fb9c3737c8c          0x7fb9c374b7e8          0x7fb9c374cf6f          0x7fb9c374d633          0x7fb9c4950e55          0x7fb9c4842b92          0x7fb9c4843b35          base::MessagePumpForUI::EventDispatcher() [0xecdd45]          0x7fb9c44ad58c          0x7fb9c309b384          0x7fb9c309e695          0x7fb9c309eb7b          base::MessagePumpForUI::RunWithDispatcher() [0xecdf03]          base::MessagePumpForUI::Run() [0xeceb19]          MessageLoop::RunInternal() [0xe81ec3]          MessageLoop::RunHandler() [0xe81ee3]          MessageLoopForUI::Run() [0xe81f1f]                   &lt;--- NativeMenuGtk started its own modal   MessageLoop          views::NativeMenuGtk::RunMenuAt() [0xdd6445]          views::Menu2::RunMenuAt() [0xdd2396]                 &lt;--- Show the menu          chromeos::LanguageSwitchModel::RunMenu() [0xb98c3e]          views::MenuButton::Activate() [0xdc6ec3]             &lt;--- First MenuButtom click          views::MenuButton::OnMousePressed() [0xdc6c30]          views::View::ProcessMousePressed() [0xe0648e]          views::RootView::OnMousePressed() [0xe0f98d]          views::WidgetGtk::ProcessMousePressed() [0xe14519]          views::WidgetGtk::OnButtonPress() [0xe14587]          views::WidgetGtk::OnButtonPressThunk() [0xe17212]          0x7fb9c484987f          0x7fb9c3737bbf          0x7fb9c374b7e8          0x7fb9c374cf6f          0x7fb9c374d633          0x7fb9c4950e55          0x7fb9c4842b92          0x7fb9c4843b35          views::AcceleratorHandler::Dispatch() [0xdf1366]          base::MessagePumpForUI::EventDispatcher() [0xecdd27]          0x7fb9c44ad58c          0x7fb9c309b384          0x7fb9c309e695          0x7fb9c309eb7b          base::MessagePumpForUI::RunWithDispatcher() [0xecdf03]          MessageLoop::RunInternal() [0xe81e98]          MessageLoop::RunHandler() [0xe81ee3]          MessageLoopForUI::Run() [0xe81f1f]          (anonymous namespace)::RunUIMessageLoop() [0x45c06a]          BrowserMain() [0x45db72]          ChromeMain [0x4018a2]          main [0x402de7]   </pre>