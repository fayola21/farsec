<title>Issue 30582 -   chromium -    Data race on vfptr in chrome/common/worker_thread_ticker_unittest.cc - Project Hosting on Google Code</title> <pre> This data race was found using ThreadSanitizer:  <a href="http://build.chromium.org/buildbot/waterfall/builders/Linux%20Tests%20(tsan)/builds/1540/steps/valgrind%20test:%20unit/logs/">http://build.chromium.org/buildbot/waterfall/builders/Linux%20Tests%20(tsan)/builds/1540/steps/valgrind%20test:%20unit/logs/</a>  stdio  See <a href="http://www.chromium.org/developers/how-tos/using-valgrind/threadsanitizer">http://www.chromium.org/developers/how-tos/using-valgrind/threadsanitizer</a>    To reproduce a crash without TSan  apply the following patch:  $ svn diff chrome/common/worker_thread_ticker.cc  Index: chrome/common/worker_thread_ticker.cc  ===================================================================  --- chrome/common/worker_thread_ticker.cc       (<a href="/p/chromium/source/detail?r=34716">revision 34716</a>)  +++ chrome/common/worker_thread_ticker.cc       (working copy)  @@ -21 6 +21 7 @@       TickHandlerListType* handlers = &amp;ticker_-&gt;tick_handler_list_;       for (TickHandlerListType::const_iterator i = handlers-&gt;begin();            i != handlers-&gt;end(); ++i) {  +      sleep(1);         (*i)-&gt;OnTick();       }    $ hammer -C build unit_tests  $ ./sconsbuild/Debug/unit_tests --gtest_filter=&quot;*LongCallback*&quot;  Note: Google Test filter = *LongCallback*  [==========] Running 1 test from 1 test case.  [----------] Global test environment set-up.  [----------] 1 test from WorkerThreadTickerTest  [ RUN      ] WorkerThreadTickerTest.LongCallback  pure virtual method called  terminate called without an active exception  Aborted    This is probably a test-only race  but we need to make sure a similar race is not happening in the real binaries. </pre>