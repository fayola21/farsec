<title>Issue 40869 -   chromium -    UITest::TearDown doesn't seem to shutdown the browser process on Linux - Project Hosting on Google Code</title> <pre> We recently landed <a href="http://codereview.chromium.org/1617001">http://codereview.chromium.org/1617001</a> which changes the timing of the   startup code slightly (we check for the presence of an existing Chrome process before trying to   read the profile  so we don't inadvertently read out-of-date profile information on a restart).    After landing this  we're seeing ui_test failures on linux:   <a href="http://build.chromium.org/buildbot/waterfall/builders/Linux%20Builder%20(Views%20dbg)/build">http://build.chromium.org/buildbot/waterfall/builders/Linux%20Builder%20(Views%20dbg)/build</a>  s/9214/steps/ui_tests/logs/stdio    What seems to be happening is the SessionRestoreUITest code is trying to restart the browser:      virtual void QuitBrowserAndRestore(int expected_tab_count) {      UITest::TearDown();        clear_profile_ = false;        launch_arguments_.AppendSwitchWithValue(switches::kRestoreLastSession                                               IntToWString(expected_tab_count));      UITest::SetUp();  }        UITest::TearDown() should cause all existing chrome browser processes to exit. If it doesn't do   this  then various bad things can happen (in this case  the automation fails because our new   process exits in favor of the previously running process):    [ RUN      ] SessionRestoreUITest.FLAKY_RestoreAfterClosingTabbedBrowserWithAppAndLaunching  [22880:22880:3635142562657:WARNING:chrome/installer/util/master_preferences.cc(163)]   Master preferences file not found: /b/slave/chromium-dbg-linux-  views/build/src/out/Debug/master_preferences  [22880:22880:3635142565071:WARNING:chrome/browser/extensions/external_pref_extension_  provider.cc(104)] Unable to deserialize json data: File doesn't exist.  [22880:22880:3635142745871:WARNING:views/widget/widget_gtk.cc(153)] compositing not   supported; allowing anyway  [20085:20085:0408/140817:3635142788148:ERROR:chrome/test/ui/ui_test.cc(1240)] Not   implemented reached in bool UITestBase::LaunchBrowserHelper(const CommandLine&amp;  bool    bool  base::ProcessHandle*)  [22896:22896:3635142812950:WARNING:chrome/installer/util/master_preferences.cc(163)]   Master preferences file not found: /b/slave/chromium-dbg-linux-  views/build/src/out/Debug/master_preferences  Created new window in existing browser session.   &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;    As far as I can tell  the &quot;Created new window in existing browser session&quot; line should never be   emitted if UITest::TearDown() properly shuts down the existing chrome process.   </pre>