<title>Issue 24378 -   chromium -    valgrind logs do not identify the test that had the warning - Project Hosting on Google Code</title> <pre> The valgrind logs on the bots (or from tools/valgrind/chrome_tests.sh)  show  for each warning  both the command that was run  and the stack trace.  One or the other of these is often enough to identify the test  that caused the warning.  In the case of UI tests  each test is run  in its own valgrind session  so the Command: line in the warning is  usually sufficient.  But not always  see  <a href="http://build.chromium.org/buildbot/waterfall/builders/Chromium%20Mac%20UI%20(valgrind)(1)/builds/227/steps/valgrind%20test:%20ui/logs/stdio">http://build.chromium.org/buildbot/waterfall/builders/Chromium%20Mac%20UI%20(valgrind)(1)/builds/227/steps/valgrind%20test:%20ui/logs/stdio</a>  and  <a href="http://build.chromium.org/buildbot/waterfall/builders/Linux%20Tests%20(valgrind)(2)/builds/527/steps/valgrind%20test:%20ui/logs/stdio">http://build.chromium.org/buildbot/waterfall/builders/Linux%20Tests%20(valgrind)(2)/builds/527/steps/valgrind%20test:%20ui/logs/stdio</a>    In the past  I have worked around this by running   tools/valgrind/shard-all-tests.sh locally  but that's a pain   the bots should Just Have The Info.    So it seems that even for UI tests  we should do less batching of  tests under valgrind.      I found that running each test in valgrind by itself is way too   slow because there are many tests that take only 10ms  but   valgrind startup time is ~1 second.    <a href="http://codereview.chromium.org/192020">http://codereview.chromium.org/192020</a> is a compromise  that runs each group of tests in its own valgrind session.  That's still  2x too slow.  We probably want to either   a) rerun with more details turned on if an error is detected   (e.g. we could also turn on --track-origins then)  and/or   b) batch tests in valgrind intelligently according to how long they take  (e.g. batch all 10ms tests together in one run  but run all 10sec tests  individually).   </pre>