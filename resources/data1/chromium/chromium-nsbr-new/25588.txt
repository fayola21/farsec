<title>Issue 25588 -   chromium -    Reliability crash on HttpCache::Transaction::RequiresValidation - Project Hosting on Google Code</title> <pre> From http://chromebot/buildsummary?id=buildbot_29798_ext    net::HttpCache::Transaction::RequiresValidation+0x11 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 1111]  net::HttpCache::Transaction::BeginCacheValidation+0x73 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 931]  net::HttpCache::Transaction::ContinuePartialCacheValidation+0x135 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 1024]  net::HttpCache::Transaction::ValidateEntryHeadersAndContinue+0xcc [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 997]  net::HttpCache::Transaction::BeginPartialCacheValidation+0x198 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 975]  net::HttpCache::Transaction::EntryAvailable+0xa5 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 712]  net::HttpCache::AddTransactionToEntry+0xad [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 1967]  net::HttpCache::OnProcessPendingQueue+0xd6 [c:bslavechromium-rel-xpbuildsrcnethttphttp_cache.cc @ 2091]  ScopedRunnableMethodFactory&lt;net::HttpCache&gt;::RunnableMethod&lt;void (__thiscall net::HttpCache::*)(net::HttpCache::ActiveEntry   *) Tuple1&lt;net::HttpCache::ActiveEntry *&gt; &gt;::Run+0x30 [c:bslavechromium-rel-xpbuildsrcbasetask.h @ 147]  MessageLoop::RunTask+0x7e [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 315]  MessageLoop::DoWork+0x1ea [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 437]  base::MessagePumpForIO::DoRunLoop+0x7e [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.cc @ 469]  base::MessagePumpWin::Run+0x40 [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.h @ 78]  MessageLoop::RunInternal+0xc0 [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 199]  MessageLoop::RunHandler+0xa0 [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 182]  MessageLoop::Run+0x3d [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 156]  base::Thread::Run+0xb [c:bslavechromium-rel-xpbuildsrcbasethread.cc @ 133]  base::Thread::ThreadMain+0x8c [c:bslavechromium-rel-xpbuildsrcbasethread.cc @ 156]  `anonymous namespace'::ThreadFunc+0xd [c:bslavechromium-rel-xpbuildsrcbaseplatform_thread_win.cc @ 27]  WARNING: Stack unwind information not available. Following frames may be wrong.  kernel32!GetModuleFileNameA+0x1b4    We have two problems here:    1. The http cache is still valid  but this transaction's cache_ is NULL so we crash the first time we try to use it. It looks like the   only way to have a NULL cache_ is if the destructor of the transaction already run. The entry_ is marked as doomed (and it is still in   the doomed_entries_ of the cache)  so it seems like this transaction was just waiting on the pending list when the object was destroyed    but we only look at the list of active entries when we want to RemovePendingTransaction(). The original transaction finished  we see   another transaction queued and just call AddTransactionToEntry with a deleted transaction.    2. When the cache goes away  we go trough all doomed entries and delete them. Deleting the ActiveEntry_ from under the transaction means   that the transaction cannot access entry_ before making sure that cache_ is still there  and I don't think that's currently the case.     </pre>