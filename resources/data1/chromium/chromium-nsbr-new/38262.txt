<title>Issue 38262 -   chromium -    Potential race condition when a download completes - Project Hosting on Google Code</title> <pre> Here is the code in question:      // Called before DownloadFinished in order to avoid a race condition   where we    // attempt to open a completed download before it has been renamed.    ChromeThread::PostTask(        ChromeThread::FILE  FROM_HERE         NewRunnableMethod(            file_manager_  &amp;DownloadFileManager::OnFinalDownloadName             download-&gt;id()  target_path  this));    ...[snip]...    DownloadFinished(pending_it-&gt;first  pending_it-&gt;second);    The problem is that DownloadFinished is called on the current thread  while   OnFinalDownloadName runs on a separate thread. So it's possible that   OnFinalDownloadName could not run in time.    To see the race in action  change the PostTask to a PostDelayedTask with   about 1000ms delay  then try to install an extension from the gallery. You   will get an error  because the install flow tries to read the file before   it has been renamed. </pre>