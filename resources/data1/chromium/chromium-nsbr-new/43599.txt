<title>Issue 43599 -   chromium -    Crash in BookmarkBarView::BookmarkNodeRemovedImpl() due to index being out of bounds - Project Hosting on Google Code</title> <pre>   1. Build and run sync_integration_tests.exe on Windows using command line  flags &quot;--sync-user-for-test=&lt;user&gt; --sync-password-for-test=&lt;password&gt;  --gtest_filter=TwoClientLiveBookmarksSyncTest.MC_BiDirectionalPushAddingBM  --single_process&quot;    What do you see?    Chrome crashes  with the following stack trace:            StackTrace::StackTrace [0x01596101+33]  (d:chromium1srcbasedebug_util_win.cc:230)          logging::LogMessage::~LogMessage [0x0155AE91+81]  (d:chromium1srcbaselogging.cc:465)          BookmarkBarView::BookmarkNodeRemovedImpl [0x01A9E71B+203]  (d:chromium1srcchromebrowserviewsbookmark_bar_view.cc:1026)          BookmarkBarView::BookmarkNodeMoved [0x01A9E3B8+40]  (d:chromium1srcchromebrowserviewsbookmark_bar_view.cc:978)          BookmarkModel::Move [0x018E4ADF+639]  (d:chromium1srcchromebrowserbookmarksbookmark_model.cc:205)          browser_sync::BookmarkChangeProcessor::CreateOrUpdateBookmarkNode  [0x0226E68C+508]  (d:chromium1srcchromebrowsersyncgluebookmark_change_processor.cc:463)          browser_sync::BookmarkChangeProcessor::ApplyChangesFromSyncModel  [0x0226E35E+1262]  (d:chromium1srcchromebrowsersyncgluebookmark_change_processor.cc:421)          browser_sync::SyncBackendHost::Core::OnChangesApplied  [0x0193C06F+543]  (d:chromium1srcchromebrowsersyncgluesync_backend_host.cc:437)           sync_api::SyncManager::SyncInternal::HandleTransactionCompleteChangeEvent  [0x02567747+343] (d:chromium1srcchromebrowsersyncenginesyncapi.cc:1715)          sync_api::SyncManager::SyncInternal::HandleChangeEvent  [0x02567592+34] (d:chromium1srcchromebrowsersyncenginesyncapi.cc:1684)           SimpleHookup&lt;EventChannel&lt;syncable::DirectoryChangeEvent Lock AutoLock&gt; syncable::DirectoryChangeEvent sync_api::SyncManager::SyncInternal void  (__thiscall sync_api::SyncManager::SyncInterna  :*)(syncable::DirectoryChangeEvent const &amp;)&gt;::Callback [0x025749D3+35]  (d:chromium1srcchromecommondeprecatedevent_sys-inl.h:286)           EventListenerHookupImpl&lt;EventChannel&lt;syncable::DirectoryChangeEvent Lock AutoLock&gt; syncable::DirectoryChangeEvent SimpleHookup&lt;EventChannel&lt;syncable::DirectoryChangeEvent Lock AutoLock&gt; sync  le::DirectoryChangeEvent sync_api::SyncManager::SyncInternal vo  [0x02573564+180]  (d:chromium1srcchromecommondeprecatedevent_sys-inl.h:253)           EventChannel&lt;syncable::DirectoryChangeEvent Lock AutoLock&gt;::NotifyListeners  [0x0384B349+409]  (d:chromium1srcchromecommondeprecatedevent_sys-inl.h:183)          syncable::BaseTransaction::UnlockAndLog [0x038436F7+455]  (d:chromium1srcchromebrowsersyncsyncablesyncable.cc:959)          syncable::WriteTransaction::~WriteTransaction [0x03843C42+306]  (d:chromium1srcchromebrowsersyncsyncablesyncable.cc:1011)          browser_sync::ApplyUpdatesCommand::ModelChangingExecuteImpl  [0x038D0187+439]  (d:chromium1srcchromebrowsersyncengineapply_updates_command.cc:38)          browser_sync::ModelChangingSyncerCommand::StartChangingModel  [0x038D8345+37]  (d:chromium1srcchromebrowsersyncenginemodel_changing_syncer_command.h:35)          DispatchToMethod&lt;browser_sync::ModelChangingSyncerCommand void  (__thiscall browser_sync::ModelChangingSyncerCommand::*)(void)&gt;  [0x038D87AC+12] (d:chromium1srcbasetuple.h:412)          CallbackImpl&lt;browser_sync::ModelChangingSyncerCommand void  (__thiscall  browser_sync::ModelChangingSyncerCommand::*)(void) Tuple0&gt;::RunWithParams  [0x038D86E5+37] (d:chromium1srcbasecallba  .h:118)          CallbackRunner&lt;Tuple0&gt;::Run [0x0193CDB0+48]  (d:chromium1srcbasecallback.h:78)          browser_sync::UIModelWorker::CallDoWorkAndSignalTask::Run  [0x01C96164+36]  (d:chromium1srcchromebrowsersyncglueui_model_worker.cc:104)          MessageLoop::RunTask [0x0155D439+185]  (d:chromium1srcbasemessage_loop.cc:328)          MessageLoop::DeferOrRunPendingTask [0x0155D4E5+53]  (d:chromium1srcbasemessage_loop.cc:339)          MessageLoop::DoWork [0x0155DA39+233]  (d:chromium1srcbasemessage_loop.cc:443)          base::MessagePumpForUI::DoRunLoop [0x015ED9B4+84]  (d:chromium1srcbasemessage_pump_win.cc:209)          base::MessagePumpWin::RunWithDispatcher [0x015ED282+130]  (d:chromium1srcbasemessage_pump_win.cc:52)          MessageLoop::RunInternal [0x0155CBCF+223]  (d:chromium1srcbasemessage_loop.cc:200)          MessageLoop::RunHandler [0x0155C9BB+43]  (d:chromium1srcbasemessage_loop.cc:177)          MessageLoopForUI::Run [0x0155E189+73]  (d:chromium1srcbasemessage_loop.cc:612)          ui_test_utils::RunMessageLoop [0x018699D7+71]  (d:chromium1srcchrometestui_test_utils.cc:313)          ProfileSyncServiceTestHarness::AwaitStatusChangeWithTimeout  [0x01282F36+166]  (d:chromium1srcchrometestlive_syncprofile_sync_service_test_harness.cc:202)          ProfileSyncServiceTestHarness::AwaitSyncCycleCompletion  [0x01282D2E+46]  (d:chromium1srcchrometestlive_syncprofile_sync_service_test_harness.cc:170)          ProfileSyncServiceTestHarness::AwaitMutualSyncCycleCompletion  [0x01282D94+52]  (d:chromium1srcchrometestlive_syncprofile_sync_service_test_harness.cc:176)           TwoClientLiveBookmarksSyncTest_MC_BiDirectionalPushAddingBM_Test::RunTestOnMainThread  [0x012A6FC2+1666]  (d:chromium1srcchrometestlive_synctwo_client_live_bookmarks_sync_test.cc:2314)          InProcessBrowserTest::RunTestOnMainThreadLoop [0x01263877+391]  (d:chromium1srcchrometestin_process_browser_test.cc:295)          DispatchToMethod&lt;InProcessBrowserTest void (__thiscall  InProcessBrowserTest::*)(void)&gt; [0x0127911C+12]  (d:chromium1srcbasetuple.h:412)          RunnableMethod&lt;InProcessBrowserTest void (__thiscall  InProcessBrowserTest::*)(void) Tuple0&gt;::Run [0x012746E1+49]  (d:chromium1srcbasetask.h:296)          BrowserMain [0x0188808E+7470]  (d:chromium1srcchromebrowserbrowser_main.cc:1179)          InProcessBrowserTest::SetUp [0x0125F7D5+2437]  (d:chromium1srcchrometestin_process_browser_test.cc:208)          LiveSyncTest::SetUp [0x0127D8DD+813]  (d:chromium1srcchrometestlive_synclive_sync_test.h:59)          testing::Test::Run [0x017A1893+163]  (d:chromium1srctestinggtestsrcgtest.cc:2060)          testing::internal::TestInfoImpl::Run [0x017A25D3+339]  (d:chromium1srctestinggtestsrcgtest.cc:2318)          testing::TestCase::Run [0x017A2B71+241]  (d:chromium1srctestinggtestsrcgtest.cc:2421)          testing::internal::UnitTestImpl::RunAllTests [0x017A7F43+643]  (d:chromium1srctestinggtestsrcgtest.cc:4025)          testing::UnitTest::Run [0x017A6B36+182]  (d:chromium1srctestinggtestsrcgtest.cc:3677)          TestSuite::Run [0x012F50DE+238]  (d:chromium1srcbasetesttest_suite.h:125)          main [0x012F4E8F+623]  (d:chromium1srcchrometesttest_launcherout_of_proc_test_runner.cc:134)          __tmainCRTStartup [0x01300DA7+251]  (f:ddvctoolscrt_bldself_x86crtsrccrt0.c:266)          BaseThreadInitThunk [0x74F73677+18]          RtlInitializeExceptionChain [0x772D9D72+99]          RtlInitializeExceptionChain [0x772D9D45+54]    Additional information:    This is not a 100% repro  but happens often enough.       </pre>