<title>Issue 24162 -   chromium -    DCHECK widget-&gt;restore_focus_when_enabled_. - Project Hosting on Google Code</title> <pre> I was in Calendar  there was a notification (window.alert) being displayed.  I was trying to debug a separate problem  but to make a long story short I  tried to change focus to another chromium window  and this led to a dcheck.  Stack trace below (yuck). in <a href="/p/chromium/source/detail?r=28255">r28255</a>      4120:4504:186519615:FATAL:render_widget_host.cc(276)] Check failed:  !is_hidden_ || !force_create. GetBackingStore called while hidden!           	chrome.dll!DebugUtil::BreakDebugger()  Line 221	C++   	chrome.dll!logging::LogMessage::~LogMessage()  Line 559	C++  &gt;	chrome.dll!RenderWidgetHost::GetBackingStore(bool force_create=true)   Line 281	C++   	chrome.dll!RenderWidgetHostViewWin::OnPaint(HDC__ * dc=0x00000000)  Line  700 + 0xd bytes	C++   	chrome.dll!RenderWidgetHostViewWin::ProcessWindowMessage(HWND__ *  hWnd=0x000d0cb4  unsigned int uMsg=15  unsigned int wParam=0  long  lParam=0  long &amp; lResult=-858993460  unsigned long dwMsgMapID=0)  Line 68 +  0x1c bytes	C++     chrome.dll!ATL::CWindowImplBaseT&lt;ATL::CWindow ATL::CWinTraits&lt;1174405120 0&gt;  &gt;::WindowProc(HWND__ * hWnd=0x0639cb40  unsigned int uMsg=15  unsigned int  wParam=0  long lParam=0)  Line 3081 + 0x27 bytes	C++   	user32.dll!76038807() 	   	[Frames below may be incorrect and/or missing  no symbols loaded for  user32.dll]	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	ntdll.dll!77e32ed6() 	   	user32.dll!7608d3f6() 	   	chrome.dll!logging::DisplayDebugMessage(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  str=&quot;[4120:4504:186485513:FATAL:render_widget_host.cc(276)] Check failed:  !is_hidden_ || !force_create. GetBackingStore called while hidden!  Backtrace:  	StackTrace::StackTrace [0x60D9F401+33]  (d:srcchromiumtrunksrcbasedebug_util_win.cc:226)  	logging::LogMessage::~LogMessage [0x60D7BC4A+618]  (d:srcchromiumtrunksrcbaselogging.cc:540)  	RenderWidgetHost::GetBackingStore [0x6135A967+183] (d:sr)  Line 348 +  0x22 bytes	C++   	chrome.dll!logging::LogMessage::~LogMessage()  Line 554 + 0x18 bytes	C++   	chrome.dll!RenderWidgetHost::GetBackingStore(bool force_create=true)   Line 281	C++   	chrome.dll!RenderWidgetHostViewWin::OnPaint(HDC__ * dc=0x00000000)  Line  700 + 0xd bytes	C++   	chrome.dll!RenderWidgetHostViewWin::ProcessWindowMessage(HWND__ *  hWnd=0x000d0cb4  unsigned int uMsg=15  unsigned int wParam=0  long  lParam=0  long &amp; lResult=-858993460  unsigned long dwMsgMapID=0)  Line 68 +  0x1c bytes	C++     chrome.dll!ATL::CWindowImplBaseT&lt;ATL::CWindow ATL::CWinTraits&lt;1174405120 0&gt;  &gt;::WindowProc(HWND__ * hWnd=0x0639cb40  unsigned int uMsg=15  unsigned int  wParam=0  long lParam=0)  Line 3081 + 0x27 bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	user32.dll!7608d3f6() 	   	chrome.dll!logging::DisplayDebugMessage(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  str=&quot;[4120:4504:186483735:FATAL:widget_win.cc(1143)] Check failed:  !widget-&gt;restore_focus_when_enabled_.   Backtrace:  	StackTrace::StackTrace [0x60D9F401+33]  (d:srcchromiumtrunksrcbasedebug_util_win.cc:226)  	logging::LogMessage::~LogMessage [0x60D7BC4A+618]  (d:srcchromiumtrunksrcbaselogging.cc:540)  	views::WidgetWin::PostProcessActivateMessage [0x627C85DC+348]  (d:srcchromiumtrunksrcview)  Line 348 + 0x22 bytes	C++   	chrome.dll!logging::LogMessage::~LogMessage()  Line 554 + 0x18 bytes	C++   	chrome.dll!views::WidgetWin::PostProcessActivateMessage(views::WidgetWin  * widget=0x02ab0484  int activation_state=1)  Line 1144	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=6  unsigned  int w_param=1  long l_param=1051674)  Line 1116 + 0x16 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=6  unsigned int w_param=1  long l_param=1051674)  Line 182 +  0x1b bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!BrowserView::Activate()  Line 723 + 0x36 bytes	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 617 + 0x1a bytes	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=2097152)  Line 182  + 0xe bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x00190720  unsigned int uMsg=134  unsigned int wParam=2097152  long  lParam=1051674  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 +  0x29 bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x00190720  unsigned int uMsg=134  unsigned int wParam=2097152  long  lParam=1051674  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 +  0x47 bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=2097152  long l_param=1051674)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x00190720  unsigned  int message=134  unsigned int w_param=2097152  long l_param=1051674)  Line  182 + 0x1b bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	msctf.dll!76c51635() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	chrome.dll!views::WindowWin::Activate()  Line 240 + 0x2f bytes	C++   	chrome.dll!views::WindowWin::Show(int show_state=1)  Line 154 + 0x13  bytes	C++   	chrome.dll!views::WindowWin::Show()  Line 235	C++   	chrome.dll!JavascriptMessageBoxDialog::ActivateModalDialog()  Line 50 +  0x17 bytes	C++   	chrome.dll!AppModalDialog::ActivateModalDialog()  Line 23	C++   	chrome.dll!AppModalDialogQueue::ActivateModalDialog()  Line 30	C++   	chrome.dll!BrowserView::ActivateAppModalDialog()  Line 620	C++   	chrome.dll!BrowserFrameWin::OnNCActivate(int active=0)  Line 182 + 0xe  bytes	C++   	chrome.dll!views::WidgetWin::_ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 150 + 0x29  bytes	C++   	chrome.dll!views::WidgetWin::ProcessWindowMessage(HWND__ *  hWnd=0x0013041c  unsigned int uMsg=134  unsigned int wParam=0  long  lParam=0  long &amp; lResult=0  unsigned long dwMsgMapID=0)  Line 96 + 0x47  bytes	C++   	chrome.dll!views::WidgetWin::OnWndProc(unsigned int message=134  unsigned  int w_param=0  long l_param=0)  Line 1111 + 0x24 bytes	C++   	chrome.dll!base::WindowImpl::WndProc(HWND__ * hwnd=0x0013041c  unsigned  int message=134  unsigned int w_param=0  long l_param=0)  Line 182 + 0x1b  bytes	C++   	user32.dll!76038807() 	   	user32.dll!76038962() 	   	user32.dll!76038911() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b545() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603b4d4() 	   	user32.dll!7603ed59() 	   	user32.dll!7603b545() 	   	ntdll.dll!77e32ed6() 	   	user32.dll!760382ae() 	   	user32.dll!7603831a() 	   	chrome.dll!base::MessagePumpForUI::ProcessNextWindowsMessage()  Line 335  + 0x14 bytes	C++   	chrome.dll!base::MessagePumpForUI::DoRunLoop()  Line 205 + 0x8 bytes	C++     chrome.dll!base::MessagePumpWin::RunWithDispatcher(base::MessagePump::Delegate  * delegate=0x0064f2a4  base::MessagePumpWin::Dispatcher *  dispatcher=0x0064e268)  Line 52 + 0xf bytes	C++   	chrome.dll!MessageLoop::RunInternal()  Line 195	C++   	chrome.dll!MessageLoop::RunHandler()  Line 182	C++   	chrome.dll!MessageLoopForUI::Run(base::MessagePumpWin::Dispatcher *  dispatcher=0x0064e268)  Line 600	C++   	chrome.dll!`anonymous namespace'::RunUIMessageLoop(BrowserProcess *  browser_process=0x02a94000)  Line 155	C++   	chrome.dll!BrowserMain(const MainFunctionParams &amp; parameters={...})  Line  858 + 0x11 bytes	C++   	chrome.dll!ChromeMain(HINSTANCE__ * instance=0x00240000   sandbox::SandboxInterfaceInfo * sandbox_info=0x0064fc5c  wchar_t *  command_line=0x00a71082)  Line 605 + 0xc bytes	C++   	chrome.exe!wWinMain(HINSTANCE__ * instance=0x00240000  HINSTANCE__ *  prev_instance=0x00000000  wchar_t * command_line=0x00a71082  int  __formal=1)  Line 104 + 0x14 bytes	C++   	chrome.exe!__tmainCRTStartup()  Line 263 + 0x2c bytes	C   	chrome.exe!wWinMainCRTStartup()  Line 182	C   	kernel32.dll!761fe4a5() 	   	ntdll.dll!77e8cfed() 	   	ntdll.dll!77e8d1ff() 	   </pre>