<title>Issue 39963 -   chromium -    Memory leak inside ExntesionService::Init in Linux/CrOS ui tests - Project Hosting on Google Code</title> <pre> This started around <a href="/p/chromium/source/detail?r=43162">r43162</a> on all the Valgrind bots.    Command: /b/slave/chromium-rel-linux-valgrind-tests-  2/build/src/sconsbuild/Release/chrome --no-first-run --no-default-browser-  check --test-type=ui --enable-file-cookies --noerrdialogs --  homepage=about:blank --disable-web-resources --user-data-  dir=/tmp/org.chromium.ZJ7q74/test_user_data --metrics-recording-only --  enable-logging --test-  name=ChromeMainTest.ReuseBrowserInstanceWhenOpeningFile --allow-file-  access-from-files /b/slave/chromium-rel-linux-valgrind-tests-  2/build/src/chrome/test/data/empty.html  40 (24 direct  16 indirect) bytes in 1 blocks are definitely lost in loss   record 763 of 1 030    operator new(unsigned int) (mp/vg-chr/scripts/valgrind-  source/coregrind/m_replacemalloc/vg_replace_malloc.c:228)    (anonymous   namespace)::ChromeCookieMonsterDelegate::ChromeCookieMonsterDelegate(Profil  e*) (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:117)    ChromeURLRequestContextFactory::ChromeURLRequestContextFactory(Profile*)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:956)    (anonymous namespace)::FactoryForMedia::FactoryForMedia(Profile*    FilePath const&amp;  int  bool)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:408)    ChromeURLRequestContextGetter::CreateRequestContextForMedia(Profile*    FilePath const&amp;  int  bool)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:668)    ChromeURLRequestContextGetter::CreateOriginalForMedia(Profile*  FilePath   const&amp;  int)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:571)    ProfileImpl::GetRequestContextForMedia()   (uilder/build/src/chrome/browser/profile.cc:980)    ProfileImpl::RegisterExtensionWithRequestContexts(Extension*)   (uilder/build/src/chrome/browser/profile.cc:1021)    ExtensionsService::NotifyExtensionLoaded(Extension*)   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:588)    ExtensionsService::OnExtensionLoaded(Extension*  bool)   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:845)    ExtensionsService::LoadComponentExtensions()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:442)    ExtensionsService::LoadAllExtensions()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:451)    ExtensionsService::Init()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:203)    ProfileImpl::InitExtensions()   (uilder/build/src/chrome/browser/profile.cc:724)    ProfileManager::AddProfile(Profile*  bool)   (uilder/build/src/chrome/browser/profile_manager.cc:194)    ProfileManager::GetProfile(FilePath const&amp;  bool)   (uilder/build/src/chrome/browser/profile_manager.cc:174)    ProfileManager::GetProfile(FilePath const&amp;)   (uilder/build/src/chrome/browser/profile_manager.cc:154)    ProfileManager::GetDefaultProfile(FilePath const&amp;)   (uilder/build/src/chrome/browser/profile_manager.cc:135)    (anonymous namespace)::CreateProfile(MainFunctionParams const&amp;  FilePath   const&amp;) (uilder/build/src/chrome/browser/browser_main.cc:494)    BrowserMain(MainFunctionParams const&amp;)   (uilder/build/src/chrome/browser/browser_main.cc:893)    ChromeMain (uilder/build/src/chrome/app/chrome_dll_main.cc:814)    main (uilder/build/src/chrome/app/chrome_exe_main_gtk.cc:47)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*       fun:_ZN77_GLOBAL__N_chrome_browser_net_chrome_url_request_context.cc_000000  00_E7D8910527ChromeCookieMonsterDelegateC1EP7Profile     fun:_ZN30ChromeURLRequestContextFactoryC2EP7Profile       fun:_ZN77_GLOBAL__N_chrome_browser_net_chrome_url_request_context.cc_000000  00_E7D8910515FactoryForMediaC1EP7ProfileRK8FilePathib       fun:_ZN29ChromeURLRequestContextGetter28CreateRequestContextForMediaEP7Prof  ileRK8FilePathib       fun:_ZN29ChromeURLRequestContextGetter22CreateOriginalForMediaEP7ProfileRK8  FilePathi     fun:_ZN11ProfileImpl25GetRequestContextForMediaEv     fun:_ZN11ProfileImpl36RegisterExtensionWithRequestContextsEP9Extension     fun:_ZN17ExtensionsService21NotifyExtensionLoadedEP9Extension     fun:_ZN17ExtensionsService17OnExtensionLoadedEP9Extensionb     fun:_ZN17ExtensionsService23LoadComponentExtensionsEv     fun:_ZN17ExtensionsService17LoadAllExtensionsEv     fun:_ZN17ExtensionsService4InitEv     fun:_ZN11ProfileImpl14InitExtensionsEv     fun:_ZN14ProfileManager10AddProfileEP7Profileb     fun:_ZN14ProfileManager10GetProfileERK8FilePathb     fun:_ZN14ProfileManager10GetProfileERK8FilePath     fun:_ZN14ProfileManager17GetDefaultProfileERK8FilePath       fun:_ZN59_GLOBAL__N_chrome_browser_browser_main.cc_00000000_D69CE42E13Creat  eProfileERK18MainFunctionParamsRK8FilePath     fun:_Z11BrowserMainRK18MainFunctionParams     fun:ChromeMain     fun:main  }    23:51:24 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: /b/slave/chromium-rel-linux-valgrind-tests-  2/build/src/sconsbuild/Release/chrome --no-first-run --no-default-browser-  check --test-type=ui --enable-file-cookies --noerrdialogs --  homepage=about:blank --disable-web-resources --user-data-  dir=/tmp/org.chromium.ZJ7q74/test_user_data --metrics-recording-only --  enable-logging --test-  name=ChromeMainTest.ReuseBrowserInstanceWhenOpeningFile --allow-file-  access-from-files /b/slave/chromium-rel-linux-valgrind-tests-  2/build/src/chrome/test/data/empty.html  40 (24 direct  16 indirect) bytes in 1 blocks are definitely lost in loss   record 762 of 1 030    operator new(unsigned int) (mp/vg-chr/scripts/valgrind-  source/coregrind/m_replacemalloc/vg_replace_malloc.c:228)    (anonymous   namespace)::ChromeCookieMonsterDelegate::ChromeCookieMonsterDelegate(Profil  e*) (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:117)    ChromeURLRequestContextFactory::ChromeURLRequestContextFactory(Profile*)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:956)    (anonymous   namespace)::FactoryForExtensions::FactoryForExtensions(Profile*  FilePath   const&amp;)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:306)    ChromeURLRequestContextGetter::CreateOriginalForExtensions(Profile*    FilePath const&amp;)   (uilder/build/src/chrome/browser/net/chrome_url_request_context.cc:581)    ProfileImpl::GetRequestContextForExtensions()   (uilder/build/src/chrome/browser/profile.cc:1002)    ProfileImpl::RegisterExtensionWithRequestContexts(Extension*)   (uilder/build/src/chrome/browser/profile.cc:1017)    ExtensionsService::NotifyExtensionLoaded(Extension*)   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:588)    ExtensionsService::OnExtensionLoaded(Extension*  bool)   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:845)    ExtensionsService::LoadComponentExtensions()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:442)    ExtensionsService::LoadAllExtensions()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:451)    ExtensionsService::Init()   (uilder/build/src/chrome/browser/extensions/extensions_service.cc:203)    ProfileImpl::InitExtensions()   (uilder/build/src/chrome/browser/profile.cc:724)    ProfileManager::AddProfile(Profile*  bool)   (uilder/build/src/chrome/browser/profile_manager.cc:194)    ProfileManager::GetProfile(FilePath const&amp;  bool)   (uilder/build/src/chrome/browser/profile_manager.cc:174)    ProfileManager::GetProfile(FilePath const&amp;)   (uilder/build/src/chrome/browser/profile_manager.cc:154)    ProfileManager::GetDefaultProfile(FilePath const&amp;)   (uilder/build/src/chrome/browser/profile_manager.cc:135)    (anonymous namespace)::CreateProfile(MainFunctionParams const&amp;  FilePath   const&amp;) (uilder/build/src/chrome/browser/browser_main.cc:494)    BrowserMain(MainFunctionParams const&amp;)   (uilder/build/src/chrome/browser/browser_main.cc:893)    ChromeMain (uilder/build/src/chrome/app/chrome_dll_main.cc:814)    main (uilder/build/src/chrome/app/chrome_exe_main_gtk.cc:47)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*       fun:_ZN77_GLOBAL__N_chrome_browser_net_chrome_url_request_context.cc_000000  00_E7D8910527ChromeCookieMonsterDelegateC1EP7Profile     fun:_ZN30ChromeURLRequestContextFactoryC2EP7Profile       fun:_ZN77_GLOBAL__N_chrome_browser_net_chrome_url_request_context.cc_000000  00_E7D8910520FactoryForExtensionsC1EP7ProfileRK8FilePath       fun:_ZN29ChromeURLRequestContextGetter27CreateOriginalForExtensionsEP7Profi  leRK8FilePath     fun:_ZN11ProfileImpl30GetRequestContextForExtensionsEv     fun:_ZN11ProfileImpl36RegisterExtensionWithRequestContextsEP9Extension     fun:_ZN17ExtensionsService21NotifyExtensionLoadedEP9Extension     fun:_ZN17ExtensionsService17OnExtensionLoadedEP9Extensionb     fun:_ZN17ExtensionsService23LoadComponentExtensionsEv     fun:_ZN17ExtensionsService17LoadAllExtensionsEv     fun:_ZN17ExtensionsService4InitEv     fun:_ZN11ProfileImpl14InitExtensionsEv     fun:_ZN14ProfileManager10AddProfileEP7Profileb     fun:_ZN14ProfileManager10GetProfileERK8FilePathb     fun:_ZN14ProfileManager10GetProfileERK8FilePath     fun:_ZN14ProfileManager17GetDefaultProfileERK8FilePath       fun:_ZN59_GLOBAL__N_chrome_browser_browser_main.cc_00000000_D69CE42E13Creat  eProfileERK18MainFunctionParamsRK8FilePath     fun:_Z11BrowserMainRK18MainFunctionParams     fun:ChromeMain     fun:main  }   </pre>