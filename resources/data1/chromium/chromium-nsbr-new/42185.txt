<title>Issue 42185 -   chromium -    Valgrind leak for AutoFillProfile - Project Hosting on Google Code</title> <pre>     (original reports:  <a href="http://build.chromium.org/buildbot/memory/builders/Chromium%20Mac%20(valgrind)/builds/4353/steps/valgrind%20test:%20unit/logs/stdio">http://build.chromium.org/buildbot/memory/builders/Chromium%20Mac%20(valgrind)/builds/4353/steps/valgrind%20test:%20unit/logs/stdio</a>  <a href="http://build.chromium.org/buildbot/memory/builders/Linux%20Tests%20(valgrind)(1)/builds/4086/steps/valgrind%20test:%20unit/logs/stdio">http://build.chromium.org/buildbot/memory/builders/Linux%20Tests%20(valgrind)(1)/builds/4086/steps/valgrind%20test:%20unit/logs/stdio</a>  )      01:33:42 common.py [INFO] process ended  did not time out  01:33:42 common.py [INFO] flushing stdout  01:33:42 common.py [INFO] collecting result code  -----------------------------------------------------  Suppressions used:    count name        1 bug_16093        1 bug_30704c        1 <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=518443">https://bugzilla.mozilla.org/show_bug.cgi?id=518443</a>        1 intentional_ChromeThreadTest_NotReleasedIfTargetThreadNonExistent_Test_leak        1 v8_bug_275        2 bug_16128        2 bug_17540        2 glibc leak.  See also <a href="http://sources.redhat.com/bugzilla/show_bug.cgi?id=2451">http://sources.redhat.com/bugzilla/show_bug.cgi?id=2451</a>        3 logging::InitLogging never frees filename. It would be hard to free properly.        4 bug_16576        5 intentional_WebCore_XMLNames_init_leak        7 bug_12614        7 bug_17291        8 bug_17385       11 bug_19191       12 bug_20653b       12 bug_30703a       14 bug_30704a       24 pango_font_leak_todo       47 zlib-1.2.x trickyness (3a): See <a href="http://www.zlib.net/zlib_faq.html#faq36">http://www.zlib.net/zlib_faq.html#faq36</a>       65 bug_20653a       85 bug_27313       99 Fontconfig leak?      164 dl-hack3-cond-1      334 zlib-1.2.x trickyness (3b): See <a href="http://www.zlib.net/zlib_faq.html#faq36">http://www.zlib.net/zlib_faq.html#faq36</a>      590 bug_17996      655 gtk developers don't like cleaning up one-time leaks.  See <a href="http://mail.gnome.org/archives/gtk-devel-list/2004-April/msg00230.html">http://mail.gnome.org/archives/gtk-devel-list/2004-April/msg00230.html</a>      754 bug_16583      782 bug_16579     4139 zlib-1.2.x trickyness (1b): See <a href="http://www.zlib.net/zlib_faq.html#faq36">http://www.zlib.net/zlib_faq.html#faq36</a>  -----------------------------------------------------  01:33:43 memcheck_analyze.py [ERROR] FAIL! There were 3 errors:   01:33:43 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/unit_tests --gtest_filter=-  VisitedLinkEventsTest.Coalescense:VisitedLinkRelayTest.Basics:RenderViewTest.ImeComposition:DnsMasterTest.MassiveConcurrentLookupTest:URLFetcherBadHTTPSTest.BadHTTPSTest --  gtest_print_time  1 068 (40 direct  1 028 indirect) bytes in 1 blocks are definitely lost in loss record 18 593 of 18 956    operator new(unsigned int) (mp/vg_bins/scripts/valgrind-memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:269)    AutoFillProfileFromStatement(sql::Statement const&amp;) (uilder/build/src/chrome/browser/webdata/web_database.cc:1434)    WebDatabase::GetAutoFillProfiles(std::vector&lt;AutoFillProfile*  std::allocator&lt;AutoFillProfile*&gt; &gt;*) (uilder/build/src/chrome/browser/webdata/web_database.cc:1497)    WebDataService::GetAutoFillProfilesImpl(WebDataService::WebDataRequest*) (uilder/build/src/chrome/browser/webdata/web_data_service.cc:861)    void DispatchToMethod&lt;WebDataService  void (WebDataService::*)(WebDataService::WebDataRequest*)  WebDataService::WebDataRequest*&gt;(WebDataService*  void   (WebDataService::*)(WebDataService::WebDataRequest*)  Tuple1&lt;WebDataService::WebDataRequest*&gt; const&amp;) (uilder/build/src/./base/tuple.h:422)    RunnableMethod&lt;WebDataService  void (WebDataService::*)(WebDataService::WebDataRequest*)  Tuple1&lt;WebDataService::WebDataRequest*&gt; &gt;::Run() (uilder/build/src/./base/task.h:296)    MessageLoop::RunTask(Task*) (uilder/build/src/base/message_loop.cc:328)    MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;) (uilder/build/src/base/message_loop.cc:336)    MessageLoop::DoWork() (uilder/build/src/base/message_loop.cc:443)    base::MessagePumpDefault::Run(base::MessagePump::Delegate*) (uilder/build/src/base/message_pump_default.cc:23)    MessageLoop::RunInternal() (uilder/build/src/base/message_loop.cc:204)    MessageLoop::RunHandler() (uilder/build/src/base/message_loop.cc:176)    MessageLoop::Run() (uilder/build/src/base/message_loop.cc:154)    base::Thread::Run(MessageLoop*) (uilder/build/src/base/thread.cc:133)    base::Thread::ThreadMain() (uilder/build/src/base/thread.cc:156)    ThreadFunc(void*) (uilder/build/src/base/platform_thread_posix.cc:26)    start_thread (/lib/tls/i686/cmov/libpthread-2.7.so)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*     fun:_Z28AutoFillProfileFromStatementRKN3sql9StatementE     fun:_ZN11WebDatabase19GetAutoFillProfilesEPSt6vectorIP15AutoFillProfileSaIS2_EE     fun:_ZN14WebDataService23GetAutoFillProfilesImplEPNS_14WebDataRequestE     fun:_Z16DispatchToMethodI14WebDataServiceMS0_FvPNS0_14WebDataRequestEES2_EvPT_T0_RK6Tuple1IT1_E     fun:_ZN14RunnableMethodI14WebDataServiceMS0_FvPNS0_14WebDataRequestEE6Tuple1IS2_EE3RunEv     fun:_ZN11MessageLoop7RunTaskEP4Task     fun:_ZN11MessageLoop21DeferOrRunPendingTaskERKNS_11PendingTaskE     fun:_ZN11MessageLoop6DoWorkEv     fun:_ZN4base18MessagePumpDefault3RunEPNS_11MessagePump8DelegateE     fun:_ZN11MessageLoop11RunInternalEv     fun:_ZN11MessageLoop10RunHandlerEv  }    01:33:43 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/unit_tests --gtest_filter=-  VisitedLinkEventsTest.Coalescense:VisitedLinkRelayTest.Basics:RenderViewTest.ImeComposition:DnsMasterTest.MassiveConcurrentLookupTest:URLFetcherBadHTTPSTest.BadHTTPSTest --  gtest_print_time  984 (24 direct  960 indirect) bytes in 1 blocks are definitely lost in loss record 18 529 of 18 956    operator new(unsigned int) (mp/vg_bins/scripts/valgrind-memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:269)    __gnu_cxx::new_allocator&lt;std::_Rb_tree_node&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;::allocate(unsigned int  void const*)   (sr/include/c++/4.2/ext/new_allocator.h:91)    std::_Rb_tree&lt;AutoFillType::FieldTypeGroup  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;  std::_Select1st&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;   &gt;  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;::_M_get_node() (sr/include/c++/4.2/bits/stl_tree.h:367)    std::_Rb_tree&lt;AutoFillType::FieldTypeGroup  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;  std::_Select1st&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;   &gt;  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;::_M_create_node(std::pair&lt;AutoFillType::FieldTypeGroup   const  FormGroup*&gt; const&amp;) (sr/include/c++/4.2/bits/stl_tree.h:376)    std::_Rb_tree&lt;AutoFillType::FieldTypeGroup  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;  std::_Select1st&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;   &gt;  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;::_M_insert(std::_Rb_tree_node_base*    std::_Rb_tree_node_base*  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; const&amp;) (sr/include/c++/4.2/bits/stl_tree.h:838)    std::_Rb_tree&lt;AutoFillType::FieldTypeGroup  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;  std::_Select1st&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt;   &gt;  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt;   &gt;::_M_insert_unique(std::_Rb_tree_iterator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt;  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; const&amp;)   (sr/include/c++/4.2/bits/stl_tree.h:1021)    std::map&lt;AutoFillType::FieldTypeGroup  FormGroup*  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt;   &gt;::insert(std::_Rb_tree_iterator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt;  std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; const&amp;)   (sr/include/c++/4.2/bits/stl_map.h:427)    std::map&lt;AutoFillType::FieldTypeGroup  FormGroup*  std::less&lt;AutoFillType::FieldTypeGroup&gt;  std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt;   &gt;::operator[](AutoFillType::FieldTypeGroup const&amp;) (sr/include/c++/4.2/bits/stl_map.h:350)    (anonymous namespace)::InitPersonalInfo(std::map&lt;AutoFillType::FieldTypeGroup  FormGroup*  std::less&lt;AutoFillType::FieldTypeGroup&gt;    std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;*) (uilder/build/src/chrome/browser/autofill/autofill_profile.cc:27)    AutoFillProfile::AutoFillProfile(std::basic_string&lt;unsigned short  base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;  int)   (uilder/build/src/chrome/browser/autofill/autofill_profile.cc:37)    AutoFillProfileFromStatement(sql::Statement const&amp;) (uilder/build/src/chrome/browser/webdata/web_database.cc:1434)    WebDatabase::GetAutoFillProfiles(std::vector&lt;AutoFillProfile*  std::allocator&lt;AutoFillProfile*&gt; &gt;*) (uilder/build/src/chrome/browser/webdata/web_database.cc:1497)    WebDataService::GetAutoFillProfilesImpl(WebDataService::WebDataRequest*) (uilder/build/src/chrome/browser/webdata/web_data_service.cc:861)    void DispatchToMethod&lt;WebDataService  void (WebDataService::*)(WebDataService::WebDataRequest*)  WebDataService::WebDataRequest*&gt;(WebDataService*  void   (WebDataService::*)(WebDataService::WebDataRequest*)  Tuple1&lt;WebDataService::WebDataRequest*&gt; const&amp;) (uilder/build/src/./base/tuple.h:422)    RunnableMethod&lt;WebDataService  void (WebDataService::*)(WebDataService::WebDataRequest*)  Tuple1&lt;WebDataService::WebDataRequest*&gt; &gt;::Run() (uilder/build/src/./base/task.h:296)    MessageLoop::RunTask(Task*) (uilder/build/src/base/message_loop.cc:328)    MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;) (uilder/build/src/base/message_loop.cc:336)    MessageLoop::DoWork() (uilder/build/src/base/message_loop.cc:443)    base::MessagePumpDefault::Run(base::MessagePump::Delegate*) (uilder/build/src/base/message_pump_default.cc:23)    MessageLoop::RunInternal() (uilder/build/src/base/message_loop.cc:204)    MessageLoop::RunHandler() (uilder/build/src/base/message_loop.cc:176)    MessageLoop::Run() (uilder/build/src/base/message_loop.cc:154)    base::Thread::Run(MessageLoop*) (uilder/build/src/base/thread.cc:133)    base::Thread::ThreadMain() (uilder/build/src/base/thread.cc:156)    ThreadFunc(void*) (uilder/build/src/base/platform_thread_posix.cc:26)    start_thread (/lib/tls/i686/cmov/libpthread-2.7.so)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*     fun:_ZN9__gnu_cxx13new_allocatorISt13_Rb_tree_nodeISt4pairIKN12AutoFillType14FieldTypeGroupEP9FormGroupEEE8allocateEjPKv     fun:_ZNSt8_Rb_treeIN12AutoFillType14FieldTypeGroupESt4pairIKS1_P9FormGroupESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE11_M_get_nodeEv     fun:_ZNSt8_Rb_treeIN12AutoFillType14FieldTypeGroupESt4pairIKS1_P9FormGroupESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE14_M_create_nodeERKS6_     fun:_ZNSt8_Rb_treeIN12AutoFillType14FieldTypeGroupESt4pairIKS1_P9FormGroupESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE9_M_insertEPSt18_Rb_tree_node_baseSE_RKS6_     fun:_ZNSt8_Rb_treeIN12AutoFillType14FieldTypeGroupESt4pairIKS1_P9FormGroupESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE16_M_insert_uniqueESt17_Rb_tree_iteratorIS6_ERKS6_     fun:_ZNSt3mapIN12AutoFillType14FieldTypeGroupEP9FormGroupSt4lessIS1_ESaISt4pairIKS1_S3_EEE6insertESt17_Rb_tree_iteratorIS8_ERKS8_     fun:_ZNSt3mapIN12AutoFillType14FieldTypeGroupEP9FormGroupSt4lessIS1_ESaISt4pairIKS1_S3_EEEixERS7_       fun:_ZN72_GLOBAL__N_chrome_browser_autofill_autofill_profile.cc_00000000_DBC6D82516InitPersonalInfoEPSt3mapIN12AutoFillType14FieldTypeGroupEP9FormGroupSt4lessIS2_ESaISt4pairIKS2_S  4_EEE     fun:_ZN15AutoFillProfileC1ERKSbItN4base20string16_char_traitsESaItEEi     fun:_Z28AutoFillProfileFromStatementRKN3sql9StatementE     fun:_ZN11WebDatabase19GetAutoFillProfilesEPSt6vectorIP15AutoFillProfileSaIS2_EE     fun:_ZN14WebDataService23GetAutoFillProfilesImplEPNS_14WebDataRequestE     fun:_Z16DispatchToMethodI14WebDataServiceMS0_FvPNS0_14WebDataRequestEES2_EvPT_T0_RK6Tuple1IT1_E     fun:_ZN14RunnableMethodI14WebDataServiceMS0_FvPNS0_14WebDataRequestEE6Tuple1IS2_EE3RunEv     fun:_ZN11MessageLoop7RunTaskEP4Task     fun:_ZN11MessageLoop21DeferOrRunPendingTaskERKNS_11PendingTaskE     fun:_ZN11MessageLoop6DoWorkEv     fun:_ZN4base18MessagePumpDefault3RunEPNS_11MessagePump8DelegateE     fun:_ZN11MessageLoop11RunInternalEv     fun:_ZN11MessageLoop10RunHandlerEv  }    01:33:43 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/unit_tests --gtest_filter=-  VisitedLinkEventsTest.Coalescense:VisitedLinkRelayTest.Basics:RenderViewTest.ImeComposition:DnsMasterTest.MassiveConcurrentLookupTest:URLFetcherBadHTTPSTest.BadHTTPSTest --  gtest_print_time  40 bytes in 2 blocks are definitely lost in loss record 14 760 of 18 956    operator new(unsigned int) (mp/vg_bins/scripts/valgrind-memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:269)    (anonymous namespace)::InitPersonalInfo(std::map&lt;AutoFillType::FieldTypeGroup  FormGroup*  std::less&lt;AutoFillType::FieldTypeGroup&gt;    std::allocator&lt;std::pair&lt;AutoFillType::FieldTypeGroup const  FormGroup*&gt; &gt; &gt;*) (uilder/build/src/chrome/browser/autofill/autofill_profile.cc:25)    AutoFillProfile::AutoFillProfile() (uilder/build/src/chrome/browser/autofill/autofill_profile.cc:43)    AutoFillProfile::Clone() const (uilder/build/src/chrome/browser/autofill/autofill_profile.cc:110)    browser_sync::AutofillChangeProcessor::ObserveAutofillProfileChanged(AutofillProfileChange*  sync_api::WriteTransaction*  sync_api::ReadNode const&amp;)   (uilder/build/src/chrome/browser/sync/glue/autofill_change_processor.cc:136)    browser_sync::AutofillChangeProcessor::Observe(NotificationType  NotificationSource const&amp;  NotificationDetails const&amp;)   (uilder/build/src/chrome/browser/sync/glue/autofill_change_processor.cc:71)    NotificationService::Notify(NotificationType  NotificationSource const&amp;  NotificationDetails const&amp;) (uilder/build/src/chrome/common/notification_service.cc:119)    ThreadNotifier::NotifyTask(NotificationType  NotificationDetails const&amp;) (uilder/build/src/./chrome/browser/sync/profile_sync_test_util.h:212)    void DispatchToMethod&lt;ThreadNotifier  void (ThreadNotifier::*)(NotificationType  NotificationDetails const&amp;)  NotificationType  NotificationDetails&gt;(ThreadNotifier*  void   (ThreadNotifier::*)(NotificationType  NotificationDetails const&amp;)  Tuple2&lt;NotificationType  NotificationDetails&gt; const&amp;) (uilder/build/src/./base/tuple.h:429)    RunnableMethod&lt;ThreadNotifier  void (ThreadNotifier::*)(NotificationType  NotificationDetails const&amp;)  Tuple2&lt;NotificationType  NotificationDetails&gt; &gt;::Run()   (uilder/build/src/./base/task.h:296)    MessageLoop::RunTask(Task*) (uilder/build/src/base/message_loop.cc:328)    MessageLoop::DeferOrRunPendingTask(MessageLoop::PendingTask const&amp;) (uilder/build/src/base/message_loop.cc:336)    MessageLoop::DoWork() (uilder/build/src/base/message_loop.cc:443)    base::MessagePumpDefault::Run(base::MessagePump::Delegate*) (uilder/build/src/base/message_pump_default.cc:23)    MessageLoop::RunInternal() (uilder/build/src/base/message_loop.cc:204)    MessageLoop::RunHandler() (uilder/build/src/base/message_loop.cc:176)    MessageLoop::Run() (uilder/build/src/base/message_loop.cc:154)    base::Thread::Run(MessageLoop*) (uilder/build/src/base/thread.cc:133)    base::Thread::ThreadMain() (uilder/build/src/base/thread.cc:156)    ThreadFunc(void*) (uilder/build/src/base/platform_thread_posix.cc:26)    start_thread (/lib/tls/i686/cmov/libpthread-2.7.so)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*       fun:_ZN72_GLOBAL__N_chrome_browser_autofill_autofill_profile.cc_00000000_DBC6D82516InitPersonalInfoEPSt3mapIN12AutoFillType14FieldTypeGroupEP9FormGroupSt4lessIS2_ESaISt4pairIKS2_S  4_EEE     fun:_ZN15AutoFillProfileC1Ev     fun:_ZNK15AutoFillProfile5CloneEv     fun:_ZN12browser_sync23AutofillChangeProcessor29ObserveAutofillProfileChangedEP21AutofillProfileChangePN8sync_api16WriteTransactionERKNS3_8ReadNodeE     fun:_ZN12browser_sync23AutofillChangeProcessor7ObserveE16NotificationTypeRK18NotificationSourceRK19NotificationDetails     fun:_ZN19NotificationService6NotifyE16NotificationTypeRK18NotificationSourceRK19NotificationDetails     fun:_ZN14ThreadNotifier10NotifyTaskE16NotificationTypeRK19NotificationDetails     fun:_Z16DispatchToMethodI14ThreadNotifierMS0_Fv16NotificationTypeRK19NotificationDetailsES1_S2_EvPT_T0_RK6Tuple2IT1_T2_E     fun:_ZN14RunnableMethodI14ThreadNotifierMS0_Fv16NotificationTypeRK19NotificationDetailsE6Tuple2IS1_S2_EE3RunEv     fun:_ZN11MessageLoop7RunTaskEP4Task     fun:_ZN11MessageLoop21DeferOrRunPendingTaskERKNS_11PendingTaskE     fun:_ZN11MessageLoop6DoWorkEv     fun:_ZN4base18MessagePumpDefault3RunEPNS_11MessagePump8DelegateE     fun:_ZN11MessageLoop11RunInternalEv     fun:_ZN11MessageLoop10RunHandlerEv  }                     </pre>