<title>Issue 40660 -   chromium -    WebKit::WebGeolocationServiceBridgeImpl::stopUpdating ReadAV@NULL (b086689a591c290b8c69048bdde1877c) - Project Hosting on Google Code</title> <pre> The following code causes a NULL ptr deref in Chromium latest:  &lt;SCRIPT&gt;    o=window.open();    o.navigator.geolocation.watchPosition(function(){});    o.close();    deleteï¿½_o;  &lt;/SCRIPT&gt;  (repro and details attached).    Relevant code section:  view-source:<a href="http://svn.webkit.org/repository/webkit/trunk/WebKit/chromium/src/WebGeolocationServiceBridgeImpl.cpp">http://svn.webkit.org/repository/webkit/trunk/WebKit/chromium/src/WebGeolocationServiceBridgeImpl.cpp</a>  line 120:  bool WebGeolocationServiceBridgeImpl::startUpdating(PositionOptions* positionOptions)  {      if (!m_bridgeId)          m_bridgeId = getWebViewClient()-&gt;geolocationService()-&gt;attachBridge(this); // KaB00m!!      getWebViewClient()-&gt;geolocationService()-&gt;startUpdating(m_bridgeId  m_GeolocationServiceChromium-&gt;frame()-&gt;document()-&gt;url()  positionOptions-&gt;enableHighAccuracy());      return true;  }    Speculation:  we set up a &quot;watchPosition&quot; callback and then close the window in which it was set-up. When the &quot;watchPosition&quot; code tries to do it's thing  getWebViewClient() will return NULL  which is not handled gracefully.    * Adding non-existing &quot;Feature-Geolocation&quot; - should we create such a label?  * Adding Ben laurie - iirc correctly  you know a bit about this part of the code. </pre>