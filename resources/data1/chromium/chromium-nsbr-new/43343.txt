<title>Issue 43343 -   chromium -    ChromeFrame: Crash in npchrome_frame!DllRedirector::GetOldestNamedModuleHandle - Project Hosting on Google Code</title> <pre> Looks like BitDefender is hooking Module32Next and crashing while we scan   for older modules:    Crashing stack:    0:000&gt; kv  ChildEBP RetAddr  Args to Child                0015d124 756f0962 00000002 0015d174 00000001   ntdll!NtWaitForMultipleObjects+0x15 (FPO: [5 0 0])  0015d1c0 75c3162d 0015d174 0015d1e8 00000000   KERNELBASE!WaitForMultipleObjectsEx+0x100 (FPO: [Non-Fpo])  0015d208 75c31921 00000002 7efde000 00000000   kernel32!WaitForMultipleObjectsExImplementation+0xe0 (FPO: [Non-Fpo])  0015d224 6aab3676 00000002 0015d23c 00000000   kernel32!WaitForMultipleObjects+0x18 (FPO: [Non-Fpo])  0015d244 6aab35e1 04cbe940 6aab2fb3 0015d3ec   npchrome_frame!google_breakpad::CrashGenerationClient::SignalCrashEventAndW  ait+0x42 (CONV: thiscall) [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowscrash_generationcrash_gener  ation_client.cc @ 334]  0015d24c 6aab2fb3 0015d3ec 00000000 0015d298   npchrome_frame!google_breakpad::CrashGenerationClient::RequestDump+0x44   (FPO: [1 0 1]) (CONV: thiscall) [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowscrash_generationcrash_gener  ation_client.cc @ 288]  0015d29c 6aab2f59 00001830 0015d3ec 00000000   npchrome_frame!google_breakpad::ExceptionHandler::WriteMinidumpWithExceptio  n+0x3d (CONV: thiscall) [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowshandlerexception_handler.cc   @ 675]  0015d2b4 6aab13ba 0015d3ec 6aab1399 00000028   npchrome_frame!google_breakpad::ExceptionHandler::WriteMinidumpForException  +0x22 (FPO: [1 0 2]) (CONV: thiscall) [c:bslavechrome-  officialbuildsrcbreakpadsrcclientwindowshandlerexception_handler.cc   @ 638]  0015d2c4 6aad8751 0015d3ec 004d7648 77b14724   npchrome_frame!WriteMinidumpForException+0x21 (FPO: [1 0 2]) (CONV: cdecl)   [c:bslavechrome-  officialbuildsrcchrome_framecrash_reportingcrash_report.cc @ 177]  0015d3d4 77a8329f 0015d3ec 60031420 0015d4a4   npchrome_frame!CrashHandler::VectoredHandlerEntryPoint+0x108 (CONV:   stdcall) [c:bslavechrome-  officialbuildsrcchrome_framecrash_reportingcrash_report.cc @ 73]  0015d400 77a689b2 004d7648 00000000 00000000   ntdll!RtlpCallVectoredHandlers+0x7a (FPO: [Non-Fpo])  0015d414 77a68674 0015d4a4 0015d4f4 60031424   ntdll!RtlCallVectoredExceptionHandlers+0x12 (FPO: [Non-Fpo])  0015d48c 77a2010f 0015d4a4 0015d4f4 0015d4a4   ntdll!RtlDispatchException+0x19 (FPO: [Non-Fpo])  0015d48c 77a32272 0015d4a4 0015d4f4 0015d4a4   ntdll!KiUserExceptionDispatcher+0xf (FPO: [2 0 0]) (CONTEXT @ 0015d4f4)  *** WARNING: Unable to verify timestamp for midas32.dll  *** ERROR: Module load completed but symbols could not be loaded for   midas32.dll  0015d7f0 600102be 60031420 bb553e76 604037d8   ntdll!RtlEnterCriticalSection+0x12 (FPO: [Non-Fpo])  WARNING: Stack unwind information not available. Following frames may be   wrong.  0015d838 600238d7 0015d8e8 0015d8b4 00000860 midas32+0x102be  0015d878 60008a1d 60010250 0015d8b4 0015d8f0 midas32+0x238d7  0015d8d4 60023875 604037d8 0015d8f0 0015d8e8 midas32+0x8a1d  0015d914 75c59f45 604037d8 75c59f45 00000860 midas32+0x23875  0015d960 6aa71e16 00000860 00c00000 00000000 kernel32!Module32NextW+0x45   (FPO: [Non-Fpo])  0015de84 6aa71ce5 0015dea0 0015e614 6ab4fd6c   npchrome_frame!DllRedirector::GetOldestNamedModuleHandle+0xd0 (CONV:   thiscall) [c:bslavechrome-  officialbuildsrcchrome_framemodule_utils.cc @ 88]  0015df4c 6aa38ca7 0015e614 00448d00 0015df78   npchrome_frame!DllRedirector::GetDllGetClassObjectFromModuleName+0x31   (CONV: thiscall) [c:bslavechrome-  officialbuildsrcchrome_framemodule_utils.cc @ 46]  0015df5c 75894f02 004491bc 758942c4 0015e004   npchrome_frame!DllGetClassObject+0x26 (CONV: stdcall) [c:bslavechrome-  officialbuildsrcchrome_framechrome_tab.cc @ 334]  0015df78 75869c08 004491bc 758942c4 0015e004   ole32!CClassCache::CDllPathEntry::DllGetClassObject+0x30 (FPO: [Non-Fpo])  0015df90 75869b55 0015dfa4 758942c4 0015e004   ole32!CClassCache::CDllFnPtrMoniker::BindToObjectNoSwitch+0x1f (FPO: [Non-  Fpo])  0015dfc8 7586af09 0015e00c 00000000 0015e614   ole32!CClassCache::GetClassObject+0x49 (FPO: [Non-Fpo])  0015e044 7588554a 75986444 00000000 0015e614   ole32!CServerContextActivator::CreateInstance+0x110 (FPO: [Non-Fpo])  0015e084 7586b07c 0015e614 00000000 0015eb80   ole32!ActivationPropertiesIn::DelegateCreateInstance+0x108 (FPO: [Non-Fpo])  0015e0d8 7586aff1 7598646c 00000000 0015e614   ole32!CApartmentActivator::CreateInstance+0x112 (FPO: [Non-Fpo])  0015e0f8 7586ae16 75986494 00000001 00000000   ole32!CProcessActivator::CCICallback+0x6d (FPO: [Non-Fpo])  0015e118 7586adc7 75986494 0015e470 00000000   ole32!CProcessActivator::AttemptActivation+0x2c (FPO: [Non-Fpo])  0015e154 7586b0df 75986494 0015e470 00000000   ole32!CProcessActivator::ActivateByContext+0x4f (FPO: [Non-Fpo])  0015e17c 7588554a 75986494 00000000 0015e614   ole32!CProcessActivator::CreateInstance+0x49 (FPO: [Non-Fpo])  0015e1bc 758852ce 0015e614 00000000 0015eb80   ole32!ActivationPropertiesIn::DelegateCreateInstance+0x108 (FPO: [Non-Fpo])  0015e41c 7588554a 75986448 00000000 0015e614   ole32!CClientContextActivator::CreateInstance+0xb0 (FPO: [Non-Fpo])  0015e45c 75885472 0015e614 00000000 0015eb80   ole32!ActivationPropertiesIn::DelegateCreateInstance+0x108 (FPO: [Non-Fpo])  0015ec34 75895916 0015ed20 00000000 00000001   ole32!ICoCreateInstanceEx+0x404 (FPO: [Non-Fpo])  0015ec94 75895877 0015ed20 00000000 00000001   ole32!CComActivator::DoCreateInstance+0xd9 (FPO: [Non-Fpo])  0015ecb8 75895830 0015ed20 00000000 00000001 ole32!CoCreateInstanceEx+0x38   (FPO: [Non-Fpo])  0015ece8 68be6b40 0015ed20 00000000 00000001 ole32!CoCreateInstance+0x37   (FPO: [Non-Fpo])  0015ed34 68be81c9 000029fb 00000001 00002000 inetcpl!ClearAddOnData+0x93   (FPO: [Non-Fpo])  0015ef58 68be8227 000029fb 68bd0000 000029fb   inetcpl!ClearTracksWithoutUI+0x1fa (FPO: [Non-Fpo])  0015f9bc 68be9041 00070574 000029fb 68bd0000 inetcpl!ClearTracks+0x49 (FPO:   [Non-Fpo])  0015f9dc 007e137d 00070574 007e0000 0042c476   inetcpl!ClearMyTracksByProcessW+0x8a (FPO: [Non-Fpo])  0015fa54 007e1326 68be8fb7 00070574 007e0000   rundll32!CallRunDllFunction+0x22 (FPO: [5 0 0])  0015faa0 007e1901 0042c408 00000000 0042c476 rundll32!wWinMain+0x122 (FPO:   [Non-Fpo])  0015fb34 75c33677 7efde000 0015fb80 77a49d72 rundll32!_initterm_e+0x1b1   (FPO: [Non-Fpo])  0015fb40 77a49d72 7efde000 77f0491b 00000000   kernel32!BaseThreadInitThunk+0xe (FPO: [Non-Fpo])  0015fb80 77a49d45 007e178c 7efde000 00000000   ntdll!__RtlUserThreadStart+0x70 (FPO: [Non-Fpo])  0015fb98 00000000 007e178c 7efde000 00000000 ntdll!_RtlUserThreadStart+0x1b   (FPO: [Non-Fpo])   </pre>