<title>Issue 34115 -   chromium -    Debug crash on ChromeURLDataManager - Project Hosting on Google Code</title> <pre> I'm running a Linux debug build of chromium built at <a href="/p/chromium/source/detail?r=37712">r37712</a>.    [29161:29172:272193304944:FATAL:base/cancellation_flag.cc(13)] Check   failed: set_on_ == PlatformThread::CurrentId().    Program received signal SIGTRAP  Trace/breakpoint trap.  [Switching to Thread 0x43005950 (LWP 29172)]  DebugUtil::BreakDebugger () at base/debug_util_posix.cc:240  240     }  (gdb) ba  #0  DebugUtil::BreakDebugger () at base/debug_util_posix.cc:240  #1  0x0000000000bcf8a2 in ~LogMessage (this=0x43004010  __in_chrg=&lt;value   optimized out&gt;) at base/logging.cc:565  #2  0x0000000000bba8ff in base::CancellationFlag::Set (this=0x7fffe80a190c)   at base/cancellation_flag.cc:13  #3  0x00000000008283f3 in CancelableRequestBase::set_canceled   (this=0x7fffe80a18e0) at ./chrome/browser/cancelable_request.h:385  #4  0x0000000000827446 in CancelableRequestProvider::CancelRequestLocked   (this=0x4a47370  handle=371) at chrome/browser/cancelable_request.cc:52  #5  0x0000000000827490 in CancelableRequestProvider::CancelRequest   (this=0x4a47370  handle=371) at chrome/browser/cancelable_request.cc:41  #6  0x00000000004ccac1 in   CancelableRequestConsumerTSimple&lt;int&gt;::CancelAllRequests   (this=0x7fffe846bd60) at ./chrome/browser/cancelable_request.h:243  #7  0x00000000004ccbab in ~CancelableRequestConsumerTSimple   (this=0x7fffe846bd60  __in_chrg=&lt;value optimized out&gt;) at   ./chrome/browser/cancelable_request.h:204  #8  0x00000000004ccc2d in ~CancelableRequestConsumerT (this=0x7fffe846bd60    __in_chrg=&lt;value optimized out&gt;) at   ./chrome/browser/cancelable_request.h:307  #9  0x0000000000a26b3c in ~DOMUIThumbnailSource (this=0x7fffe846bd30    __in_chrg=&lt;value optimized out&gt;) at   ./chrome/browser/dom_ui/dom_ui_thumbnail_source.h:45  #10 0x0000000000467273 in   base::RefCountedThreadSafe&lt;ChromeURLDataManager::DataSource    base::DefaultRefCountedThreadSafeTraits&lt;ChromeURLDataManager::DataSource&gt;   &gt;::DeleteInternal (x=0x7fffe846bd30)      at ./base/ref_counted.h:146  #11 0x000000000046728b in   base::DefaultRefCountedThreadSafeTraits&lt;ChromeURLDataManager::DataSource&gt;::  Destruct (x=0x7fffe846bd30) at ./base/ref_counted.h:112  #12 0x000000000046804c in   base::RefCountedThreadSafe&lt;ChromeURLDataManager::DataSource    base::DefaultRefCountedThreadSafeTraits&lt;ChromeURLDataManager::DataSource&gt;   &gt;::Release (this=0x7fffe846bd38)      at ./base/ref_counted.h:140  #13 0x00000000004682e2 in   scoped_refptr&lt;ChromeURLDataManager::DataSource&gt;::operator= (this=0x4fd0998    p=0x7fffe85c7e10) at ./base/ref_counted.h:261  #14 0x0000000000468314 in   scoped_refptr&lt;ChromeURLDataManager::DataSource&gt;::operator= (this=0x4fd0998    r=...) at ./base/ref_counted.h:267  #15 0x0000000000464945 in ChromeURLDataManager::AddDataSource   (this=0x7fffe8003200  source=...) at   chrome/browser/dom_ui/chrome_url_data_manager.cc:181  #16 0x0000000000853930 in DispatchToMethod&lt;ChromeURLDataManager  void   (ChromeURLDataManager::*)(scoped_refptr&lt;ChromeURLDataManager::DataSource&gt;)    scoped_refptr&lt;DOMUIThumbnailSource&gt; &gt; (      obj=0x7fffe8003200  method=0x464908   &lt;ChromeURLDataManager::AddDataSource(scoped_refptr&lt;ChromeURLDataManager::Da  taSource&gt;)&gt;  arg=...) at ./base/tuple.h:422  #17 0x0000000000853976 in RunnableMethod&lt;ChromeURLDataManager  void   (ChromeURLDataManager::*)(scoped_refptr&lt;ChromeURLDataManager::DataSource&gt;)    Tuple1&lt;scoped_refptr&lt;DOMUIThumbnailSource&gt; &gt; &gt;::Run (      this=0x7fffe80c7930) at ./base/task.h:289  #18 0x0000000000bd0d8f in MessageLoop::RunTask (this=0x43004f50    task=0x7fffe80c7930) at base/message_loop.cc:320  #19 0x0000000000bd14ac in MessageLoop::DeferOrRunPendingTask   (this=0x43004f50  pending_task=...) at base/message_loop.cc:328  #20 0x0000000000bd16fc in MessageLoop::DoWork (this=0x43004f50) at   base/message_loop.cc:435  #21 0x0000000000baa498 in base::MessagePumpLibevent::Run (this=0x466f7e0    delegate=0x43004f50) at base/message_pump_libevent.cc:241  #22 0x0000000000bd1c5d in MessageLoop::RunInternal (this=0x43004f50) at   base/message_loop.cc:205  #23 0x0000000000bd1c7d in MessageLoop::RunHandler (this=0x43004f50) at   base/message_loop.cc:177  #24 0x0000000000bd1d22 in MessageLoop::Run (this=0x43004f50) at   base/message_loop.cc:155  #25 0x0000000000bfb62d in base::Thread::Run (this=0x466d1c0    message_loop=0x43004f50) at base/thread.cc:133  #26 0x0000000000bfba1f in base::Thread::ThreadMain (this=0x466d1c0) at   base/thread.cc:155  #27 0x0000000000be29a0 in ThreadFunc (closure=0x466d1c0) at   base/platform_thread_posix.cc:26  #28 0x00007ffff44763f7 in start_thread () from /lib/libpthread.so.0  #29 0x00007ffff25f2b4d in clone () from /lib/libc.so.6  #30 0x0000000000000000 in ?? ()    I'm guessing it's the IO thread based on the thread number:  (gdb) info threads    148 Thread 0x48138950 (LWP 15641)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    147 Thread 0x440ee950 (LWP 15227)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    146 Thread 0x4406a950 (LWP 15226)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    145 Thread 0x440cd950 (LWP 14078)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    38 Thread 0x480f6950 (LWP 29250)  0x00007ffff25ebdc2 in select () from   /lib/libc.so.6    24 Thread 0x470f4950 (LWP 29196)  0x00007ffff447d5cb in read () from   /lib/libpthread.so.0    23 Thread 0x468f3950 (LWP 29192)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    22 Thread 0x460f2950 (LWP 29191)  0x00007ffff447ab99 in   pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    21 Thread 0x458f1950 (LWP 29190)  0x00007ffff25ebdc2 in select () from   /lib/libc.so.6    20 Thread 0x450f0950 (LWP 29189)  0x00007ffff25ebdc2 in select () from   /lib/libc.so.6    17 Thread 0x448ef950 (LWP 29182)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    9 Thread 0x44007950 (LWP 29174)  0x00007ffff447ab99 in   pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    8 Thread 0x43806950 (LWP 29173)  0x00007ffff447ab99 in   pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0  * 7 Thread 0x43005950 (LWP 29172)  DebugUtil::BreakDebugger () at   base/debug_util_posix.cc:240    6 Thread 0x42804950 (LWP 29171)  0x00007ffff447ab99 in   pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    5 Thread 0x42003950 (LWP 29170)  0x00007ffff447ab99 in   pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    4 Thread 0x41802950 (LWP 29169)  0x00007ffff25ef739 in syscall () from   /lib/libc.so.6    3 Thread 0x41001950 (LWP 29168)  0x00007ffff447ae1d in   pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/libpthread.so.0    2 Thread 0x40800950 (LWP 29167)  0x00007ffff447d5cb in read () from   /lib/libpthread.so.0    1 Thread 0x7ffff7fbf6f0 (LWP 29161)  0x00007ffff5d25c51 in   g_value_object_collect_value (value=0x7fffffff71e0  n_collect_values=1    collect_values=0x7fffffff7120  collect_flags=0)      at /tmp/glib2.0.f24606/glib2.0-2.16.6/gobject/gobject.c:1947   </pre>