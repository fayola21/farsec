<title>Issue 37727 -   chromium -    leak in webkit image decoder tests - Project Hosting on Google Code</title> <pre> <a href="http://build.chromium.org/buildbot/memory/builders/Webkit%20Linux%20(valgrind)/builds/11085/steps/valgrind%20test:%20test_shell/log">http://build.chromium.org/buildbot/memory/builders/Webkit%20Linux%20(valgrind)/builds/11085/steps/valgrind%20test:%20test_shell/log</a>  s/stdio      15:07:44 memcheck_analyze.py [ERROR] FAIL! There were 3 errors:   15:07:44 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/test_shell_tests --gtest_filter=-  BMPImageDecoderTest.ChunkedDecodingSlow:BMPImageDecoderTest.DecodingSlow:MediaLeakTest.VideoBear:MediaLeakTest.ManyVideoBear:WebFra  meTest.GetFullHtmlOfPage --gtest_print_time  1 164 (92 direct  1 072 indirect) bytes in 1 blocks are definitely lost in loss record 8 085 of 8 280    operator new(unsigned int) (mp/vg-chr/scripts/valgrind-source/coregrind/m_replacemalloc/vg_replace_malloc.c:228)    WebCore::RGBA32Buffer::asNewNativeImage() const (third_party/WebKit/WebCore/platform/image-decoders/skia/ImageDecoderSkia.cpp:97)    WebKit::WebImageDecoder::getFrameAtIndex(int) const (third_party/WebKit/WebKit/chromium/src/WebImageDecoder.cpp:109)    VerifyImage(WebKit::WebImageDecoder const&amp;  FilePath const&amp;  FilePath const&amp;  unsigned int)   (webkit/tools/test_shell/image_decoder_unittest.cc:85)    ImageDecoderTest::TestWebKitImageDecoder(FilePath const&amp;  FilePath const&amp;  int) const   (webkit/tools/test_shell/image_decoder_unittest.cc:215)    ICOImageDecoderTest_ImageNonZeroFrameIndex_Test::TestBody() (webkit/tools/webcore_unit_tests/ICOImageDecoder_unittest.cpp:60)    testing::Test::Run() (testing/gtest/src/gtest.cc:2085)    testing::internal::TestInfoImpl::Run() (testing/gtest/src/gtest.cc:2304)    testing::TestCase::Run() (testing/gtest/src/gtest.cc:2412)    testing::internal::UnitTestImpl::RunAllTests() (testing/gtest/src/gtest.cc:4013)    testing::UnitTest::Run() (testing/gtest/src/gtest.cc:3680)    main (webkit/tools/test_shell/run_all_tests.cc:98)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*     fun:_ZNK7WebCore12RGBA32Buffer16asNewNativeImageEv     fun:_ZNK6WebKit15WebImageDecoder15getFrameAtIndexEi     fun:_Z11VerifyImageRKN6WebKit15WebImageDecoderERK8FilePathS5_j     fun:_ZNK16ImageDecoderTest22TestWebKitImageDecoderERK8FilePathS2_i     fun:_ZN47ICOImageDecoderTest_ImageNonZeroFrameIndex_Test8TestBodyEv     fun:_ZN7testing4Test3RunEv     fun:_ZN7testing8internal12TestInfoImpl3RunEv     fun:_ZN7testing8TestCase3RunEv     fun:_ZN7testing8internal12UnitTestImpl11RunAllTestsEv     fun:_ZN7testing8UnitTest3RunEv     fun:main  }      15:07:44 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/test_shell_tests --gtest_filter=-  BMPImageDecoderTest.ChunkedDecodingSlow:BMPImageDecoderTest.DecodingSlow:MediaLeakTest.VideoBear:MediaLeakTest.ManyVideoBear:WebFra  meTest.GetFullHtmlOfPage --gtest_print_time  545 008 (2 944 direct  542 064 indirect) bytes in 32 blocks are definitely lost in loss record 8 279 of 8 280    operator new(unsigned int) (mp/vg-chr/scripts/valgrind-source/coregrind/m_replacemalloc/vg_replace_malloc.c:228)    WebCore::RGBA32Buffer::asNewNativeImage() const (third_party/WebKit/WebCore/platform/image-decoders/skia/ImageDecoderSkia.cpp:97)    WebKit::WebImageDecoder::getFrameAtIndex(int) const (third_party/WebKit/WebKit/chromium/src/WebImageDecoder.cpp:109)    VerifyImage(WebKit::WebImageDecoder const&amp;  FilePath const&amp;  FilePath const&amp;  unsigned int)   (webkit/tools/test_shell/image_decoder_unittest.cc:85)    ImageDecoderTest::TestWebKitImageDecoder(FilePath const&amp;  FilePath const&amp;  int) const   (webkit/tools/test_shell/image_decoder_unittest.cc:215)    ImageDecoderTest::TestDecoding(ImageDecoderTestFileSelection  long long) (webkit/tools/test_shell/image_decoder_unittest.cc:156)    BMPImageDecoderTest_DecodingFast_Test::TestBody() (webkit/tools/webcore_unit_tests/BMPImageDecoder_unittest.cpp:51)    testing::Test::Run() (testing/gtest/src/gtest.cc:2085)    testing::internal::TestInfoImpl::Run() (testing/gtest/src/gtest.cc:2304)    testing::TestCase::Run() (testing/gtest/src/gtest.cc:2412)    testing::internal::UnitTestImpl::RunAllTests() (testing/gtest/src/gtest.cc:4013)    testing::UnitTest::Run() (testing/gtest/src/gtest.cc:3680)    main (webkit/tools/test_shell/run_all_tests.cc:98)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*     fun:_ZNK7WebCore12RGBA32Buffer16asNewNativeImageEv     fun:_ZNK6WebKit15WebImageDecoder15getFrameAtIndexEi     fun:_Z11VerifyImageRKN6WebKit15WebImageDecoderERK8FilePathS5_j     fun:_ZNK16ImageDecoderTest22TestWebKitImageDecoderERK8FilePathS2_i     fun:_ZN16ImageDecoderTest12TestDecodingE29ImageDecoderTestFileSelectionx     fun:_ZN37BMPImageDecoderTest_DecodingFast_Test8TestBodyEv     fun:_ZN7testing4Test3RunEv     fun:_ZN7testing8internal12TestInfoImpl3RunEv     fun:_ZN7testing8TestCase3RunEv     fun:_ZN7testing8internal12UnitTestImpl11RunAllTestsEv     fun:_ZN7testing8UnitTest3RunEv     fun:main  }      15:07:44 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: src/sconsbuild/Release/test_shell_tests --gtest_filter=-  BMPImageDecoderTest.ChunkedDecodingSlow:BMPImageDecoderTest.DecodingSlow:MediaLeakTest.VideoBear:MediaLeakTest.ManyVideoBear:WebFra  meTest.GetFullHtmlOfPage --gtest_print_time  15 316 (644 direct  14 672 indirect) bytes in 7 blocks are definitely lost in loss record 8 248 of 8 280    operator new(unsigned int) (mp/vg-chr/scripts/valgrind-source/coregrind/m_replacemalloc/vg_replace_malloc.c:228)    WebCore::RGBA32Buffer::asNewNativeImage() const (third_party/WebKit/WebCore/platform/image-decoders/skia/ImageDecoderSkia.cpp:97)    WebKit::WebImageDecoder::getFrameAtIndex(int) const (third_party/WebKit/WebKit/chromium/src/WebImageDecoder.cpp:109)    VerifyImage(WebKit::WebImageDecoder const&amp;  FilePath const&amp;  FilePath const&amp;  unsigned int)   (webkit/tools/test_shell/image_decoder_unittest.cc:85)    ImageDecoderTest::TestWebKitImageDecoder(FilePath const&amp;  FilePath const&amp;  int) const   (webkit/tools/test_shell/image_decoder_unittest.cc:215)    ImageDecoderTest::TestDecoding(ImageDecoderTestFileSelection  long long) (webkit/tools/test_shell/image_decoder_unittest.cc:156)    ImageDecoderTest::TestDecoding() (webkit/tools/test_shell/image_decoder_unittest.h:71)    ICOImageDecoderTest_Decoding_Test::TestBody() (webkit/tools/webcore_unit_tests/ICOImageDecoder_unittest.cpp:50)    testing::Test::Run() (testing/gtest/src/gtest.cc:2085)    testing::internal::TestInfoImpl::Run() (testing/gtest/src/gtest.cc:2304)    testing::TestCase::Run() (testing/gtest/src/gtest.cc:2412)    testing::internal::UnitTestImpl::RunAllTests() (testing/gtest/src/gtest.cc:4013)    testing::UnitTest::Run() (testing/gtest/src/gtest.cc:3680)    main (webkit/tools/test_shell/run_all_tests.cc:98)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:_Znw*     fun:_ZNK7WebCore12RGBA32Buffer16asNewNativeImageEv     fun:_ZNK6WebKit15WebImageDecoder15getFrameAtIndexEi     fun:_Z11VerifyImageRKN6WebKit15WebImageDecoderERK8FilePathS5_j     fun:_ZNK16ImageDecoderTest22TestWebKitImageDecoderERK8FilePathS2_i     fun:_ZN16ImageDecoderTest12TestDecodingE29ImageDecoderTestFileSelectionx     fun:_ZN16ImageDecoderTest12TestDecodingEv     fun:_ZN33ICOImageDecoderTest_Decoding_Test8TestBodyEv     fun:_ZN7testing4Test3RunEv     fun:_ZN7testing8internal12TestInfoImpl3RunEv     fun:_ZN7testing8TestCase3RunEv     fun:_ZN7testing8internal12UnitTestImpl11RunAllTestsEv     fun:_ZN7testing8UnitTest3RunEv     fun:main  }      15:07:44 valgrind_test.py [INFO] Please see <a href="http://dev.chromium.org/developers/how-tos/using-valgrind">http://dev.chromium.org/developers/how-tos/using-valgrind</a> for the info on   Memcheck/Valgrind  15:07:44 valgrind_test.py [ERROR] Analyze failed.  15:07:44 valgrind_test.py [INFO] elapsed time: 00:08:41  program finished with exit code 255  elapsedTime=521.557682 </pre>