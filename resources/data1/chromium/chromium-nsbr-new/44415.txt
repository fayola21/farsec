<title>Issue 44415 -   chromium -    Crasher while reloading an extension that with a background page - Project Hosting on Google Code</title> <pre> 1. Load an extension with a background page that displays an alert when loaded   2. Go to chrome://extension  3. Tab to select the reload link for that extension.  4. Press enter like a maniac (e.g. repeatedly and fast)    Crash.    In PageActionImageView::UpdateVisibility() debugger seems to indicate that  page_action_ is bad (has been deleted?).    Here is the stack:    chrome.dll!std::_Tree&lt;std::_Tmap_traits&lt;int bool std::less&lt;int&gt; std::allocator&lt;std::pair&lt;int  const  bool&gt; &gt; 0&gt; &gt;::_Lbound(const int &amp; _Keyval=9)  Line 1264 + 0x8 bytes	C++     chrome.dll!std::_Tree&lt;std::_Tmap_traits&lt;int bool std::less&lt;int&gt; std::allocator&lt;std::pair&lt;int  const  bool&gt; &gt; 0&gt; &gt;::lower_bound(const int &amp; _Keyval=9)  Line 1004 + 0x10  bytes	C++     chrome.dll!std::_Tree&lt;std::_Tmap_traits&lt;int bool std::less&lt;int&gt; std::allocator&lt;std::pair&lt;int  const  bool&gt; &gt; 0&gt; &gt;::find(const int &amp; _Keyval=9)  Line 982	C++  &gt;  chrome.dll!ExtensionAction::GetValue&lt;bool&gt;(std::map&lt;int bool std::less&lt;int&gt; std::allocator&lt;std::pair&lt;int  const  bool&gt; &gt; &gt; * map=[7209065](...)  int tab_id=9)  Line 173	C++   	chrome.dll!ExtensionAction::GetIsVisible(int tab_id=9)  Line 149	C++   	chrome.dll!PageActionImageView::UpdateVisibility(TabContents *  contents=0x05e34700  const GURL &amp; url={...})  Line 169 + 0x26 bytes	C++   	chrome.dll!PageActionWithBadgeView::UpdateVisibility(TabContents *  contents=0x05e34700  const GURL &amp; url={...})  Line 34	C++   	chrome.dll!LocationBarView::RefreshPageActionViews()  Line 736	C++   	chrome.dll!LocationBarView::UpdatePageActions()  Line 261	C++   	chrome.dll!Browser::Observe(NotificationType type={...}  const  NotificationSource &amp; source={...}  const NotificationDetails &amp;  details={...})  Line 2877 + 0x48 bytes	C++   	chrome.dll!NotificationService::Notify(NotificationType type={...}  const  NotificationSource &amp; source={...}  const NotificationDetails &amp;  details={...})  Line 114 + 0x73 bytes	C++   	chrome.dll!ExtensionsService::NotifyExtensionUnloaded(Extension *  extension=0x06b44000)  Line 634 + 0x39 bytes	C++   	chrome.dll!ExtensionsService::UnloadExtension(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  extension_id=&quot;codpmkgnkhmobkncifgohdkcljlfanbd&quot;)  Line 746	C++   	chrome.dll!ExtensionsService::ReloadExtension(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  extension_id=&quot;codpmkgnkhmobkncifgohdkcljlfanbd&quot;)  Line 321	C++   	chrome.dll!ExtensionsDOMHandler::HandleReloadMessage(const Value *  value=0x05100fa0)  Line 445	C++   	chrome.dll!DispatchToMethod&lt;ExtensionsDOMHandler void (__thiscall  ExtensionsDOMHandler::*)(Value const *) Value const *&gt;(ExtensionsDOMHandler  * obj=0x06db7e00  void (const Value *)* method=0x5c3b6940  const  Tuple1&lt;Value const *&gt; &amp; arg={...})  Line 422 + 0x11 bytes	C++   	chrome.dll!CallbackImpl&lt;ExtensionsDOMHandler void (__thiscall  ExtensionsDOMHandler::*)(Value const *) Tuple1&lt;Value const *&gt;  &gt;::RunWithParams(const Tuple1&lt;Value const *&gt; &amp; params={...})  Line 118 +  0x1b bytes	C++   	chrome.dll!CallbackRunner&lt;Tuple1&lt;Value const *&gt; &gt;::Run&lt;Value const  *&gt;(const Value * const &amp; a=0x05100fa0)  Line 83 + 0x1c bytes	C++   	chrome.dll!DOMUI::ProcessDOMUIMessage(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  message=&quot;reload&quot;  const Value * content=0x05100fa0  const GURL &amp;  source_url={...}  int request_id=-1  bool has_callback=false)  Line 52	C++   	chrome.dll!TabContents::ProcessDOMUIMessage(const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  message=&quot;reload&quot;  const Value * content=0x05100fa0  const GURL &amp;  source_url={...}  int request_id=-1  bool has_callback=false)  Line 2531 +  0x35 bytes	C++   	chrome.dll!RenderViewHost::OnMsgDOMUISend(const GURL &amp; source_url={...}   const std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  &amp; message=&quot;reload&quot;  const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;  content=&quot;[&quot;codpmkgnkhmobkncifgohdkcljlfanbd&quot;]&quot;)  Line 1257 + 0x35 bytes	C++   	chrome.dll!DispatchToMethod&lt;RenderViewHost void (__thiscall  RenderViewHost::*)(GURL const  &amp; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  const &amp; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; const  &amp;) GURL std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  &gt;(RenderViewHost * obj=0x06b12120  void (const GURL &amp;  const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;   const std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  &amp;)* method=0x5c217bf0  const  Tuple3&lt;GURL std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &gt; &amp;  arg={...})  Line 435 + 0x1f bytes	C++     chrome.dll!IPC::MessageWithTuple&lt;Tuple3&lt;GURL std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &gt;  &gt;::Dispatch&lt;RenderViewHost void (__thiscall RenderViewHost::*)(GURL const  &amp; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  const &amp; std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; const &amp;)&gt;(const IPC::Message * msg=0x06dbb228  RenderViewHost *  obj=0x06b12120  void (const GURL &amp;  const  std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt; &amp;   const std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt; &gt;  &amp;)* func=0x5c217bf0)  Line 1020 + 0x18 bytes	C++   	chrome.dll!RenderViewHost::OnMessageReceived(const IPC::Message &amp;  msg={...})  Line 756 + 0x2f bytes	C++   	chrome.dll!BrowserRenderProcessHost::OnMessageReceived(const IPC::Message  &amp; msg={...})  Line 834 + 0x13 bytes	C++   	chrome.dll!IPC::ChannelProxy::Context::OnDispatchMessage(const  IPC::Message &amp; message={...})  Line 204 + 0x19 bytes	C++   	chrome.dll!DispatchToMethod&lt;IPC::ChannelProxy::Context void (__thiscall  IPC::ChannelProxy::Context::*)(IPC::Message const  &amp;) IPC::Message&gt;(IPC::ChannelProxy::Context * obj=0x01245e40  void (const  IPC::Message &amp;)* method=0x5bb66360  const Tuple1&lt;IPC::Message&gt; &amp; arg={...})   Line 422 + 0xf bytes	C++   	chrome.dll!RunnableMethod&lt;IPC::ChannelProxy::Context void (__thiscall  IPC::ChannelProxy::Context::*)(IPC::Message const &amp;) Tuple1&lt;IPC::Message&gt;  &gt;::Run()  Line 296 + 0x1e bytes	C++   	chrome.dll!MessageLoop::RunTask(Task * task=0x06dbb200)  Line 328 + 0xf  bytes	C++   	chrome.dll!MessageLoop::DeferOrRunPendingTask(const  MessageLoop::PendingTask &amp; pending_task={...})  Line 339	C++   	chrome.dll!MessageLoop::DoWork()  Line 443 + 0xc bytes	C++   	chrome.dll!base::MessagePumpForUI::DoRunLoop()  Line 203 + 0x1d bytes	C++     chrome.dll!base::MessagePumpWin::RunWithDispatcher(base::MessagePump::Delegate  * delegate=0x0029f3bc  base::MessagePumpWin::Dispatcher *  dispatcher=0x0029e74c)  Line 52 + 0xf bytes	C++   	chrome.dll!MessageLoop::RunInternal()  Line 200	C++   	chrome.dll!MessageLoop::RunHandler()  Line 177	C++   	chrome.dll!MessageLoopForUI::Run(base::MessagePumpWin::Dispatcher *  dispatcher=0x0029e74c)  Line 612	C++   	chrome.dll!`anonymous namespace'::RunUIMessageLoop(BrowserProcess *  browser_process=0x011f5000)  Line 187	C++   	chrome.dll!BrowserMain(const MainFunctionParams &amp; parameters={...})  Line  1212 + 0x11 bytes	C++   	chrome.dll!ChromeMain(HINSTANCE__ * instance=0x01310000   sandbox::SandboxInterfaceInfo * sandbox_info=0x0029fce4  wchar_t *  command_line=0x00942f4e)  Line 831 + 0xc bytes	C++   	chrome.exe!MainDllLoader::Launch(HINSTANCE__ * instance=0x01310000   sandbox::SandboxInterfaceInfo * sbox_info=0x0029fce4)  Line 197 + 0x1d  bytes	C++   	chrome.exe!wWinMain(HINSTANCE__ * instance=0x01310000  HINSTANCE__ *  __formal=0x00000000  HINSTANCE__ * __formal=0x00000000  HINSTANCE__ *  __formal=0x00000000)  Line 46 + 0x10 bytes	C++   	chrome.exe!__tmainCRTStartup()  Line 263 + 0x2c bytes	C   	chrome.exe!wWinMainCRTStartup()  Line 182	C   	kernel32.dll!@BaseThreadInitThunk@12()  + 0xe bytes	   	ntdll.dll!___RtlUserThreadStart@8()  + 0x23 bytes	   	ntdll.dll!__RtlUserThreadStart@8()  + 0x1b bytes	   </pre>