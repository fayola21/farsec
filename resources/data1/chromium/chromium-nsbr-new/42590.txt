<title>Issue 42590 -   chromium -    valgrind error (Leak_DefinitelyLost) in ui tests after r45567 (Roll WebKit to 58138 (from 58033)) - Project Hosting on Google Code</title> <pre> We started to have a valgrind error (Leak_DefinitelyLost) in the &quot;ui&quot;  tests after <a href="/p/chromium/source/detail?r=45567">r45567</a>:  <a href="http://src.chromium.org/viewvc/chrome?view=rev&amp;revision=45567">http://src.chromium.org/viewvc/chrome?view=rev&amp;revision=45567</a>        Roll WebKit to 58138 (from 58033)        Reland 45413 now that python2.6 should be used on the windows bots.        TBR=yuzo        Review URL: <a href="http://codereview.chromium.org/1787002">http://codereview.chromium.org/1787002</a>    Here is a sample test output log:    23:58:37 memcheck_analyze.py [ERROR] FAIL! There were 1 errors:   23:58:37 memcheck_analyze.py [ERROR] Leak_DefinitelyLost  Command: /b/slave/chromium-rel-linux-valgrind-tests-  1/build/src/sconsbuild/Release/chrome --no-first-run --no-default-browser-  check --test-type=ui --enable-file-cookies --testing-  channel=ChromeTestingInterface:31486.28 --noerrdialogs --  homepage=about:blank --disable-web-resources --user-data-  dir=/tmp/org.chromium.SFgypX/test_user_data --metrics-recording-only --  enable-logging --test-name=DOMStorageTest.EventLayoutTests --allow-file-  access-from-files --disable-popup-blocking  26 bytes in 1 blocks are definitely lost in loss record 3 995 of 6 992    malloc (mp/vg_bins/scripts/valgrind-  memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:241)    WTF::fastMalloc(unsigned int)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/FastMalloc.cpp:249)    WebCore::StringImpl::createUninitialized(unsigned int  unsigned short*&amp;)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/StringImpl.cpp  :97)    WebCore::StringImpl::create(char const*  unsigned int)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/StringImpl.cpp  :120)    WebCore::StringImpl::create(char const*)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/StringImpl.cpp  :132)    WTF::CStringTranslator::translate(WebCore::StringImpl*&amp;  char const*   const&amp;  unsigned int)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/AtomicStringTa  ble.h:58)    WTF::HashSetTranslatorAdapter&lt;WebCore::StringImpl*    WTF::HashTraits&lt;WebCore::StringImpl*&gt;  char const*    WTF::CStringTranslator&gt;::translate(WebCore::StringImpl*&amp;  char const*   const&amp;  char const* const&amp;  unsigned int)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/HashSet.h:111)    std::pair&lt;WTF::HashTableIterator&lt;WebCore::StringImpl*    WebCore::StringImpl*  WTF::IdentityExtractor&lt;WebCore::StringImpl*&gt;    WebCore::StringHash  WTF::HashTraits&lt;WebCore::StringImpl*&gt;    WTF::HashTraits&lt;WebCore::StringImpl*&gt; &gt;  bool&gt;   WTF::HashTable&lt;WebCore::StringImpl*  WebCore::StringImpl*    WTF::IdentityExtractor&lt;WebCore::StringImpl*&gt;  WebCore::StringHash    WTF::HashTraits&lt;WebCore::StringImpl*&gt;    WTF::HashTraits&lt;WebCore::StringImpl*&gt; &gt;::addPassingHashCode&lt;char const*    char const*  WTF::HashSetTranslatorAdapter&lt;WebCore::StringImpl*    WTF::HashTraits&lt;WebCore::StringImpl*&gt;  char const*  WTF::CStringTranslator&gt;   &gt;(char const* const&amp;  char const* const&amp;)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/HashTable.h:737)      std::pair&lt;WTF::HashTableIteratorAdapter&lt;WTF::HashTable&lt;WebCore::StringImpl*    WebCore::StringImpl*  WTF::IdentityExtractor&lt;WebCore::StringImpl*&gt;    WebCore::StringHash  WTF::HashTraits&lt;WebCore::StringImpl*&gt;    WTF::HashTraits&lt;WebCore::StringImpl*&gt; &gt;  WebCore::StringImpl*&gt;  bool&gt;   WTF::HashSet&lt;WebCore::StringImpl*  WebCore::StringHash    WTF::HashTraits&lt;WebCore::StringImpl*&gt; &gt;::add&lt;char const*    WTF::CStringTranslator&gt;(char const* const&amp;)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/HashSet.h:219)    WTF::IdentifierOrAtomicStringTable&lt;false&gt;::add(char const*)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/AtomicStringTa  ble.h:167)    WebCore::AtomicString::add(char const*)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/AtomicString.c  pp:59)    WebCore::AtomicString::AtomicString(char const*)   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/text/AtomicString.h  :46)    WebCore::EventNames::EventNames()   (uilder/build/src/third_party/WebKit/WebCore/dom/EventNames.cpp:30)    WebCore::ThreadGlobalData::ThreadGlobalData()   (uilder/build/src/third_party/WebKit/WebCore/platform/ThreadGlobalData.cpp:  65)    WTF::ThreadSpecific&lt;WebCore::ThreadGlobalData&gt;::operator   WebCore::ThreadGlobalData*()   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/ThreadSpecific.h:29  0)    WTF::ThreadSpecific&lt;WebCore::ThreadGlobalData&gt;::operator*()   (uilder/build/src/third_party/WebKit/JavaScriptCore/wtf/ThreadSpecific.h:30  4)    WebCore::threadGlobalData()   (uilder/build/src/third_party/WebKit/WebCore/platform/ThreadGlobalData.h:97  )    WebCore::timerHeap()   (uilder/build/src/third_party/WebKit/WebCore/platform/Timer.cpp:53)    WebCore::TimerBase::heapInsert()   (uilder/build/src/third_party/WebKit/WebCore/platform/Timer.cpp:258)    WebCore::TimerBase::setNextFireTime(double)   (uilder/build/src/third_party/WebKit/WebCore/platform/Timer.cpp:296)    WebCore::TimerBase::start(double  double)   (uilder/build/src/third_party/WebKit/WebCore/platform/Timer.cpp:184)    WebCore::TimerBase::startOneShot(double)   (uilder/build/src/third_party/WebKit/WebCore/platform/Timer.h:46)    WebCore::StorageAreaSync::scheduleItemForSync(WebCore::String const&amp;    WebCore::String const&amp;)   (uilder/build/src/third_party/WebKit/WebCore/storage/StorageAreaSync.cpp:11  1)    WebCore::StorageAreaImpl::setItem(WebCore::String const&amp;  WebCore::String   const&amp;  int&amp;  WebCore::Frame*)   (uilder/build/src/third_party/WebKit/WebCore/storage/StorageAreaImpl.cpp:15  7)    WebKit::WebStorageAreaImpl::setItem(WebKit::WebString const&amp;    WebKit::WebString const&amp;  WebKit::WebURL const&amp;    WebKit::WebStorageArea::Result&amp;  WebKit::WebString&amp;  WebKit::WebFrame*)   (uilder/build/src/third_party/WebKit/WebKit/chromium/src/WebStorageAreaImpl  .cpp:74)    WebKit::WebStorageArea::setItem(WebKit::WebString const&amp;    WebKit::WebString const&amp;  WebKit::WebURL const&amp;    WebKit::WebStorageArea::Result&amp;  WebKit::WebString&amp;)   (uilder/build/src/third_party/WebKit/WebKit/chromium/public/WebStorageArea.  h:77)    DOMStorageArea::SetItem(std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt; const&amp;  WebKit::WebStorageArea::Result*    DOMStorageDispatcherHost*)   (uilder/build/src/chrome/browser/in_process_webkit/dom_storage_area.cc:70)    DOMStorageDispatcherHost::OnSetItem(long long  std::basic_string&lt;unsigned   short  base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt; const&amp;  GURL const&amp;  IPC::Message*)   (uilder/build/src/chrome/browser/in_process_webkit/dom_storage_dispatcher_h  ost.cc:275)    void DispatchToMethod&lt;DOMStorageDispatcherHost  void   (DOMStorageDispatcherHost::*)(long long  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt; const&amp;  GURL const&amp;  IPC::Message*)  long   long  std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt;  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt;  GURL    IPC::Message*&gt;(DOMStorageDispatcherHost*  void   (DOMStorageDispatcherHost::*)(long long  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt; const&amp;  GURL const&amp;  IPC::Message*)    Tuple5&lt;long long  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt;  GURL  IPC::Message*&gt; const&amp;)   (uilder/build/src/./base/tuple.h:447)    RunnableMethod&lt;DOMStorageDispatcherHost  void   (DOMStorageDispatcherHost::*)(long long  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt; const&amp;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt; const&amp;  GURL const&amp;  IPC::Message*)    Tuple5&lt;long long  std::basic_string&lt;unsigned short    base::string16_char_traits  std::allocator&lt;unsigned short&gt; &gt;    std::basic_string&lt;unsigned short  base::string16_char_traits    std::allocator&lt;unsigned short&gt; &gt;  GURL  IPC::Message*&gt; &gt;::Run()   (uilder/build/src/./base/task.h:296)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:malloc     fun:_ZN3WTF10fastMallocEj     fun:_ZN7WebCore10StringImpl19createUninitializedEjRPt     fun:_ZN7WebCore10StringImpl6createEPKcj     fun:_ZN7WebCore10StringImpl6createEPKc     fun:_ZN3WTF17CStringTranslator9translateERPN7WebCore10StringImplERKPKcj       fun:_ZN3WTF24HashSetTranslatorAdapterIPN7WebCore10StringImplENS_10HashTrait  sIS3_EEPKcNS_17CStringTranslatorEE9translateERS3_RKS7_SC_j       fun:_ZN3WTF9HashTableIPN7WebCore10StringImplES3_NS_17IdentityExtractorIS3_E  ENS1_10StringHashENS_10HashTraitsIS3_EES8_E18addPassingHashCodeIPKcSC_NS_24  HashSetTranslatorAdapterIS3_S8_SC_NS_17CStringTranslatorEEEEESt4pairINS_17H  ashTableIteratorIS3_S3_S5_S6_S8_S8_EEbERKT_RKT0_       fun:_ZN3WTF7HashSetIPN7WebCore10StringImplENS1_10StringHashENS_10HashTraits  IS3_EEE3addIPKcNS_17CStringTranslatorEEESt4pairINS_24HashTableIteratorAdapt  erINS_9HashTableIS3_S3_NS_17IdentityExtractorIS3_EES4_S6_S6_EES3_EEbERKT_     fun:_ZN3WTF29IdentifierOrAtomicStringTableILb0EE3addEPKc     fun:_ZN7WebCore12AtomicString3addEPKc     fun:_ZN7WebCore12AtomicStringC1EPKc     fun:_ZN7WebCore10EventNamesC1Ev     fun:_ZN7WebCore16ThreadGlobalDataC1Ev     fun:_ZN3WTF14ThreadSpecificIN7WebCore16ThreadGlobalDataEEcvPS2_Ev     fun:_ZN3WTF14ThreadSpecificIN7WebCore16ThreadGlobalDataEEdeEv     fun:_ZN7WebCore16threadGlobalDataEv     fun:_ZN7WebCore9timerHeapEv     fun:_ZN7WebCore9TimerBase10heapInsertEv     fun:_ZN7WebCore9TimerBase15setNextFireTimeEd     fun:_ZN7WebCore9TimerBase5startEdd     fun:_ZN7WebCore9TimerBase12startOneShotEd  } </pre>