<title>Issue 46177 -   chromium -    Leak in FcFontSort() - Project Hosting on Google Code</title> <pre> Started with this run:    <a href="http://build.chromium.org/buildbot/memory/builders/Chromium%20OS%20UI%20(valgrind)(3)/builds/3752">http://build.chromium.org/buildbot/memory/builders/Chromium%20OS%20UI%20(valgrind)(3)/builds/3752</a>    None of the CLs look too relevant  and there is already a bunch of Pango/FontConfig suppressions. One of the traces has bits of Chromium code on it  but others don't  so I put this in category 1 of suppressions.txt.    ERROR:root:FAIL! There were 2 errors:  ERROR:root:Leak_DefinitelyLost  Command: /out/Release/chrome --no-first-run --no-default-browser-check --test-type=ui --enable-file-cookies --testing-channel=ChromeTestingInterface:29640.13 --noerrdialogs --homepage=about:blank --disable-web-resources --user-data-dir=/tmp/org.chromium.skfz48/test_user_data --metrics-recording-only --enable-logging --test-name=AutomationProxyVisibleTest.FLAKY_AutocompleteMatchesTest --allow-file-access-from-files  64 bytes in 2 blocks are definitely lost in loss record 11 629 of 15 175    calloc (/tmp/scripts/valgrind-memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:502)    FcCharSetFindLeafCreate (/build/buildd/fontconfig-2.5.0/src/fccharset.c:199)    FcCharSetAddLeaf (/build/buildd/fontconfig-2.5.0/src/fccharset.c:343)    FcCharSetOperate (/build/buildd/fontconfig-2.5.0/src/fccharset.c:373)    FcFontSetSort (/build/buildd/fontconfig-2.5.0/src/fcmatch.c:607)    FcFontSort (/build/buildd/fontconfig-2.5.0/src/fcmatch.c:836)    0x4E1EF25    pango_font_map_load_fontset    0x4591206    pango_itemize_with_base_dir    0x459A6AF    0x459BA7C    pango_fc_font_create_metrics_for_context    0x457B213    0x4578377    pango_font_get_metrics    0x45974FB    0x459A551    0x459BA7C    pango_layout_get_pixel_extents    pango_layout_get_pixel_size    gfx::Canvas::DrawStringInt(std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;  gfx::Font const&amp;  unsigned int const&amp;  int  int  int  int  int) (/gfx/canvas_linux.cc:228)    AutocompleteResultView::DrawString(gfx::Canvas*  std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;  std::vector&lt;AutocompleteMatch::ACMatchClassification  std::allocator&lt;AutocompleteMatch::ACMatchClassification&gt; &gt; const&amp;  bool  int  int) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:494)    AutocompleteResultView::Paint(gfx::Canvas*) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:286)    views::View::ProcessPaint(gfx::Canvas*) (/views/view.cc:385)    views::View::PaintChildren(gfx::Canvas*) (/views/view.cc:350)    AutocompletePopupContentsView::Paint(gfx::Canvas*) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:772)    views::View::ProcessPaint(gfx::Canvas*) (/views/view.cc:385)    views::View::PaintChildren(gfx::Canvas*) (/views/view.cc:350)    views::View::ProcessPaint(gfx::Canvas*) (/views/view.cc:394)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:calloc     fun:FcCharSetFindLeafCreate     fun:FcCharSetAddLeaf     fun:FcCharSetOperate     fun:FcFontSetSort     fun:FcFontSort     obj:/usr/lib/libpangoft2-1.0.so.0.2002.3     fun:pango_font_map_load_fontset     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_itemize_with_base_dir     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_fc_font_create_metrics_for_context     obj:/usr/lib/libpangocairo-1.0.so.0.2002.3     obj:/usr/lib/libpangocairo-1.0.so.0.2002.3     fun:pango_font_get_metrics     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_layout_get_pixel_extents     fun:pango_layout_get_pixel_size     fun:_ZN3gfx6Canvas13DrawStringIntERKSbIwSt11char_traitsIwESaIwEERKNS_4FontERKjiiiii  }    ERROR:root:Leak_DefinitelyLost  Command: /out/Release/chrome --no-first-run --no-default-browser-check --test-type=ui --enable-file-cookies --testing-channel=ChromeTestingInterface:29640.13 --noerrdialogs --homepage=about:blank --disable-web-resources --user-data-dir=/tmp/org.chromium.skfz48/test_user_data --metrics-recording-only --enable-logging --test-name=AutomationProxyVisibleTest.FLAKY_AutocompleteMatchesTest --allow-file-access-from-files  696 bytes in 1 blocks are definitely lost in loss record 14 527 of 15 175    realloc (/tmp/scripts/valgrind-memcheck/coregrind/m_replacemalloc/vg_replace_malloc.c:562)    FcCharSetPutLeaf (/build/buildd/fontconfig-2.5.0/src/fccharset.c:165)    FcCharSetFindLeafCreate (/build/buildd/fontconfig-2.5.0/src/fccharset.c:204)    FcCharSetAddLeaf (/build/buildd/fontconfig-2.5.0/src/fccharset.c:343)    FcCharSetOperate (/build/buildd/fontconfig-2.5.0/src/fccharset.c:387)    FcFontSetSort (/build/buildd/fontconfig-2.5.0/src/fcmatch.c:607)    FcFontSort (/build/buildd/fontconfig-2.5.0/src/fcmatch.c:836)    0x4E1EF25    pango_font_map_load_fontset    0x4591206    pango_itemize_with_base_dir    0x459A6AF    0x459BA7C    pango_fc_font_create_metrics_for_context    0x457B213    0x4578377    pango_font_get_metrics    0x45974FB    0x459A551    0x459BA7C    pango_layout_get_pixel_extents    pango_layout_get_pixel_size    gfx::Canvas::DrawStringInt(std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;  gfx::Font const&amp;  unsigned int const&amp;  int  int  int  int  int) (/gfx/canvas_linux.cc:228)    AutocompleteResultView::DrawString(gfx::Canvas*  std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; const&amp;  std::vector&lt;AutocompleteMatch::ACMatchClassification  std::allocator&lt;AutocompleteMatch::ACMatchClassification&gt; &gt; const&amp;  bool  int  int) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:494)    AutocompleteResultView::Paint(gfx::Canvas*) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:286)    views::View::ProcessPaint(gfx::Canvas*) (/views/view.cc:385)    views::View::PaintChildren(gfx::Canvas*) (/views/view.cc:350)    AutocompletePopupContentsView::Paint(gfx::Canvas*) (/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc:772)    views::View::ProcessPaint(gfx::Canvas*) (/views/view.cc:385)    views::View::PaintChildren(gfx::Canvas*) (/views/view.cc:350)  Suppression:  {     &lt;insert_a_suppression_name_here&gt;     Memcheck:Leak     fun:realloc     fun:FcCharSetPutLeaf     fun:FcCharSetFindLeafCreate     fun:FcCharSetAddLeaf     fun:FcCharSetOperate     fun:FcFontSetSort     fun:FcFontSort     obj:/usr/lib/libpangoft2-1.0.so.0.2002.3     fun:pango_font_map_load_fontset     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_itemize_with_base_dir     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_fc_font_create_metrics_for_context     obj:/usr/lib/libpangocairo-1.0.so.0.2002.3     obj:/usr/lib/libpangocairo-1.0.so.0.2002.3     fun:pango_font_get_metrics     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     obj:/usr/lib/libpango-1.0.so.0.2002.3     fun:pango_layout_get_pixel_extents     fun:pango_layout_get_pixel_size  } </pre>