<title>Issue 45769 -   chromium -    PluginService browser crash - Project Hosting on Google Code</title> <pre> I've seen this happen for the second time in a week or so when I restart my chromium   instance (my daily routine is git pull &amp;&amp; gclient sync &amp;&amp; make -j15 -r chrome  and   when it completes  I go to gdb and ctrl^c to SIGINT  and then r to restart chromium   with the new binary  without cleanly shutting down the old processes).    Here's the stacktrace that I get (when I try to log back into gmail after restoring   the previous session):      Program received signal SIGSEGV  Segmentation fault.  [Switching to Thread 0x43806950 (LWP 11155)]  0x00007ffff271b3b1 in std::string::compare(std::string const&amp;) const () from   /usr/lib/libstdc++.so.6  (gdb) ba  #0  0x00007ffff271b3b1 in std::string::compare(std::string const&amp;) const () from   /usr/lib/libstdc++.so.6  #1  0x000000000045e9bb in std::operator==&lt;char  std::char_traits&lt;char&gt;    std::allocator&lt;char&gt; &gt; (__lhs=Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 510  in to_string      nchars = min(length  limit)  RuntimeError: Cannot access memory at address 0x4072bfffffffffe8    __rhs=&quot;/home/willchan/.mozilla/plugins/libflashplayer.so&quot;) at   /usr/include/c++/4.2/bits/basic_string.h:2144  #2  0x0000000000d681d1 in FilePath::operator== (this=0x7fffe050a0f8  that=...) at   base/file_path.cc:163  #3  0x0000000000695314 in PluginService::FindPluginProcess (this=0x7ffff7e78960    plugin_path=...) at chrome/browser/plugin_service.cc:261  #4  0x0000000000695407 in PluginService::FindOrStartPluginProcess   (this=0x7ffff7e78960  plugin_path=...) at chrome/browser/plugin_service.cc:272  #5  0x0000000000695694 in PluginService::OpenChannelToPlugin (this=0x7ffff7e78960    renderer_msg_filter=0x7fffeb050c40  url=...  mime_type=&quot;application/x-shockwave-  flash&quot;  locale=      Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 541  in to_string      return self.val['_M_dataplus']['_M_p'].string(encoding)  LookupError: unknown encoding: UTF-32    reply_msg=0x7fffecaeedc0) at chrome/browser/plugin_service.cc:305  #6  0x0000000000a37e7a in ResourceMessageFilter::OnOpenChannelToPlugin   (this=0x7fffeb050c40  url=...  mime_type=&quot;application/x-shockwave-flash&quot;    locale=Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 541  in to_string      return self.val['_M_dataplus']['_M_p'].string(encoding)  LookupError: unknown encoding: UTF-32    reply_msg=0x7fffecaeedc0) at   chrome/browser/renderer_host/resource_message_filter.cc:814  #7  0x0000000000a3cd35 in DispatchToMethod&lt;ResourceMessageFilter  void   (ResourceMessageFilter::*)(GURL const&amp;  std::string const&amp;    std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt;   const&amp;  IPC::Message*)  GURL  std::string  std::basic_string&lt;wchar_t    std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt;  IPC::Message&amp;&gt;   (obj=0x7fffeb050c40       method=0xa37e2e &lt;ResourceMessageFilter::OnOpenChannelToPlugin(GURL const&amp;    std::string const&amp;  std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;    std::allocator&lt;wchar_t&gt; &gt; const&amp;  IPC::Message*)&gt;       in=...  out=0x43803ea0) at ./base/tuple.h:601  #8  0x0000000000a4380b in IPC::MessageWithReply&lt;Tuple3&lt;GURL  std::string    std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;  std::allocator&lt;wchar_t&gt; &gt; &gt;    Tuple2&lt;IPC::ChannelHandle&amp;  WebPluginInfo&amp;&gt;   &gt;::DispatchDelayReply&lt;ResourceMessageFilter  void (ResourceMessageFilter::*)(GURL   const&amp;  std::string const&amp;  std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;    std::allocator&lt;wchar_t&gt; &gt; const&amp;  IPC::Message*)&gt; (      msg=0x43805650  obj=0x7fffeb050c40       func=0xa37e2e &lt;ResourceMessageFilter::OnOpenChannelToPlugin(GURL const&amp;    std::string const&amp;  std::basic_string&lt;wchar_t  std::char_traits&lt;wchar_t&gt;    std::allocator&lt;wchar_t&gt; &gt; const&amp;  IPC::Message*)&gt;)      at ./ipc/ipc_message_utils.h:1245  #9  0x0000000000a39867 in ResourceMessageFilter::OnMessageReceived   (this=0x7fffeb050c40  msg=...) at   chrome/browser/renderer_host/resource_message_filter.cc:464  #10 0x000000000149c8a3 in IPC::ChannelProxy::Context::TryFilters   (this=0x7fffec0e9b40  message=...) at ipc/ipc_channel_proxy.cc:65  #11 0x00000000014a4267 in IPC::SyncChannel::SyncContext::OnMessageReceived   (this=0x7fffec0e9b40  msg=...) at ipc/ipc_sync_channel.cc:292  #12 0x0000000001499aa1 in IPC::Channel::ChannelImpl::ProcessIncomingMessages   (this=0x7fffece01000) at ipc/ipc_channel_posix.cc:701  #13 0x000000000149a61e in IPC::Channel::ChannelImpl::OnFileCanReadWithoutBlocking   (this=0x7fffece01000  fd=118) at ipc/ipc_channel_posix.cc:954  #14 0x0000000000d596b9 in base::MessagePumpLibevent::OnLibeventNotification (fd=118    flags=2  context=0x7fffece01000) at base/message_pump_libevent.cc:219  #15 0x0000000000de2161 in event_process_active (base=0x7ffff7f57000) at   third_party/libevent/event.c:385  #16 0x0000000000de244b in event_base_loop (base=0x7ffff7f57000  flags=1) at   third_party/libevent/event.c:525  #17 0x0000000000d59e1e in base::MessagePumpLibevent::Run (this=0x7ffff7eca660    delegate=0x43805f20) at base/message_pump_libevent.cc:272  #18 0x0000000000d7d9c3 in MessageLoop::RunInternal (this=0x43805f20) at   base/message_loop.cc:204  #19 0x0000000000d7d9e3 in MessageLoop::RunHandler (this=0x43805f20) at   base/message_loop.cc:176  #20 0x0000000000d7da88 in MessageLoop::Run (this=0x43805f20) at   base/message_loop.cc:154  #21 0x0000000000daa8e9 in base::Thread::Run (this=0x7ffff7f30690    message_loop=0x43805f20) at base/thread.cc:136  #22 0x0000000000daad3a in base::Thread::ThreadMain (this=0x7ffff7f30690) at   base/thread.cc:160  #23 0x0000000000d8dfb0 in ThreadFunc (closure=0x7ffff7f30690) at   base/platform_thread_posix.cc:28  #24 0x00007ffff44763f7 in start_thread () from /lib/libpthread.so.0  #25 0x00007ffff1f60bbd in clone () from /lib/libc.so.6  #26 0x0000000000000000 in ?? ()    After doing a bit more digging  it seems to me that the PluginProcessHost might be   corrupted.  Here's what it looks like:      (gdb) frame 3  #3  0x0000000000695314 in PluginService::FindPluginProcess (this=0x7ffff7e78960    plugin_path=...) at chrome/browser/plugin_service.cc:261  261         if (plugin-&gt;info().path == plugin_path)  (gdb) p plugin  $6 = (PluginProcessHost *) 0x7fffe050a000  (gdb) p *this  $7 = (PluginService) {    &lt;base::WaitableEventWatcher::Delegate&gt; = {      _vptr.Delegate = 0x24d5d30    }       &lt;NotificationObserver&gt; = {      _vptr.NotificationObserver = 0x24d5d60    }       members of PluginService:    plugin_hosts_ = __gnu_cxx::hash_map with 0 elements     main_message_loop_ = 0x7fffffffc8f0     resource_dispatcher_host_ = 0x7fffed5c4e00     chrome_plugin_data_dir_ = {      static kSeparators = 0x2594087 &quot;/&quot;       static kCurrentDirectory = 0x2594089 &quot;.&quot;       static kParentDirectory = 0x259408b &quot;..&quot;       static kExtensionSeparator = 46 '.'       path_ = &quot;/home/willchan/.config/chromium/Default&quot;    }       ui_locale_ = Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 541  in to_string      return self.val['_M_dataplus']['_M_p'].string(encoding)  LookupError: unknown encoding: UTF-32       private_plugins_ = __gnu_cxx::hash_map with 0 elements     registrar_ = {      registered_ = std::vector of length 2  capacity 2 = {{          observer = 0x7ffff7e78968           type = {            value = NotificationType::EXTENSION_LOADED          }           source = {            ptr_ = 0x0          }           thread_id = 11146        }  {          observer = 0x7ffff7e78968           type = {            value = NotificationType::EXTENSION_UNLOADED          }           source = {            ptr_ = 0x0          }           thread_id = 11146        }}    }     static enable_chrome_plugins_ = true     static enable_internal_pdf_ = false  }  (gdb) p *plugin  $8 = (PluginProcessHost) {    &lt;ChildProcessHost&gt; = {      &lt;ResourceDispatcherHost::Receiver&gt; = {        &lt;IPC::Message::Sender&gt; = {          _vptr.Sender = 0x252f770        }         &lt;ChildProcessInfo&gt; = {          _vptr.ChildProcessInfo = 0x252f7e8           type_ = ChildProcessInfo::PLUGIN_PROCESS           name_ = Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 541  in to_string      return self.val['_M_dataplus']['_M_p'].string(encoding)  LookupError: unknown encoding: UTF-32             id_ = 16           process_ = {            process_ = 0             saved_priority_ = 256          }        }  &lt;No data fields&gt;}       &lt;IPC::Channel::Listener&gt; = {        _vptr.Listener = 0x252f808      }       &lt;ChildProcessLauncher::Client&gt; = {        _vptr.Client = 0x252f840      }       members of ChildProcessHost:      listener_ = {        &lt;IPC::Channel::Listener&gt; = {          _vptr.Listener = 0x7fffec42e200        }         &lt;ChildProcessLauncher::Client&gt; = {          _vptr.Client = 0x300000000003        }         members of ChildProcessHost::ListenerHook:        host_ = 0x0      }       resource_dispatcher_host_ = 0x7fff00000001       opening_channel_ = false       channel_ = (struct IPC::Channel *) 0x18       channel_id_ = Traceback (most recent call last):    File &quot;/usr/share/gdb/python/libstdcxx/v6/printers.py&quot;  line 510  in to_string      nchars = min(length  limit)  RuntimeError: Cannot access memory at address 0xffffffffffffffe8            child_process_ = (ChildProcessLauncher *) 0x0    }     &lt;ResolveProxyMsgHelper::Delegate&gt; = {      _vptr.Delegate = 0x3ff0000000000000    }     members of PluginProcessHost:    pending_requests_ = std::vector of length 0  capacity 191965934116667392     sent_requests_ = std::queue wrapping: std::deque with -119556496357851157 elements   = {&lt;error reading variable&gt; </pre>