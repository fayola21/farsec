<title>Issue 35134 -   chromium -    Beach ball with lots of local storage entries - Project Hosting on Google Code</title> <pre> - create 1000 local storage entries in your profile (I have such a profile  but it's from a googler. ask me offline and I'll share).  - open prefs  click &quot;show cookies and website permissions&quot;  - wait.    Beachball!     The problem is that for cookies  we don't have an observer registered for all the TreeNodesAdded notifications. However  by the time local storage loads  we   do  and we get notified for every...single....one  updating our cocoa model even when it's not necessary.    We need to either add some batching to the observer api or switch to being a data source which will allow us to be even lazier about how we create nodes.    Here's the stack:    #0	0x06c26281 in CookiesTreeModelObserverBridge::TreeNodesAdded at cookies_window_controller.mm:37  #1	0x06cb4a03 in TreeNodeModel&lt;CookieTreeNode&gt;::NotifyObserverTreeNodesAdded at tree_node_model.h:298  #2	0x06cb79eb in TreeNodeModel&lt;CookieTreeNode&gt;::Add at tree_node_model.h:286  #3	0x06cb35b9 in CookieTreeRootNode::GetOrCreateOriginNode at cookies_tree_model.cc:158  #4	0x06cb3cc2 in CookiesTreeModel::PopulateLocalStorageInfoWithFilter at cookies_tree_model.cc:397  #5	0x06cb3dd1 in CookiesTreeModel::OnStorageModelInfoLoaded at cookies_tree_model.cc:380  #6	0x06cb6081 in DispatchToMethod&lt;CookiesTreeModel  void (CookiesTreeModel::*)(std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; const&amp;)  std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; const&amp;&gt; at tuple.h:422  #7	0x06cb60b0 in CallbackImpl&lt;CookiesTreeModel  void (CookiesTreeModel::*)(std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; const&amp;)  Tuple1&lt;std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; const&amp;&gt; &gt;::RunWithParams at task.h:563  #8	0x06bb734c in CallbackRunner&lt;Tuple1&lt;std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; const&amp;&gt; &gt;::Run&lt;std::vector&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo    std::allocator&lt;BrowsingDataLocalStorageHelper::LocalStorageInfo&gt; &gt; &gt; at task.h:528  #9	0x06bb63fc in BrowsingDataLocalStorageHelper::NotifyInUIThread at browsing_data_local_storage_helper.cc:112  #10	0x06bb750c in DispatchToMethod&lt;BrowsingDataLocalStorageHelper  void (BrowsingDataLocalStorageHelper::*)()&gt; at tuple.h:412  #11	0x06bb7547 in RunnableMethod&lt;BrowsingDataLocalStorageHelper  void (BrowsingDataLocalStorageHelper::*)()  Tuple0&gt;::Run at task.h:289  #12	0x07235ee2 in MessageLoop::RunTask at message_loop.cc:320  #13	0x072365c7 in MessageLoop::DeferOrRunPendingTask at message_loop.cc:328  #14	0x07236857 in MessageLoop::DoWork at message_loop.cc:435  #15	0x071fef88 in base::MessagePumpCFRunLoopBase::RunWork at message_pump_mac.mm:291  #16	0x071fefcd in base::MessagePumpCFRunLoopBase::RunWorkSource at message_pump_mac.mm:269     </pre>