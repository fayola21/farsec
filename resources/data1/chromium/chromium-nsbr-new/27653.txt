<title>Issue 27653 -   chromium -    Window level resize event can fire inline with a window resize handler during a layout pass. - Project Hosting on Google Code</title> <pre> Chrome Version       : Chromium 4.0.242.0 (0)       1. Have an onresize handler append a bunch of nodes to the DOM. Suspected (although not confirmed since I have not   reduced to a small reproducing case yet) to involve changes in scrollable state.  2. Resize the window.  3. See the same onresize get called re-entrantly during a DOM mutation in the resize handler.      Window level resize should never be fired inline as a result of DOM mutation within a resize handler. The window   onresize should only fire in response to a change to the document level view.    I have not seen this behaviour in Safari 4 or the Webkit nightlies.      Bad nesting that in theory could lead to an infinite recursion. It also means you have odd entry points into your   javascript that &quot;seem&quot; to disobey the message queue.    I monitored the nesting and snuck in a break point to grab this stack trace:     	chrome.dll!WebCore::DOMWindow::dispatchEvent(WTF::PassRefPtr&lt;WebCore::Event&gt; prpEvent={...}    WTF::PassRefPtr&lt;WebCore::EventTarget&gt; prpTarget={...})  Line 1328	C++   	chrome.dll!WebCore::Document::dispatchWindowEvent(WTF::PassRefPtr&lt;WebCore::Event&gt; event={...}    WTF::PassRefPtr&lt;WebCore::EventTarget&gt; target={...})  Line 2895	C++   	chrome.dll!WebCore::EventHandler::sendResizeEvent()  Line 2482	C++   	chrome.dll!WebCore::FrameView::performPostLayoutTasks()  Line 1349	C++   	chrome.dll!WebCore::FrameView::layout(bool allowSubtree=true)  Line 684	C++   	chrome.dll!WebCore::Document::updateLayout()  Line 1359	C++   	chrome.dll!WebCore::Document::updateLayoutIgnorePendingStylesheets()  Line 1391	C++   	chrome.dll!WebCore::Element::clientWidth()  Line 352	C++   	chrome.dll!WebCore::ElementInternal::clientWidthAttrGetter(v8::Local&lt;v8::String&gt; name={...}  const   v8::AccessorInfo &amp; info={...})  Line 117 + 0x8 bytes	C++   	chrome.dll!v8::internal::Object::GetPropertyWithCallback(v8::internal::Object * receiver=0x055edf75    v8::internal::Object * structure=0x02fb7fcd  v8::internal::String * name=0x02d2f98d  v8::internal::Object *   holder=0x055edf75)  Line 172 + 0x26 bytes	C++   	chrome.dll!v8::internal::Object::GetProperty(v8::internal::Object * receiver=0x055edf75    v8::internal::LookupResult * result=0x0459e3ac  v8::internal::String * name=0x02d2f98d  PropertyAttributes *   attributes=0x0459e390)  Line 556 + 0x1d bytes	C++   	chrome.dll!v8::internal::LoadIC::Load(v8::internal::InlineCacheState state=UNINITIALIZED    v8::internal::Handle&lt;v8::internal::Object&gt; object={...}  v8::internal::Handle&lt;v8::internal::String&gt; name={...})    Line 681	C++   	chrome.dll!v8::internal::LoadIC_Miss(v8::internal::Arguments args={...})  Line 1310 + 0x2e bytes	C++   	02e5018b()	   	chrome.dll!v8::internal::Invoke(bool construct=false  v8::internal::Handle&lt;v8::internal::JSFunction&gt;   func={...}  v8::internal::Handle&lt;v8::internal::Object&gt; receiver={...}  int argc=1  v8::internal::Object * * *   args=0x0459e850  bool * has_pending_exception=0x0459e783)  Line 103 + 0x19 bytes	C++   	chrome.dll!v8::internal::Execution::Call(v8::internal::Handle&lt;v8::internal::JSFunction&gt; func={...}    v8::internal::Handle&lt;v8::internal::Object&gt; receiver={...}  int argc=1  v8::internal::Object * * * args=0x0459e850    bool * pending_exception=0x0459e783)  Line 129 + 0x1f bytes	C++   	chrome.dll!v8::Function::Call(v8::Handle&lt;v8::Object&gt; recv={...}  int argc=1  v8::Handle&lt;v8::Value&gt; *   argv=0x0459e850)  Line 2384 + 0x1d bytes	C++   	chrome.dll!WebCore::V8Proxy::callFunction(v8::Handle&lt;v8::Function&gt; function={...}  v8::Handle&lt;v8::Object&gt;   receiver={...}  int argc=1  v8::Handle&lt;v8::Value&gt; * args=0x0459e850)  Line 498 + 0x1f bytes	C++   	chrome.dll!WebCore::V8EventListener::callListenerFunction(WebCore::ScriptExecutionContext *   context=0x06de4034  v8::Handle&lt;v8::Value&gt; jsEvent={...}  WebCore::Event * event=0x07f26900)  Line 75 + 0x26 bytes	  C++   	chrome.dll!WebCore::V8AbstractEventListener::invokeEventHandler(WebCore::ScriptExecutionContext *   context=0x06de4034  WebCore::Event * event=0x07f26900  v8::Handle&lt;v8::Value&gt; jsEvent={...})  Line 144 + 0x1f bytes	  C++   	chrome.dll!WebCore::V8AbstractEventListener::handleEvent(WebCore::ScriptExecutionContext *   context=0x06de4034  WebCore::Event * event=0x07f26900)  Line 90	C++   	chrome.dll!WebCore::EventTarget::fireEventListeners(WebCore::Event * event=0x07f26900)  Line 297 + 0x35   bytes	C++   	chrome.dll!WebCore::DOMWindow::dispatchEvent(WTF::PassRefPtr&lt;WebCore::Event&gt; prpEvent={...}    WTF::PassRefPtr&lt;WebCore::EventTarget&gt; prpTarget={...})  Line 1328 + 0x11 bytes	C++   	chrome.dll!WebCore::Document::dispatchWindowEvent(WTF::PassRefPtr&lt;WebCore::Event&gt; event={...}    WTF::PassRefPtr&lt;WebCore::EventTarget&gt; target={...})  Line 2895	C++   	chrome.dll!WebCore::EventHandler::sendResizeEvent()  Line 2482	C++   	chrome.dll!WebKit::WebViewImpl::resize(const WebKit::WebSize &amp; newSize={...})  Line 799	C++   	chrome.dll!RenderWidget::OnResize(const gfx::Size &amp; new_size={...}  const gfx::Rect &amp; resizer_rect={...})    Line 221 + 0x2b bytes	C++   	chrome.dll!RenderView::OnResize(const gfx::Size &amp; new_size={...}  const gfx::Rect &amp; resizer_rect={...})    Line 3440	C++   	chrome.dll!DispatchToMethod&lt;RenderWidget void (__thiscall RenderWidget::*)(gfx::Size const &amp; gfx::Rect   const &amp;) gfx::Size gfx::Rect&gt;(RenderWidget * obj=0x0446d200  void (const gfx::Size &amp;  const gfx::Rect &amp;)*   method=0x568cc280  const Tuple2&lt;gfx::Size gfx::Rect&gt; &amp; arg={...})  Line 429 + 0x26 bytes	C++   	chrome.dll!IPC::MessageWithTuple&lt;Tuple2&lt;gfx::Size gfx::Rect&gt; &gt;::Dispatch&lt;RenderWidget void (__thiscall   RenderWidget::*)(gfx::Size const &amp; gfx::Rect const &amp;)&gt;(const IPC::Message * msg=0x06f11ea8  RenderWidget *   obj=0x0446d200  void (const gfx::Size &amp;  const gfx::Rect &amp;)* func=0x568cc280)  Line 999 + 0x23 bytes	C++   	chrome.dll!RenderWidget::OnMessageReceived(const IPC::Message &amp; msg={...})  Line 139 + 0x38 bytes	C++   	chrome.dll!RenderView::OnMessageReceived(const IPC::Message &amp; message={...})  Line 513 + 0xc bytes	C++   	chrome.dll!MessageRouter::RouteMessage(const IPC::Message &amp; msg={...})  Line 41 + 0x13 bytes	C++   	chrome.dll!MessageRouter::OnMessageReceived(const IPC::Message &amp; msg={...})  Line 32 + 0x13 bytes	C++   	chrome.dll!ChildThread::OnMessageReceived(const IPC::Message &amp; msg={...})  Line 118 + 0x17 bytes	C++   	chrome.dll!IPC::ChannelProxy::Context::OnDispatchMessage(const IPC::Message &amp; message={...})  Line 204 +   0x1b bytes	C++   	chrome.dll!DispatchToMethod&lt;IPC::ChannelProxy::Context void (__thiscall   IPC::ChannelProxy::Context::*)(IPC::Message const &amp;) IPC::Message&gt;(IPC::ChannelProxy::Context * obj=0x02b07d80    void (const IPC::Message &amp;)* method=0x564204e0  const Tuple1&lt;IPC::Message&gt; &amp; arg={...})  Line 422 + 0xf bytes	C++   	chrome.dll!RunnableMethod&lt;IPC::ChannelProxy::Context void (__thiscall   IPC::ChannelProxy::Context::*)(IPC::Message const &amp;) Tuple1&lt;IPC::Message&gt; &gt;::Run()  Line 277 + 0x1e bytes	C++   	chrome.dll!MessageLoop::RunTask(Task * task=0x06f11e80)  Line 320 + 0xf bytes	C++   	chrome.dll!MessageLoop::DeferOrRunPendingTask(const MessageLoop::PendingTask &amp; pending_task={...})  Line   331	C++   	chrome.dll!MessageLoop::DoWork()  Line 435 + 0xc bytes	C++   	chrome.dll!base::MessagePumpForUI::DoRunLoop()  Line 209 + 0x1d bytes	C++   	chrome.dll!base::MessagePumpWin::RunWithDispatcher(base::MessagePump::Delegate * delegate=0x0459f988    base::MessagePumpWin::Dispatcher * dispatcher=0x00000000)  Line 52 + 0xf bytes	C++   	chrome.dll!base::MessagePumpWin::Run(base::MessagePump::Delegate * delegate=0x0459f988)  Line 78 + 0x1c   bytes	C++   	chrome.dll!MessageLoop::RunInternal()  Line 205 + 0x2a bytes	C++   	chrome.dll!MessageLoop::RunHandler()  Line 178	C++   	chrome.dll!MessageLoop::Run()  Line 156	C++   	chrome.dll!base::Thread::Run(MessageLoop * message_loop=0x0459f988)  Line 133	C++   	chrome.dll!base::Thread::ThreadMain()  Line 153 + 0x16 bytes	C++   	chrome.dll!`anonymous namespace'::ThreadFunc(void * closure=0x0441e3c0)  Line 26 + 0xf bytes	C++   	kernel32.dll!773ce4a5() 	   	[Frames below may be incorrect and/or missing  no symbols loaded for kernel32.dll]	   	ntdll.dll!77cfcfed() 	   	ntdll.dll!77cfd1ff() 	     </pre>