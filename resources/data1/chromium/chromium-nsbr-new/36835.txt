<title>Issue 36835 -   chromium -    With Windows SChannel  an SSL connection can't be used after receiving a no_renegotiation alert - Project Hosting on Google Code</title> <pre> This issue documents what I believe is a limitation of Windows SChannel.    TLS has a no_renegotiation alert message.  It is always sent at the  warning level (as opposed to the fatal level).  So we should be able to  continue to use an SSL connection after receiving a no_renegotiation  alert message.  NSS allows us to do that.    When testing Chrome on Windows Vista with  <a href="https://ssltls.de:1445/otherciphers/ffs.jpg">https://ssltls.de:1445/otherciphers/ffs.jpg</a>  which requests  renegotiation but requires new-style secure renegotiation  I found that  Windows SChannel doesn't seem to allow us to continue to use an SSL  connection after it receives a no_renegotiation alert.    Here is the sequence of events:    During renegotiation  Chrome reads in 23 bytes  which I presume are the  no_renegotiation alert message.  Chrome passes them to SChannel's  InitializeSecurityContext function  which returns SEC_I_NO_RENEGOTIATION  (0x00090360)  indicating no_renegotiation was received.  Note that  SEC_I_NO_RENEGOTIATION is not an error code because it doesn't have the  SEC_E_ prefix.    Next  Chrome reads in 542 bytes  which I believe are the HTML error page  from the server.    If I pass them to InitializeSecurityContext  it returns  SEC_E_INVALID_TOKEN (0x80090308).    If I pass them to DecryptMessage instead  it returns  SEC_E_DECRYPT_FAILURE (0x80090330).    So it's impossible to continue after InitializeSecurityContext returns  SEC_I_NO_RENEGOTIATION.    Using Firefox (versions that don't support secure renegotiation)  I can  view the HTML error page from <a href="https://ssltls.de:1445/otherciphers/ffs.jpg">https://ssltls.de:1445/otherciphers/ffs.jpg</a>.    I did a web search for SEC_I_NO_RENEGOTIATION and found two reports of  the server-side version of this problem:    1. <a href="http://www.ureader.com/msg/16592364.aspx">http://www.ureader.com/msg/16592364.aspx</a>  <a href="http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2">http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2</a>  009-06/msg00054.html    2. <a href="http://stackoverflow.com/questions/223044/dealing-with-sec-i-">http://stackoverflow.com/questions/223044/dealing-with-sec-i-</a>  renegotiate-and-tls1-alert-no-renegotiation-in-schannel    In Chrome  I will add an ERR_SSL_NO_RENEGOTIATION error code to report  this condition. </pre>