<title>Issue 32814 -   chromium -    Crash in lock_impl_posix (via RendererWebKitClientImpl::databaseGetFileAttributes) - Project Hosting on Google Code</title> <pre> I'm working on an extension that uses the web database SQL API.  When running a query against the DB  my extension process crashes -- I can reproduce it pretty easily (I can   demo this to someone in MTV if interested).  This stack trace is from a ToT build on OS X:    #0  DebugUtil::BreakDebugger () at /Users/skrul/dev/chromium/src/base/debug_util_posix.cc:192  #1  0x076943e8 in logging::LogMessage::~LogMessage (this=0xb01a3e50) at /Users/skrul/dev/chromium/src/base/logging.cc:587  #2  0x07693525 in LockImpl::~LockImpl (this=0x1ca3e8) at /Users/skrul/dev/chromium/src/base/lock_impl_posix.cc:31  #3  0x072ef1e5 in Lock::~Lock (this=0x1ca3e8) at lock.h:15  #4  0x076d89b2 in base::WaitableEvent::WaitableEventKernel::~WaitableEventKernel (this=0x1ca3e0) at waitable_event.h:144  #5  0x076d89dd in base::RefCountedThreadSafe&lt;base::WaitableEvent::WaitableEventKernel    base::DefaultRefCountedThreadSafeTraits&lt;base::WaitableEvent::WaitableEventKernel&gt; &gt;::DeleteInternal (x=0x1ca3e0) at ref_counted.h:146  #6  0x076d89fb in base::DefaultRefCountedThreadSafeTraits&lt;base::WaitableEvent::WaitableEventKernel&gt;::Destruct (x=0x1ca3e0) at ref_counted.h:112  #7  0x076d8a1e in base::RefCountedThreadSafe&lt;base::WaitableEvent::WaitableEventKernel    base::DefaultRefCountedThreadSafeTraits&lt;base::WaitableEvent::WaitableEventKernel&gt; &gt;::Release (this=0x1ca3e0) at ref_counted.h:140  #8  0x076d8a3c in scoped_refptr&lt;base::WaitableEvent::WaitableEventKernel&gt;::~scoped_refptr (this=0xb01a4048) at ref_counted.h:238  #9  0x076d649d in base::WaitableEvent::~WaitableEvent (this=0xb01a4048) at /Users/skrul/dev/chromium/src/base/waitable_event_posix.cc:42  #10 0x076002c1 in DBMessageFilter::SendAndWait&lt;long&gt; (this=0x131000  message=0x1cf9a0  message_id=14  default_result=-1) at db_message_filter.h:57  #11 0x075fbf3a in RendererWebKitClientImpl::databaseGetFileAttributes (this=0x1435b0  vfs_file_name=@0xb01a40bc) at   /Users/skrul/dev/chromium/src/chrome/renderer/renderer_webkitclient_impl.cc:352  #12 0x07ee240e in WebCore::ChromiumBridge::databaseGetFileAttributes (vfsFileName=@0xb01a40f8) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebKit/chromium/src/ChromiumBridge.cpp:328  #13 0x083f610b in (anonymous namespace)::chromiumAccess (fileName=0x84afb0 &quot;chrome-extension_neegpkbglbcagklocfpmjglbhpnllmid_0/greasefire#-journal&quot;  flag=0    res=0xb01a4164) at /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../platform/sql/chromium/SQLiteFileSystemChromiumPosix.cpp:120  #14 0x07cf5a28 in sqlite3OsAccess (pVfs=0x9dfb240  zPath=0x84afb0 &quot;chrome-extension_neegpkbglbcagklocfpmjglbhpnllmid_0/greasefire#-journal&quot;  flags=0    pResOut=0xb01a4164) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/os.c:135  #15 0x07cfd782 in hasHotJournal (pPager=0x84ae08  pExists=0xb01a41cc) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/pager.c:3405  #16 0x07cfdb36 in sqlite3PagerSharedLock (pPager=0x84ae08) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/pager.c:3594  #17 0x07cd0058 in lockBtree (pBt=0x166b18) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/btree.c:2205  #18 0x07cd062f in sqlite3BtreeBeginTrans (p=0x166ad8  wrflag=0) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/btree.c:2461  #19 0x07d1ccc8 in sqlite3VdbeExec (p=0x19d3d8) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/vdbe.c:2703  #20 0x07d21cf6 in sqlite3Step (p=0x19d3d8) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/vdbeapi.c:344  #21 0x07d21f1d in sqlite3_step (pStmt=0x19d3d8) at /Users/skrul/dev/chromium/src/third_party/sqlite/src/vdbeapi.c:403  #22 0x083f3dd4 in WebCore::SQLiteStatement::step (this=0xb01a4c7c) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../platform/sql/SQLiteStatement.cpp:81  #23 0x0859238a in WebCore::SQLStatement::execute (this=0x1abb50  db=0x168200) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/SQLStatement.cpp:112  #24 0x08594141 in WebCore::SQLTransaction::runCurrentStatement (this=0x170560) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/SQLTransaction.cpp:353  #25 0x085943db in WebCore::SQLTransaction::runStatements (this=0x170560) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/SQLTransaction.cpp:304  #26 0x08594eec in WebCore::SQLTransaction::performNextStep (this=0x170560) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/SQLTransaction.cpp:185  #27 0x0858a008 in WebCore::DatabaseTransactionTask::doPerformTask (this=0x19d900) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/DatabaseTask.cpp:145  #28 0x0858a29d in WebCore::DatabaseTask::performTask (this=0x19d900) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/DatabaseTask.cpp:80  #29 0x0858ab5c in WebCore::DatabaseThread::databaseThread (this=0x1680a0) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/DatabaseThread.cpp:95  #30 0x0858ad09 in WebCore::DatabaseThread::databaseThreadStart (vDatabaseThread=0x1680a0) at   /Users/skrul/dev/chromium/src/third_party/WebKit/WebCore/WebCore.gyp/../storage/DatabaseThread.cpp:82  #31 0x0888e0dc in WTF::threadEntryPoint (contextData=0x1649c0) at   /Users/skrul/dev/chromium/src/third_party/WebKit/JavaScriptCore/JavaScriptCore.gyp/../wtf/Threading.cpp:64  #32 0x929b6155 in _pthread_start ()  #33 0x929b6012 in thread_start ()   </pre>