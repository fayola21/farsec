<title>Issue 30926 -   chromium -    sandbox fails on NFS mounted /tmp dir - remove rmdir from sandbox.c - Project Hosting on Google Code</title> <pre> ./sandbox/linux/suid/sandbox.c tries to create a sandbox directory  but   before using it and after getting a handle  it rmdir's the directory.      const char* temp_dir = mkdtemp(kTempDirectoryTemplate);    [...]    const int chroot_dir_fd = open(temp_dir  O_DIRECTORY | O_RDONLY);    [..]    if (rmdir(temp_dir))     [..]    The problem is that this trick does not work on NFS mounted boxes. The   handle to this directory will becomes stale and unusable. The following   fchown call is the first recognize that  and that's what you get on the   console:    &quot;fchown: Stale NFS file handle&quot;    My suggestion is to remove rmdir.    This in-the-air hanging directory trick works only for local filesystems   because the kernel can do proper reference counting and is kind enough to   not simply bark to userspace on subsequent uses.    I do not see any particular security gain from that trick  as all other   users can access this directory anyway and protecting against root is first   of all futile and second not possible  as he/she can access this directory   anyway through /proc/&lt;pid&gt;/fd/.   </pre>