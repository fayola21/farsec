<title>Issue 26240 -   chromium -    Browser crash @ RenderWidgetHostViewWin::OnImeSetContext() - Project Hosting on Google Code</title> <pre> ToT(r 30463).    We regressed here quite few times. Filing this as a separate issue  instead  re-cycling them.    -Navigate to a SSL error/Malware page and kill the page.  -Click on 'Back to safe' button.    Browser window crashes.    Haunting for the regression window.    Crash Analysis  ##############  FAULTING_IP:   chrome_1c30000!RenderWidgetHostViewWin::OnImeSetContext+23  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host_view_win.cc  @ 954]  01e43d33 8b4828          mov     ecx dword ptr [eax+28h]    EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)  ExceptionAddress: 01e43d33  (chrome_1c30000!RenderWidgetHostViewWin::OnImeSetContext+0x00000023)     ExceptionCode: c0000005 (Access violation)    ExceptionFlags: 00000000  NumberParameters: 2     Parameter[0]: 00000000     Parameter[1]: 00000028  Attempt to read from address 00000028    PROCESS_NAME:  chrome.exe    ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot; referenced  memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at &quot;0x%08lx&quot;  referenced memory at &quot;0x%08lx&quot;. The memory could not be &quot;%s&quot;.    EXCEPTION_PARAMETER1:  00000000    EXCEPTION_PARAMETER2:  00000028    READ_ADDRESS:  00000028     FOLLOWUP_IP:   chrome_1c30000!RenderWidgetHostViewWin::OnImeSetContext+23  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host_view_win.cc  @ 954]  01e43d33 8b4828          mov     ecx dword ptr [eax+28h]    FAULTING_THREAD:  00001fec    DEFAULT_BUCKET_ID:  INVALID_POINTER_READ    PRIMARY_PROBLEM_CLASS:  INVALID_POINTER_READ    BUGCHECK_STR:   APPLICATION_FAULT_INVALID_POINTER_READ_NULL_CLASS_PTR_DEREFERENCE    LAST_CONTROL_TRANSFER:  from 01e45a06 to 01e43d33    STACK_TEXT:    0013eca8 01e45a06 00000281 00000000 c000000f  chrome_1c30000!RenderWidgetHostViewWin::OnImeSetContext+0x23  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host_view_win.cc  @ 954]  0013eccc 01edad1d 001d0872 00000281 00000000  chrome_1c30000!RenderWidgetHostViewWin::ProcessWindowMessage+0x236  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host_view_win.h  @ 79]  0013ed1c 7e418734 074de780 00000281 00000000  chrome_1c30000!ATL::CWindowImplBaseT&lt;WTL::CRichEditCtrlT&lt;ATL::CWindow&gt; ATL::CWinTraits&lt;1342177664 0&gt;  &gt;::WindowProc+0x5d [c:program files (x86)microsoft visual studio  8vcatlmfcincludeatlwin.h @ 3078]  0013ed48 7e418816 073bb258 001d0872 00000281 user32!InternalCallWinProc+0x28  0013edb0 7e42927b 00000000 073bb258 001d0872  user32!UserCallWinProcCheckWow+0x150  0013edec 7e4292e3 00707e00 00698b00 00000000 user32!SendMessageWorker+0x4a5  0013ee0c 76392b12 001d0872 00000281 00000000 user32!SendMessageW+0x7f  0013ee40 7e46b90e 001d0872 00000000 00000000 imm32!ImmSetActiveContext+0x134  0013ee5c 7e46bdf2 001d0872 00000000 006975a0 user32!FocusSetIMCContext+0x28  0013f0b0 7e46c8cf 001a0c28 00000287 00000018 user32!ImeSystemHandler+0x2a0  0013f0d4 7e428eec 00460750 00000287 00000018 user32!ImeWndProcWorker+0x29d  0013f0fc 7c90e473 0013f10c 00000018 006975a0 user32!__fnDWORD+0x24  0013f120 7e42b1a8 01e43905 001d0872 01d97cf0  ntdll!KiUserCallbackDispatcher+0x13  0013f140 01d9904e 074de3c0 00000000 01000000 user32!NtUserDestroyWindow+0xc  0013f1e0 01d602d7 0870a470 074de3c0 01d61110  chrome_1c30000!RenderWidgetHost::Shutdown+0xae  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host.cc  @ 122]  0013f1ec 01d61110 074de3c0 0870a470 0000000f  chrome_1c30000!InterstitialPage::Hide+0x57  [c:bslavechromium-rel-xpbuildsrcchromebrowsertab_contentsinterstitial_page.cc  @ 239]  0013f28c 01da6878 0000000f 074de3c0 00000000  chrome_1c30000!InterstitialPage::DontProceed+0x90  [c:bslavechromium-rel-xpbuildsrcchromebrowsertab_contentsinterstitial_page.cc  @ 455]  0013f32c 01da4084 074de870 0013f560 00000001  chrome_1c30000!SafeBrowsingBlockingPage::DontProceed+0x1d8  [c:bslavechromium-rel-xpbuildsrcchromebrowsersafe_browsingsafe_browsing_blocking_page.cc  @ 431]  0013f4dc 01d5f9e8 0013f560 0013f54c 01cb92ca  chrome_1c30000!SafeBrowsingBlockingPage::CommandReceived+0x3e4  [c:bslavechromium-rel-xpbuildsrcchromebrowsersafe_browsingsafe_browsing_blocking_page.cc  @ 332]  0013f4e8 01cb92ca 0013f560 00000001 074de870  chrome_1c30000!InterstitialPage::DomOperationResponse+0x18  [c:bslavechromium-rel-xpbuildsrcchromebrowsertab_contentsinterstitial_page.cc  @ 379]  0013f54c 01cbe8e7 0013f560 00000001 07522d90  chrome_1c30000!RenderViewHost::OnMsgDomOperationResponse+0x2a  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_view_host.cc  @ 1204]  0013f584 01cc1951 07522d90 074de870 01cb92a0  chrome_1c30000!IPC::MessageWithTuple&lt;Tuple2&lt;std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; int&gt; &gt;::Dispatch&lt;RenderViewHost void (__thiscall  RenderViewHost::*)(std::basic_string&lt;char std::char_traits&lt;char&gt; std::allocator&lt;char&gt;  &gt; const &amp; int)&gt;+0x47  [c:bslavechromium-rel-xpbuildsrcipcipc_message_utils.h @ 1000]  0013f638 01e0efb1 07522d90 0013fa5c 072c5c80  chrome_1c30000!RenderViewHost::OnMessageReceived+0x3c1  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_view_host.cc  @ 769]  0013f6e4 01e38877 07522d90 07522d80 01f9528e  chrome_1c30000!BrowserRenderProcessHost::OnMessageReceived+0x1e1  [c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostbrowser_render_process_host.cc  @ 832]  0013f6f0 01f9528e 00000000 0013fa5c 00000001  chrome_1c30000!RunnableMethod&lt;CancelableRequest&lt;CallbackRunner&lt;Tuple2&lt;int std::vector&lt;PageUsageData  * std::allocator&lt;PageUsageData *&gt; &gt; *&gt; &gt; &gt; void (__thiscall  CancelableRequest&lt;CallbackRunner&lt;Tuple2&lt;int std::vector&lt;PageUsageData  * std::allocator&lt;PageUsageData *&gt; &gt; *&gt; &gt;  &gt;::*)(Tuple2&lt;int std::vector&lt;PageUsageData * std::allocator&lt;PageUsageData  *&gt; &gt; *&gt; const &amp;) Tuple1&lt;Tuple2&lt;int std::vector&lt;PageUsageData  * std::allocator&lt;PageUsageData *&gt; &gt; *&gt; &gt; &gt;::Run+0x17  [c:bslavechromium-rel-xpbuildsrcbasetask.h @ 277]  0013f794 01f95dba 07522d80 00f68060 00f68040  chrome_1c30000!MessageLoop::RunTask+0x7e  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 321]  0013f7e4 01fb963a 00000000 00f68040 00000000  chrome_1c30000!MessageLoop::DoWork+0x1ea  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 443]  0013f814 01fb8802 00f7e0c0 0013fa5c 0013fa5c  chrome_1c30000!base::MessagePumpForUI::DoRunLoop+0x5a  [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.cc @ 210]  0013f834 01f956af 0013fa5c 0013f908 00f87000  chrome_1c30000!base::MessagePumpWin::RunWithDispatcher+0x42  [c:bslavechromium-rel-xpbuildsrcbasemessage_pump_win.cc @ 54]  0013f8dc 01f96337 00000001 00000000 0013f908  chrome_1c30000!MessageLoop::RunInternal+0xaf  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 200]  0013f8f8 01c49cdf 0013f908 00f87000 029b0098  chrome_1c30000!MessageLoopForUI::Run+0x67  [c:bslavechromium-rel-xpbuildsrcbasemessage_loop.cc @ 606]  0013f920 01c4bd8f 00f700e0 00f68480 ffffffff chrome_1c30000!`anonymous  namespace'::RunUIMessageLoop+0x1f  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser_main.cc @ 153]  0013fcbc 01c35a49 0013fda4 00000008 01c30000  chrome_1c30000!BrowserMain+0x1bef  [c:bslavechromium-rel-xpbuildsrcchromebrowserbrowser_main.cc @ 880]  0013fe34 00403b67 00400000 0013fec8 0002127e  chrome_1c30000!ChromeMain+0x7f9  [c:bslavechromium-rel-xpbuildsrcchromeappchrome_dll_main.cc @ 601]  0013ff28 0042a611 00400000 00000000 0002127e chrome!wWinMain+0x287  [c:bslavechromium-rel-xpbuildsrcchromeappchrome_exe_main.cc @ 103]  0013ffc0 7c817077 7cffa450 01ca58cb 7ffdf000 chrome!__tmainCRTStartup+0x176  [f:ddvctoolscrt_bldself_x86crtsrccrt0.c @ 324]  0013fff0 00000000 0042a67a 00000000 00000000 kernel32!BaseProcessStart+0x23      STACK_COMMAND:  ~0s; .ecxr ; kb    FAULTING_SOURCE_CODE:    No source found for  'c:bslavechromium-rel-xpbuildsrcchromebrowserrenderer_hostrender_widget_host_view_win.cc'      SYMBOL_STACK_INDEX:  0    SYMBOL_NAME:  chrome!RenderWidgetHostViewWin::OnImeSetContext+23    FOLLOWUP_NAME:  MachineOwner    MODULE_NAME: chrome_1c30000    IMAGE_NAME:  chrome.dll    DEBUG_FLR_IMAGE_TIMESTAMP:  4ae9de5e    FAILURE_BUCKET_ID:   INVALID_POINTER_READ_c0000005_chrome.dll!RenderWidgetHostViewWin::OnImeSetContext    BUCKET_ID:   APPLICATION_FAULT_INVALID_POINTER_READ_NULL_CLASS_PTR_DEREFERENCE_chrome!RenderWidgetHostViewWin::OnImeSetContext+23    WATSON_STAGEONE_URL:   <a href="http://watson.microsoft.com/StageOne/chrome_exe/0_0_0_0/4ae9de8a/chrome_dll/4_0_229_0/4ae9de5e/c0000005/00213d33.htm?Retriage=1">http://watson.microsoft.com/StageOne/chrome_exe/0_0_0_0/4ae9de8a/chrome_dll/4_0_229_0/4ae9de5e/c0000005/00213d33.htm?Retriage=1</a>       </pre>