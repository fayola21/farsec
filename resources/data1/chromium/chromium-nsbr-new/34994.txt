<title>Issue 34994 -   chromium -    Heap leak checker reports leaks in JavaScript -- probably V8 is shut down improperly - Project Hosting on Google Code</title> <pre> Heap leak checker reports a number of memory leaks in Chromium tests that   execute JavaScripts using V8.  (see   <a href="http://build.chromium.org/buildbot/waterfall.fyi/builders/Linux%20Heapcheck">http://build.chromium.org/buildbot/waterfall.fyi/builders/Linux%20Heapcheck</a>  /builds/1803/steps/heapcheck%20test:%20unit/logs/stdio for a full report)    To reproduce  run:  HEAPCHECK=strict sconsbuild/Debug/unit_tests --  gtest_filter=RenderViewTest.*:ExtensionAPIClientTest.*    Leak of 102 bytes in 1 objects allocated from:  	@ 0x20caebf WTF::fastMalloc  	@ 0x1bb0a50 WebCore::StringImpl::createUninitialized  	@ 0x18e83a4 WebCore::String::createUninitialized  	@ 0x18e8636 WebCore::StringTraits::fromV8String  	@ 0x18e86df WebCore::v8StringToWebCoreString  	@ 0x18e87a9 WebCore::v8StringToWebCoreString  	@ 0x18e6e7e WebCore::v8ValueToWebCoreString  	@ 0x132d660 WebCore::toWebCoreString  	@ 0x1ddca68 WebCore::V8ConsoleMessage::handler  	@ 0x16a93be v8::internal::MessageHandler::ReportMessage  	@ 0x173f6aa v8::internal::Top::ReportPendingMessages  	@ 0x165d1f1 v8::internal::Invoke  	@ 0x165d69c v8::internal::Execution::Call  	@ 0x16335fe v8::Script::Run  	@ 0x18fedc2 WebCore::V8Proxy::runScript  	@ 0x18ff088 WebCore::V8Proxy::evaluate  	@ 0x18def9f WebCore::ScriptController::evaluate  	@ 0x18d538c WebCore::ScriptController::executeScript  	@ 0x133b330 WebKit::WebFrameImpl::executeScript  	@ 0x812711 RenderViewTest::ExecuteJavaScript  	@ 0x7f6a81 ExtensionAPIClientTest::ExpectJsFail  	@ 0x7f343c ExtensionAPIClientTest_GetWindow_Test::TestBody  	@ 0x1080dc3 testing::Test::Run  	@ 0x1084534 testing::internal::TestInfoImpl::Run  	@ 0x108466a testing::TestCase::Run  	@ 0x10850c9 testing::internal::UnitTestImpl::RunAllTests  	@ 0x1085219 testing::UnitTest::Run  	@ 0xf8cd39 TestSuite::Run  	@ 0xf8b935 main  	@ 0x2ad3b51161c4 __libc_start_main    Leak of 46 bytes in 1 objects allocated from:  	@ 0x20caebf WTF::fastMalloc  	@ 0x1bb0a50 WebCore::StringImpl::createUninitialized  	@ 0x18e83a4 WebCore::String::createUninitialized  	@ 0x18e8636 WebCore::StringTraits::fromV8String  	@ 0x18e86df WebCore::v8StringToWebCoreString  	@ 0x18e87a9 WebCore::v8StringToWebCoreString  	@ 0x18e6e7e WebCore::v8ValueToWebCoreString  	@ 0x132d660 WebCore::toWebCoreString  	@ 0x207a26c WebCore::String  	@ 0x2047629 WebCore::ElementInternal::getAttributeCallback  	@ 0x1649fdf v8::internal::HandleApiCallHelper  	@ 0x164a0a3 v8::internal::Builtin_Impl_HandleApiCall  	@ 0x164a0ca v8::internal::Builtin_HandleApiCall  	@ 0x2aaab093c22a 0x00002aaab093c22a  	@ 0x2aaab09982cc 0x00002aaab09982cc  	@ 0x2aaab0950418 0x00002aaab0950418  	@ 0x2aaab093c5cb 0x00002aaab093c5cb  	@ 0x165d17d v8::internal::Invoke  	@ 0x165d69c v8::internal::Execution::Call  	@ 0x16335fe v8::Script::Run  	@ 0x18fedc2 WebCore::V8Proxy::runScript  	@ 0x18ff088 WebCore::V8Proxy::evaluate  	@ 0x18def9f WebCore::ScriptController::evaluate  	@ 0x18d538c WebCore::ScriptController::executeScript  	@ 0x133b330 WebKit::WebFrameImpl::executeScript  	@ 0x812711 RenderViewTest::ExecuteJavaScript  	@ 0x807e59 RenderViewTest_OnSetTextDirection_Test::TestBody  	@ 0x1080dc3 testing::Test::Run  	@ 0x1084534 testing::internal::TestInfoImpl::Run  	@ 0x108466a testing::TestCase::Run  	@ 0x10850c9 testing::internal::UnitTestImpl::RunAllTests  	@ 0x1085219 testing::UnitTest::Run    Leak of 32 bytes in 1 objects allocated from:  	@ 0x18e855d WebCore::v8StringToWebCoreString  	@ 0x18d9d23 WebCore::v8StringToAtomicWebCoreString  	@ 0x18d6104 WebCore::V8DOMWindow::namedPropertyGetter  	@ 0x16bc13a   v8::internal::JSObject::GetPropertyAttributeWithInterceptor  	@ 0x16bc2be v8::internal::JSObject::GetPropertyAttribute  	@ 0x16bbe15   v8::internal::JSObject::GetPropertyAttributeWithReceiver  	@ 0x163d781 v8::internal::JSObject::GetPropertyAttribute  	@ 0x170fd27 v8::internal::Runtime_DeclareGlobals  	@ 0x2aaab093c22a 0x00002aaab093c22a  	@ 0x2aaab0997aef 0x00002aaab0997aef  	@ 0x2aaab0950418 0x00002aaab0950418  	@ 0x2aaab093c5cb 0x00002aaab093c5cb  	@ 0x165d17d v8::internal::Invoke  	@ 0x165d69c v8::internal::Execution::Call  	@ 0x16335fe v8::Script::Run  	@ 0x18fedc2 WebCore::V8Proxy::runScript  	@ 0x18ff088 WebCore::V8Proxy::evaluate  	@ 0x18def9f WebCore::ScriptController::evaluate  	@ 0x18d538c WebCore::ScriptController::executeScript  	@ 0x133b330 WebKit::WebFrameImpl::executeScript  	@ 0x812711 RenderViewTest::ExecuteJavaScript  	@ 0x4a11a1   RenderViewTest_ExtensionMessagesOpenChannel_Test::TestBody  	@ 0x1080dc3 testing::Test::Run  	@ 0x1084534 testing::internal::TestInfoImpl::Run  	@ 0x108466a testing::TestCase::Run  	@ 0x10850c9 testing::internal::UnitTestImpl::RunAllTests  	@ 0x1085219 testing::UnitTest::Run  	@ 0xf8cd39 TestSuite::Run  	@ 0xf8b935 main  	@ 0x2ad3b51161c4 __libc_start_main    (and so on)    Note that the addresses above v8::internal::Invoke are usually unknown --   that's probably because bytecode is executed at these places. </pre>