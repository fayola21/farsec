CaseInsensitiveMap concurrency issue    &#91;10/25/2010 -:- 03:27:22 PM&#93; &lt;tarjei&gt; cibsen: I get a few of these errors on a route using SEDA queues:&#91;10/25/2010 -:- 03:27:43 PM&#93; &lt;tarjei&gt; Caused by: &#91;java.util.ConcurrentModificationException - null&#93;&#91;10/25/2010 -:- 03:27:44 PM&#93; &lt;tarjei&gt; java.util.ConcurrentModificationException&#91;10/25/2010 -:- 03:27:44 PM&#93; &lt;tarjei&gt; at java.util.HashMap$HashIterator.nextEntry(HashMap.java:810)&#91;10/25/2010 -:- 03:27:44 PM&#93; &lt;tarjei&gt; at java.util.HashMap$EntryIterator.next(HashMap.java:851)&#91;10/25/2010 -:- 03:27:44 PM&#93; &lt;tarjei&gt; at java.util.HashMap$EntryIterator.next(HashMap.java:849)&#91;10/25/2010 -:- 03:27:46 PM&#93; &lt;tarjei&gt; at org.apache.camel.util.CaseInsensitiveMap.entrySet(CaseInsensitiveMap.java:120)&#91;10/25/2010 -:- 03:27:49 PM&#93; &lt;tarjei&gt; at org.apache.camel.util.CaseInsensitiveMap.putAll(CaseInsensitiveMap.java:86)&#91;10/25/2010 -:- 03:27:51 PM&#93; &lt;tarjei&gt; at org.apache.camel.impl.MessageSupport.copyFrom(MessageSupport.java:142)&#91;10/25/2010 -:- 03:27:54 PM&#93; &lt;tarjei&gt; at org.apache.camel.impl.DefaultMessage.copyFrom(DefaultMessage.java:52)&#91;10/25/2010 -:- 03:27:56 PM&#93; &lt;tarjei&gt; at org.apache.camel.util.ExchangeHelper.copyResults(ExchangeHelper.java:215)&#91;10/25/2010 -:- 03:27:59 PM&#93; &lt;tarjei&gt; at org.apache.camel.processor.Pipeline.process(Pipeline.java:128)&#91;10/25/2010 -:- 03:28:01 PM&#93; &lt;tarjei&gt; at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:99)&#91;10/25/2010 -:- 03:28:05 PM&#93; &lt;tarjei&gt; at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)&#91;10/25/2010 -:- 03:28:08 PM&#93; &lt;tarjei&gt; at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)&#91;10/25/2010 -:- 03:28:11 PM&#93; &lt;tarjei&gt; at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)&#91;10/25/2010 -:- 03:28:14 PM&#93; &lt;tarjei&gt; at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)&#91;10/25/2010 -:- 03:28:17 PM&#93; &lt;tarjei&gt; at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)&#91;10/25/2010 -:- 03:28:20 PM&#93; &lt;tarjei&gt; at org.apache.camel.component.seda.SedaConsumer.sendToConsumers(SedaConsumer.java:170)&#91;10/25/2010 -:- 03:28:23 PM&#93; &lt;tarjei&gt; at org.apache.camel.component.seda.SedaConsumer.run(SedaConsumer.java:112)&#91;10/25/2010 -:- 03:28:25 PM&#93; &lt;tarjei&gt; at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&#91;10/25/2010 -:- 03:28:28 PM&#93; &lt;tarjei&gt; at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&#91;10/25/2010 -:- 03:28:31 PM&#93; &lt;tarjei&gt; at java.lang.Thread.run(Thread.java:636)&#91;10/25/2010 -:- 03:28:34 PM&#93; &lt;tarjei&gt; It seems to me to be an error completely within Camel so I thought I'd report it.&#91;10/25/2010 -:- 03:30:26 PM&#93; &lt;tarjei&gt; I got the error about 10/30 times having run about 5m messages through the different routes running in that jvm&#91;10/25/2010 -:- 03:51:36 PM&#93; &lt;cibsen&gt; and do your prod server have more cpu cores?&#91;10/25/2010 -:- 03:51:42 PM&#93; &lt;cibsen&gt; ibm  sun jdk?&#91;10/25/2010 -:- 03:51:51 PM&#93; &lt;tarjei&gt; Yes - 4. This is openjdk&#91;10/25/2010 -:- 03:51:54 PM&#93; &lt;tarjei&gt; both places&#91;10/25/2010 -:- 03:52:03 PM&#93; &lt;cibsen&gt; what os?&#91;10/25/2010 -:- 03:52:22 PM&#93; &lt;tarjei&gt; Centos 5&#91;10/25/2010 -:- 03:52:36 PM&#93; &lt;cibsen&gt; yeah kinda figured when you said openjdk&#91;10/25/2010 -:- 03:53:06 PM&#93; &lt;tarjei&gt; 1.6.0-17   