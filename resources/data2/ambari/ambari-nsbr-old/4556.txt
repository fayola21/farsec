Refactor and Unit tests for host summary       