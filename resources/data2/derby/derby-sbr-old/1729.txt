Invoking Java stored procedure that contains GRANT or REVOKE statement with CONTAINS SQL should fail.    In Derby SQL authorization mode  invoking Java stored procedure that contains GRANT or REVOKE statement with CONTAINS SQL from a trigger should fail but in the following test  it successfully executed the trigger action. Attaching repro patch for trunk.i.e.:ij&gt; connect 'triggerProcSQLAuth;create=true' user 'APP' as app;WARNING 01J14: SQL authorization is being used without first enabling authentication.ij&gt; &#8212; setup the environment&#8212; table used in the procedurescreate table t1 (i int primary key  b char(15));0 rows inserted/updated/deletedij&gt; insert into t1 values (1  'XYZ');1 row inserted/updated/deletedij&gt; insert into t1 values (2  'XYZ');1 row inserted/updated/deletedij&gt; &#8212; table used in this testcreate table t2 (x integer  y integer);0 rows inserted/updated/deletedij&gt; create procedure grant_select_proc()  parameter style java dynamic result sets 0 language java  contains sql external name 'org.apache.derbyTesting.functionTests.util.ProcedureTest.grantSelect';0 rows inserted/updated/deletedij&gt; create procedure revoke_select_proc()  parameter style java dynamic result sets 0 language java  contains sql external name 'org.apache.derbyTesting.functionTests.util.ProcedureTest.revokeSelect';0 rows inserted/updated/deletedij&gt; &#8212; testscreate trigger grant_select_trig AFTER delete on t1  for each STATEMENT mode db2sql call grant_select_proc();0 rows inserted/updated/deletedij&gt; &#8212; should faildelete from t1 where i = 1;1 row inserted/updated/deletedij&gt; &#8212; check delete failedselect * from t1;I |B ---------------------------2 |XYZ 1 row selectedij&gt; &#8212; check if there are rows in sys.systableperms  should be 0select count from SYS.SYSTABLEPERMS;1 -----------1 1 row selectedij&gt; drop trigger grant_select_trig;0 rows inserted/updated/deletedij&gt; create trigger revoke_select_trig AFTER delete on t1  for each STATEMENT mode db2sql call revoke_select_proc();0 rows inserted/updated/deletedij&gt; &#8212; should faildelete from t1 where i = 2;1 row inserted/updated/deletedij&gt; &#8212; check delete failedselect * from t1;I |B ---------------------------0 rows selectedij&gt; &#8212; check if there are rows in sys.systableperms  should be 0select count from SYS.SYSTABLEPERMS;1 -----------0 1 row selectedij&gt; drop trigger revoke_select_trig;0 rows inserted/updated/deletedij&gt; ------------------ Java Information ------------------Java Version: 1.4.2_12Java Vendor: Sun Microsystems Inc.Java home: C:/Program Files/Java/j2re1.4.2_12Java classpath: derby.jar;derbytools.jarOS name: Windows XPOS architecture: x86OS version: 5.1Java user name: YipJava user home: C:/Documents and Settings/YipJava user dir: C:/work3/derby/trunk/jars/sanejava.specification.name: Java Platform API Specificationjava.specification.version: 1.4--------- Derby Information --------JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&#91;C:/work3/derby/trunk/jars/sane/derby.jar&#93; 10.3.0.0 alpha - (432670M)&#91;C:/work3/derby/trunk/jars/sane/derbytools.jar&#93; 10.3.0.0 alpha - (432670M)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [English/United States &#91;en_US&#93;]Found support for locale: &#91;de_DE&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;es&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;fr&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;it&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;ja_JP&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;ko_KR&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;pt_BR&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;zh_CN&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;zh_TW&#93; version: 10.3.0.0 alpha - (432670M)------------------------------------------------------   